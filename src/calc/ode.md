# ODE（常微分方程式）の基礎
作成日：2025年11月23日

## 概要
- ODE（Ordinary Differential Equation, 常微分方程式）は、**1つの独立変数に対する関数と、その導関数の関係を表す方程式**。
  - 例：時間 t に対する位置 x(t)、温度 T(t)、電流 I(t)、磁化 M(t) など。
- 力学系・電気回路・人口増加・化学反応・スピンダイナミクスなど、  
  **時間発展を記述するモデルの多くは ODE** で表現される。
- PDE が「時間＋空間」依存の場の方程式であるのに対し、  
  ODE は「時間のみ（あるいは1変数のみ）」に依存する系のモデル。

## ODE の基本形
- 未知関数 $y(t)$ とその導関数の関係：
  $$
    F\left(t,\, y(t),\, y'(t),\, y''(t), \dots, y^{(n)}(t)\right) = 0
  $$
- 特に、最高階の導関数を解いて
  $$
    y^{(n)}(t) = f\left(t, y, y', \dots, y^{(n-1)}\right)
  $$
  の形に書けるとき、n 次の常微分方程式と呼ぶ。

## 一階 ODE と初期値問題
- 最も基本的な形：
  $$
    \frac{dy}{dt} = f(t, y)
  $$
- 初期条件（initial condition）：
  $$
    y(t_0) = y_0
  $$
  を与えると、これを「初期値問題 (IVP: Initial Value Problem)」と呼ぶ。
- 力学系の多くは、この形（またはベクトル形）に書き直せる：
  $$
    \frac{d\mathbf{y}}{dt} = \mathbf{f}(t, \mathbf{y})
  $$

## ODE の線形性と次数
- n 次 ODE の一般形：
  $$
    a_n(t)\,y^{(n)} + a_{n-1}(t)\,y^{(n-1)} + \dots + a_0(t)\,y
    = g(t)
  $$
- 線形 ODE：
  - y とその導関数が「一次」で現れる場合（上式の形）。
  - 係数 $a_i(t)$、右辺 $g(t)$ は y に依存しない。
- 非線形 ODE：
  - $y^2$, $\sin y$, $y\,y'$ など、非線形な組み合わせが含まれる場合。
  - 実際の物理・生物・化学系の多くは非線形。

## 代表的な一階 ODE の例
- 指数的成長・減衰：
  $$
    \frac{dy}{dt} = ky
  $$
  解：
  $$
    y(t) = y_0 e^{kt}
  $$
- ロジスティック方程式（成長の飽和）：
  $$
    \frac{dy}{dt} = r y\left(1 - \frac{y}{K}\right)
  $$
  - 初期値によって、時間とともに K に漸近する振る舞い。

## 二階 ODE の例・力学系
- 質点の運動（ニュートンの運動方程式）：
  $$
    m\frac{d^2 x}{dt^2} = F(x, \dot{x}, t)
  $$
- 調和振動子：
  $$
    m\ddot{x} + kx = 0
  $$
  解：
  $$
    x(t) = A\cos(\omega t) + B\sin(\omega t), \quad \omega = \sqrt{\frac{k}{m}}
  $$
- 減衰振動：
  $$
    m\ddot{x} + c\dot{x} + kx = 0
  $$
  - 減衰係数 c の大きさに応じて、振動的・臨界・過減衰などの挙動。

## ODE の解析解と解き方の基本
- 解析的に解ける場合：
  - 変数分離型
    $$
      \frac{dy}{dt} = f(t)g(y)
    $$
    のように、y と t の関数に分離できるとき、積分で解が書ける。
  - 一階線形 ODE：
    $$
      y' + p(t)y = q(t)
    $$
    は、積分因子 $\mu(t) = e^{\int p(t)dt}$ を用いて解ける。
  - 定係数線形 ODE：
    - 特性方程式を解き、指数・正弦・余弦の組み合わせとして解を表す。
- 多くの実問題：
  - 非線形、または複雑な時間依存・係数依存を持つため、  
    **解析解が存在しても実用的でない、あるいはそもそも見つからない**。
  - そこで数値解法（Euler, Runge–Kuttaなど）が重要になる。

## ODE の数値解法の基本
- 目的：  
  初期値問題
  $$
    \frac{dy}{dt} = f(t,y),\quad y(t_0)=y_0
  $$
  に対し、離散時刻 $t_n = t_0 + n\Delta t$ での近似解 $y_n \approx y(t_n)$ を求める。

### オイラー法（前進オイラー）
- 最も単純な陽解法：
  $$
    y_{n+1} = y_n + \Delta t\, f(t_n, y_n)
  $$
- 原理：
  - 接線（微分） $f(t_n,y_n)$ を使って、短い時間 $\Delta t$ だけ線形に進める。
- 短所：
  - 精度が低い（1次精度）。
  - 安定性が悪く、硬い問題には向かない。

### ルンゲ–クッタ法（RK 法）
- 代表例：4 次の Runge–Kutta (RK4)：
  $$
  \begin{aligned}
    k_1 &= f(t_n, y_n),\\
    k_2 &= f\left(t_n + \frac{\Delta t}{2},\, y_n + \frac{\Delta t}{2}k_1\right),\\
    k_3 &= f\left(t_n + \frac{\Delta t}{2},\, y_n + \frac{\Delta t}{2}k_2\right),\\
    k_4 &= f\left(t_n + \Delta t,\, y_n + \Delta t\,k_3\right),\\
    y_{n+1} &= y_n + \frac{\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4).
  \end{aligned}
  $$
- 特徴：
  - 精度が高く（4 次精度）、実装も比較的容易。
  - 多くの汎用 ODE ソルバの基本。

### 暗示法（陰解法）・剛性方程式
- 系によっては、時間刻みを非常に小さくしないと発散する「剛性 (stiffness)」が現れる。
- その場合、**陰的スキーム**（Backward Euler, BDF 法など）が有効：
  - 次の時刻の値が右辺にも現れるため、毎ステップで方程式（非線形ならNewton法）を解く必要がある。
- 材料・化学反応・マルチフィジックスでは、剛性 ODE が頻出。

## ベクトル ODE と連立 ODE
- 実際の物理系は、多変数 ODE の連立として書かれることが多い：
  $$
    \frac{d\mathbf{y}}{dt} = \mathbf{f}(t,\mathbf{y}),
    \quad
    \mathbf{y} =
    \begin{pmatrix}
    y_1 \\ y_2 \\ \vdots \\ y_n
    \end{pmatrix}
  $$
- 例：
  - 2 階 ODE を 1 階連立に書き換え：
    $$
      \ddot{x} = g(x,\dot{x},t)
      \quad\Rightarrow\quad
      \begin{cases}
        \dot{x} = v\\
        \dot{v} = g(x,v,t)
      \end{cases}
    $$
  - 多自由度振動系、電気回路網、反応拡散系の反応部分、モンテカルロ平均場近似など。

## ODE と PDE の関係・役割分担
- PDE の空間変数を離散化（FDM/FEM）すると、**時間に関する ODE の大規模連立系**が得られる：
  $$
    \frac{d\mathbf{u}}{dt} = \mathbf{F}(\mathbf{u}, t)
  $$
- したがって、PDE 数値解法の多くは
  - 空間 → 空間離散化（メッシュ）
  - 時間 → ODE ソルバ（RK, BDF など）
  の組み合わせとして理解できる。
- 材料・物性分野の例：
  - LLG 方程式（マイクロ磁気）を空間離散 → 多数のスピンの ODE。
  - フェーズフィールドの Allen–Cahn / Cahn–Hilliard を空間離散 → 濃度・秩序パラメータの ODE 系。

## 物理・材料分野における ODE の位置づけ
- 単一要素の時間応答：
  - 一点の温度・磁化・ひずみなど、局所状態の時間発展。
- 集約モデル・0次元モデル：
  - RLC 回路モデル、集中パラメータ磁気回路、等価回路で表されるバッテリーモデルなど。
- マルチスケール：
  - 原子スケール（第一原理 MD の原子運動：Newton ODE）
  - メゾスケール（スピン系の LLG ODE）
  - マクロスケール（ODE で書かれた有効モデル）
- これらを理解することで、
  - 「単純な ODE モデル」からスタートして
  - PDE・フェーズフィールド・マイクロ磁気へと発展させる際の**橋渡し**的な役割を ODE が担う。

