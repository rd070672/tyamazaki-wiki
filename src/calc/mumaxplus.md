# 拡張版 mumax+ による磁気弾性計算

#### 参考ドキュメント
- [mumax+](https://mumax.github.io/plus/)
- [GitHub Pages - mumax3](https://mumax.github.io/)
- [mumax3-workshop - Universiteit Gent](https://mumax.ugent.be/mumax3-workshop/)

---

## 概要

- mumax+ は、mumax3 を拡張して  
  磁化ダイナミクス（LLG）と弾性場（ひずみ・応力）を連成して扱えるようにしたコードであり、
  - 磁歪（magnetostriction）
  - 磁気弾性結合（magnetoelastic coupling）
  - 共鳴・音波駆動による磁化応答  
  などを数値的に解析することを目的としている。
- 基本的な考え方は、
  - mumax3 と同様に、有限差分格子上で LLG 方程式を GPU で時間発展
  - 同じ格子上で弾性方程式を解き、ひずみ・応力場を更新
  - 磁歪エネルギーを通じて、磁化⇔弾性の双方向結合を入れる  
  というものである（具体的な実装の細部はバージョンや実装に依存する）。

---

## 磁気弾性エネルギーと LLG–弾性連成の基本式

### 磁気弾性エネルギーの典型的な形
- 単純化した等方的な磁歪モデルでは、磁気弾性エネルギー密度 $f_\text{me}$ は
  $$
    f_\text{me}
    \sim -\frac{3}{2}\lambda_s \sigma_{ij} m_i m_j
  $$
  のように、  
  - $\lambda_s$：飽和磁歪定数（材料定数）
  - $\sigma_{ij}$：応力テンソル
  - $m_i$：単位磁化ベクトルの成分  
  で書かれる。
- 結晶異方性を考えると、より一般には
  $$
    f_\text{me}
    = B_1(\alpha_x^2 \varepsilon_{xx} + \alpha_y^2 \varepsilon_{yy} + \alpha_z^2 \varepsilon_{zz})
      + 2B_2(\alpha_x\alpha_y\varepsilon_{xy} + \dots)
  $$
  などの形（ここで $\alpha_i = m_i$、$\varepsilon_{ij}$：ひずみ）を用いることが多い。

### 有効磁場への寄与
- LLG 方程式では、有効磁場 $\mathbf{H}_\text{eff}$ は総エネルギー $F$ から
  $$
    \mathbf{H}_\text{eff}
    = -\frac{1}{\mu_0 M_s}\frac{\delta F}{\delta \mathbf{m}}
  $$
  として求まる。
- 磁気弾性エネルギー $F_\text{me}$ に対する変分から、
  $$
    \mathbf{H}_\text{me}
    = -\frac{1}{\mu_0 M_s}\frac{\delta F_\text{me}}{\delta \mathbf{m}}
  $$
  が得られ、弾性場（ひずみ・応力）が LLG における有効磁場としてフィードバックする。

### 弾性場側へのフィードバック
- 一方、弾性場の方程式（静的な弾性平衡を例にとると）：
  $$
    \partial_j \sigma_{ij} + f_i^\text{ext} = 0
  $$
- 応力テンソル $\sigma_{ij}$ は、フックの法則と「磁歪による固有ひずみ」を含めて
  $$
    \sigma_{ij}
    = C_{ijkl}(\varepsilon_{kl} - \varepsilon^\text{mag}_{kl}(\mathbf{m}))
  $$
  のような形で書かれる。
- ここで磁歪ひずみ $\varepsilon^\text{mag}_{kl}(\mathbf{m})$ が $\mathbf{m}$ の関数なので、  
  磁化が変わると弾性場が変わり、弾性場が変わるとまた磁化が変わるという連成ループが形成される。

---

## mumax+ の基本的な拡張点（概念的整理）

> ※ ここでは「mumax3 に対してどのような物理量・方程式が追加されるか」を概念的に整理しています。  
> 実際のパラメータ名・スクリプトの書き方は、mumax+ の公式ドキュメントを必ず確認してください。

- **追加物理量**
  - 磁化ベクトル $\mathbf{m}(\mathbf{r},t)$：mumax3 と同じ
  - ひずみ・応力場、あるいは変位ベクトル $\mathbf{u}(\mathbf{r},t)$
- **追加方程式**
  - LLG 方程式：磁気弾性有効場を含む
  - 弾性方程式：フックの法則＋磁歪固有ひずみを含む
- **追加パラメータ（典型例）**
  - 磁歪定数：$\lambda_{100}$, $\lambda_{111}$ など
  - 弾性定数：$C_{11}, C_{12}, C_{44}$（立方晶の場合）など
  - 密度 $\rho$、粘性係数など（動的弾性を扱う場合）
- **計算フロー（1ステップのイメージ）**
  1. 現在の $\mathbf{m}$ から磁歪ひずみ $\varepsilon^\text{mag}_{ij}(\mathbf{m})$ を計算
  2. 弾性方程式を解いて $\varepsilon_{ij}$, $\sigma_{ij}$ を更新
  3. $\sigma_{ij}$ から $\mathbf{H}_\text{me}$ を計算し、有効磁場に加算
  4. LLG 方程式で $\mathbf{m}$ を時間発展

---

## 典型的な計算フロー（磁気弾性問題）

1. **物理問題の設定**
   - 例：  
     - 薄膜・ナノバーにおける磁歪共鳴  
     - 超音波・SAW による磁化反転  
     - エピ層のミスマッチひずみによる磁気異方性制御 など。
2. **メッシュ・材料定数・磁気定数の設定**
   - mumax3 と同様に格子数・セルサイズを設定。
   - $M_s, A_\text{ex}, K_u, \alpha$ などの磁気パラメータ。
3. **弾性パラメータの設定**
   - 弾性定数 $C_{ijkl}$（立方晶なら $C_{11}, C_{12}, C_{44}$）や密度 $\rho$。
   - 磁歪定数 $\lambda_{100}, \lambda_{111}$ など。
   - 必要ならば外力・外部ひずみ境界条件（例えば基板拘束）。
4. **初期状態の設定**
   - 初期磁化分布：単一ドメイン、磁壁、渦、スキルミオンなど。
   - 初期ひずみ・応力状態：ゼロ、あるいは静的プリストレス。
5. **駆動条件の設定**
   - 外部磁場：DC＋AC パルス、パルス磁場、傾斜磁場など。
   - 外部応力／ひずみ：時間依存の機械的駆動（例：共振周波数の正弦波ひずみ）。
6. **時間発展と出力**
   - LLG＋弾性方程式を連成で時間発展。
   - 平均磁化、ひずみエネルギー、磁気弾性エネルギーなどをログ出力。
   - 磁化分布とひずみ分布を時系列で保存し、後で可視化・フーリエ解析。

---

## 磁気弾性計算の代表的な応用シナリオ

### 1. 磁歪共鳴（Magnetostriction Resonance）の解析
- ナノバーや薄膜共振子に対して、
  - 機械的固有モードに対応する周波数でひずみを駆動
  - 磁気弾性結合を通じて磁化が共鳴的に応答
- mumax+ では、
  - 弾性モードの形・周波数
  - 磁化のプリセッション軌道
  - 有効ダンピング（エネルギー散逸）  
  などを一体として評価できる。

### 2. 応力制御磁化反転（ストレイントロニクス）
- 圧電基板＋磁性薄膜のハイブリッド素子などで、
  - 電圧 → ひずみ → 磁気異方性変化 → 磁化反転  
    というプロセスをシミュレーション。
- 電圧パルス形状・タイミングと、磁化スイッチング確率やスイッチング時間の関係を解析できる。

### 3. 固有モード・ダンピング評価
- 磁気自由度と弾性自由度が強く結合することで、
  - 磁気・弾性のハイブリッドモード（マグノン–フォノン結合）が形成される。
- 固有値解析的なアプローチや、時間応答のフーリエ解析を通じて、
  - 共鳴周波数シフト
  - 線幅（ダンピング）の変化  
  を評価し、材料の磁気弾性定数との対応を調べることができる。

---

## 実務上の注意点（概念レベル）

- **メッシュと波長の関係**
  - 磁区幅だけでなく、弾性波の波長（音速×周期）との相対関係も考慮してセルサイズを決める。
- **時間刻み**
  - 磁気と弾性で典型的時間スケールが異なる場合、  
    両者を同じタイムステップで解くと計算コストが増大しうる。
- **物性パラメータの一貫性**
  - 磁歪定数・弾性定数・密度・磁化・異方性などを、  
    実験・第一原理計算から取得して SI 単位に変換したうえで入力する。
- **境界条件**
  - 弾性場の境界条件（固定端・自由端・周期など）によって固有モードや共鳴周波数が大きく変わるため、
    実験系を意識した設定が必要。

> ※ mumax+ は開発・更新の進捗により仕様が変わる可能性があります。  
> 実際にシミュレーションを行う際は、必ず公式リポジトリの README / ドキュメント・サンプルスクリプトを確認し、  
> そこで示されているパラメータ名・単位系・ API に従ってください。

