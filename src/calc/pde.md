# PDE（偏微分方程式）の基礎
作成日：2025年11月23日

## 概要
- PDE（Partial Differential Equation, 偏微分方程式）は、**複数の変数に依存する関数と、その偏微分の関係を表す方程式**。
  - 例：時間 t と空間 x に依存する温度 T(x,t)、変位 u(x,t)、濃度 c(x,t) など。
- 連続体力学・熱伝導・電磁気学・流体・量子力学など、**ほぼ全ての場の方程式**が PDE で記述される。
- 数値解析（FDM, FEM, FVM, スペクトル法など）を行うためには、PDE の種類・境界条件・解の性質を理解しておくことが重要。

## PDE の基本形
- 未知関数 $u = u(x_1,\dots,x_n,t)$ と、その偏微分を含む方程式：
  $$
    F\left(x_1,\dots,x_n,t,\,
      u,\,
      \frac{\partial u}{\partial x_i},\,
      \frac{\partial^2 u}{\partial x_i \partial x_j},\dots
    \right) = 0
  $$
- 一般に、次数（含まれる最高階微分の次数）や線形性（u に関して線形か非線形か）で分類される。
  - 1階，2階…：最高階の偏微分が1階/2階。
  - 線形／非線形：uやその微分が一次式で出るかどうか。

## 代表的な PDE の例
- ポアソン方程式（静的な場・平衡状態）
  $$
    -\nabla^2 u = f(\mathbf{x})
  $$
  - 例：静電ポテンシャル、定常熱伝導、弾性の変位場など。
- 熱伝導方程式（拡散・緩和）
  $$
    \frac{\partial u}{\partial t} = \alpha \nabla^2 u
  $$
  - 例：温度拡散、濃度拡散。
- 波動方程式（伝播・振動）
  $$
    \frac{\partial^2 u}{\partial t^2} = c^2 \nabla^2 u
  $$
  - 例：弦の振動、音波、電磁波、弾性波。
- ナビエ–ストークス方程式（流体）
  $$
    \rho\left(
      \frac{\partial \mathbf{v}}{\partial t}
      + (\mathbf{v}\cdot\nabla)\mathbf{v}
    \right)
    = -\nabla p + \mu \nabla^2 \mathbf{v} + \mathbf{f}
  $$
  - 非線形 PDE の代表例。

## 2階線形 PDE の分類（楕円・放物・双曲）
- 一般的な 2階線形 PDE：
  $$
    a\,u_{xx} + 2b\,u_{xy} + c\,u_{yy} + \dots = \text{(1次・0次の項)}
  $$
- 判別式 $D = b^2 - ac$ により分類：
  - 楕円型（elliptic）：$D < 0$
    - 例：ラプラス／ポアソン方程式。
    - 解は「なめらか」で、境界条件に強く支配される。
  - 放物型（parabolic）：$D = 0$
    - 例：熱伝導方程式。
    - 時間方向に一方向の「拡散・緩和」。
  - 双曲型（hyperbolic）：$D > 0$
    - 例：波動方程式。
    - 信号・情報が有限速度で伝播し、特徴線（特性）に沿って影響が伝わる。

## 境界条件と初期条件
- PDE の解は、**方程式だけでは一意に決まらず、境界条件・初期条件が必要**。
- 境界条件（空間境界での条件）：
  - ディリクレ条件：境界で u を指定
    $$
      u|_{\partial\Omega} = g
    $$
  - ノイマン条件：境界法線方向の微分（フラックス）を指定
    $$
      \frac{\partial u}{\partial n}\Big|_{\partial\Omega} = h
    $$
  - ロビン条件：u とその微分の線形結合
    $$
      \alpha u + \beta \frac{\partial u}{\partial n} = r
    $$
- 初期条件（時間依存 PDE の t=0 での状態）：
  - 例：熱方程式：
    $$
      u(\mathbf{x}, 0) = u_0(\mathbf{x})
    $$
  - 波動方程式では、変位と速度の両方が必要：
    $$
      u(\mathbf{x},0) = u_0(\mathbf{x}),\quad
      \frac{\partial u}{\partial t}(\mathbf{x},0) = v_0(\mathbf{x})
    $$

## 強形式と弱形式（変分形式）
- 強形式（strong form）：
  - PDE をそのままの形で満たすこと：
    $$
      -\nabla^2 u = f \quad \text{in } \Omega, \quad
      u=g \ \text{on } \partial\Omega
    $$
- 弱形式（weak / variational form）：
  - 試験関数 v をかけて領域で積分し、部分積分を行う：
    $$
      \int_\Omega \nabla u \cdot \nabla v \, d\Omega
      = \int_\Omega f v \, d\Omega
      + \text{境界項}
    $$
- FEM のような変分法ベースの数値手法では、**弱形式が出発点**になる。
  - 有限要素空間上の近似解 $u_h$、試験関数 $v_h$ について同様の式を満たすように係数を決める。

## PDE の解の性質
- 一意性・存在：
  - 適切な境界条件・初期条件が与えられたときに、解が存在し一意かどうかは PDE の種類に依存。
  - 楕円型 PDE は「境界値問題の一意解」がよく知られている。
- 正則性（なめらかさ）：
  - 右辺や境界条件がなめらかなら、解もなめらかになることが多い（楕円型）。
  - 波動・双曲型では不連続の伝播（衝撃波など）が起こることもある。
- 安定性：
  - 初期・境界条件のわずかな変化が解にどれだけ影響するか。
  - 数値解析では「数値スキームの安定性（CFL条件など）」が重要。

## PDE と数値解法（FDM・FEM・その他）
- PDE は多くの場合、解析解が得られないため、**数値解法**が主役となる。
- 主な離散化手法：
  - 有限差分法 (FDM)：格子点上の差分近似。
  - 有限要素法 (FEM)：要素分割＋弱形式＋形状関数による近似。
  - 有限体積法 (FVM)：保存則に基づき、コントロールボリュームで積分。
  - スペクトル法：三角関数や多項式基底での高精度展開（FFT を多用）。
- PDE の種類・境界の形状・物性の複雑さ・必要精度に応じて、  
  最適な手法やスキームを選択する。

## 材料・物性分野での PDE の役割
- 熱・拡散：
  - 熱方程式、拡散方程式による温度場・濃度場の時間発展。
- 弾性・構造解析：
  - フックの法則＋運動方程式 → 弾性波・静的変形の PDE。
- 電磁場：
  - Maxwell 方程式の PDE 形。
- 磁性・スピン系：
  - LLG 方程式（Landau–Lifshitz–Gilbert）などの非線形ベクトル PDE。
- フェーズフィールド：
  - Allen–Cahn / Cahn–Hilliard 方程式のように、**相分離・粒成長・相変態の時間発展を記述する PDE** が材料設計に直接結び付く。

