# VASPを用いた第一原理MD計算

作成日：2025年11月21日

## このコードの計算の内容と流れ

1. **初期化（FeBアモルファス構造）**  
   - Fe原子 75個、B原子 25個（合計 100個）を箱（セル）内にランダム配置する。  
   - この初期状態を `matplotlib` で可視化する。

2. **MLポテンシャル設定**  
   - MatGL の CHGNet モデルを用いて、原子間力を計算する機械学習ポテンシャル（`PESCalculator`）をセットする。

3. **分子動力学（MD）シミュレーション**

   (a) **溶融（メルト）**  
   - 温度 3000 K で MD を 1000 ステップ実行。  
   - 高温で原子がよく動き、「完全に乱れた液体」状態を作る。

   (b) **クエンチ（急冷）**  
   - 3000 K → 300 K に 1000 ステップで温度を直線的に下げる。  
   - ガラス状アモルファス構造ができやすい。

   (c) **アニール（結晶化）**  
   - 400 ℃（673 K）で 1000 ステップ保持する。  
   - 原子が再配列しやすくなり、結晶化傾向や局所秩序が高まる。

   - 各段階ごとに構造を Notebook 上で可視化する。


## なぜ時間がかかるのか？

### 理由

- 「CHGNet 等の ML ポテンシャル」は 1 ステップあたりの計算コストが高い。
- DFT よりは圧倒的に速いが、従来の古典ポテンシャル（LJ, EAM など）に比べると **100〜1000倍遅い**。
- 毎回 **全原子ペアに対して GNN による特徴量抽出・推論** を行うため。
- 原子数 100 個でも、1 ステップあたり 0.1〜0.5 秒かかる場合がある（特に CPU では）。
- 1000 ステップ × 3 段階（溶融・急冷・アニール）＝ **合計 3000 ステップ**。
- Jupyter 上で都度構造を可視化・保存している場合、その描画・入出力も追加のオーバーヘッドになる。

### 目安

- 1 ステップあたり 0.2 秒 × 3000 ステップ ≒ **約 10 分**（CPU 環境の場合の一例）。


## 高速化・軽量化 Tips

- 原子数を減らす  
  - 例：まずは 50 個程度で動作確認する。
- ステップ数を減らす  
  - 例：各段階 500 ステップにする。
- 最初は 1 段階だけ（例：溶融のみ）テストして、計算フローを確認する。
- 大規模計算を行う場合は、**GPU** や **計算クラスタ** の利用を検討する。
