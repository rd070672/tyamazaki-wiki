# フェーズフィールド計算
### 自由エネルギー汎関数に基づく連続体モデリングと数値計算の体系

本書は、界面を拡散化した連続場によって組織形成やドメイン形成を記述するフェーズフィールド法を、熱力学・変分法・数値解法の順に体系化する構成である。材料組織、破壊、電気化学、強誘電・磁性などの多様な対象に対して、同一の数理骨格からモデルを立ち上げ、検証可能な計算へ落とし込むための視点を与えるものである。

## 目次
- 第1章 フェーズフィールド法の位置づけ
- 第2章 熱力学と自由エネルギー汎関数
- 第3章 変分法と支配方程式
- 第4章 界面、勾配エネルギー、異方性
- 第5章 多相・多成分・化学ポテンシャルの取り扱い
- 第6章 弾性・塑性・欠陥場との連成
- 第7章 熱・流体・凝固と成長
- 第8章 粒成長・再結晶・結晶方位場
- 第9章 破壊・損傷・界面剥離のフェーズフィールド
- 第10章 電気化学・電池・腐食のフェーズフィールド
- 第11章 強誘電・磁性・秩序変数場
- 第12章 数値解法と離散化設計
- 第13章 検証、妥当性、再現性
- 第14章 計算基盤と高速化
- まとめと展望

## 参考ドキュメント
1. 小山敏幸, Phase-field法に関する最近の進展と今後の展望, まてりあ, 42(5), 2003.
2. 日本機械学会 計算力学部門ニュースレター No.53, 2015.
3. L.-Q. Chen, Phase-Field Models for Microstructure Evolution, Annual Review of Materials Research, 32, 2002.


## 第1章 フェーズフィールド法の位置づけ

### 1.1 拡散界面という考え方
フェーズフィールド法は、界面を幾何学的境界として扱わず、有限幅の遷移層として連続場で表現する立場をとる。これにより、界面の追跡（フロントトラッキング）を明示的に行わずに、形状変化・合体・分岐を含む形態変化を同じ枠組みで記述できる。

### 1.2 保存場と非保存場
組織を記述する場は、組成のように保存則に従う保存場と、秩序変数のように保存されない非保存場に大別される。両者の区別は支配方程式の形（拡散型か緩和型か）を決め、数値安定性や境界条件の与え方にも直接影響する。

### 1.3 適用スケールと他手法との関係
フェーズフィールド法は、原子レベルの離散性を直接追わず、メゾスケールの形態進化を連続体として扱うことに強みがある。第一原理計算や分子動力学、CALPHAD、結晶塑性などとは、入力パラメータの同定や多段階連成という形で接続されることが多い。

### 1.4 研究史とコミュニティ資産
1990年代以降、材料組織形成を中心に適用範囲が急速に広がり、ベンチマークや推奨事項の整備も進められてきた。近年は、コード間比較を前提としたベンチマーク公開や推奨事項が整備され、計算結果の比較可能性を高める方向に進んでいる。

### 1.5 教科書としての到達点
本書では、自由エネルギーからの方程式導出、無次元化、離散化、検証までを一連の論理として示すことを到達点に置く。読者が対象系に応じて秩序変数と自由エネルギー密度を設計し、数値的に破綻しない計算へ落とし込めることを重視する。

---

## 第2章 熱力学と自由エネルギー汎関数

### 2.1 局所自由エネルギー密度
フェーズフィールドモデルの核は、局所自由エネルギー密度 $f_{\\mathrm{loc}}$ の設計にある。相図・状態方程式・相安定性を反映する形（多井戸ポテンシャル、CALPHAD由来の $G(T,c)$ など）を採用することで、駆動力の符号と大きさが熱力学的に解釈可能となる。

### 2.2 自由エネルギー汎関数の基本形
基本形は、領域 $\\Omega$ 上の汎関数として
$$
F[\\{\\eta_i\\},c] = \\int_{\\Omega} \\left(
f_{\\mathrm{loc}}(\\{\\eta_i\\},c,T)
+ \\sum_i \\frac{\\kappa_i}{2}|\\nabla \\eta_i|^2
+ \\frac{\\kappa_c}{2}|\\nabla c|^2
+ f_{\\mathrm{el}} + f_{\\mathrm{ext}}
\\right)\\, d\\mathbf{r}
$$
のように記述される。勾配項は界面幅と界面エネルギーを結び、弾性項や外場項はマルチフィジックス連成の入り口となる。

### 2.3 散逸とエネルギー減少
多くのフェーズフィールド方程式は、適切な運動係数を仮定すると $dF/dt\\le 0$ を満たす勾配流として構成される。エネルギー減少性は、物理整合性だけでなく、離散化後の数値安定性設計の指針にもなる。

### 2.4 無次元化と単位整合
無次元化は、界面幅、エネルギースケール、時間スケールを選び、主要量を $O(1)$ に揃える操作である。単位整合は、自由エネルギー密度と運動係数（モビリティ等）の整合が中心であり、連成項（弾性、電場等）を含めると整合条件が増えるため、設計段階で明示化しておく必要がある。

### 2.5 乱雑さの導入
核生成や熱揺らぎを表現するために、確率項を導入する場合がある。確率項は物理的仮定（揺動散逸関係）と数値的仮定（空間・時間離散に対する白色性の近似）が絡むため、何を再現したいのかを明確にして採用すべきである。

---

## 第3章 変分法と支配方程式

### 3.1 機能微分とオイラー・ラグランジュ方程式
汎関数 $F$ から支配方程式を得るには、機能微分 $\\delta F/\\delta \\phi$ を計算する。勾配項を含むため、部分積分と境界項の扱いが不可欠であり、境界条件の物理的意味と直結する。

### 3.2 Allen–Cahn 方程式
非保存場 $\\eta$ に対しては
$$
\\frac{\\partial \\eta}{\\partial t} = -L\\,\\frac{\\delta F}{\\delta \\eta}
$$
が基本である。緩和型の時間発展であり、秩序変数の局所的な「降下」によって界面移動やドメイン成長が表現される。

### 3.3 Cahn–Hilliard 方程式
保存場 $c$ に対しては
$$
\\frac{\\partial c}{\\partial t} = \\nabla\\cdot\\left(M\\nabla \\mu\\right),\\qquad
\\mu=\\frac{\\delta F}{\\delta c}
$$
が基本である。4階の空間微分を含むため、離散化や境界条件の与え方が Allen–Cahn と本質的に異なる。

### 3.4 弱形式と有限要素への接続
有限要素法では、試験関数 $v$ を用いて弱形式を構成し、積分形式で方程式を解く。Cahn–Hilliard の 4階項は、分割（化学ポテンシャル $\\mu$ を未知量として導入）により2階系へ落として扱う設計が広く用いられる。

### 3.5 方程式の比較表
|  | Allen–Cahn | Cahn–Hilliard |
|---|---|---|
| 場の性質 | 非保存 | 保存 |
| 基本式 | $\\partial_t\\eta=-L\\,\\delta F/\\delta\\eta$ | $\\partial_t c=\\nabla\\cdot(M\\nabla\\mu)$ |
| 空間微分次数 | 2階が基本 | 4階（分割で2階系に変換可） |
| 代表現象 | 界面移動、ドメイン成長 | 相分離、スピノーダル分解 |
この表は、同じ自由エネルギー汎関数からでも、保存則の選択で数理構造が変わる点を示す。以降の章では、対象系に応じて両者を組み合わせる設計を繰り返し扱う。

---

## 第4章 界面、勾配エネルギー、異方性

### 4.1 界面幅と界面エネルギー
勾配係数 $\\kappa$ と局所ポテンシャルの形は、界面幅 $W$ と界面エネルギー $\\gamma$ を通じて結び付く。数値的には、$W$ を格子（メッシュ）で十分に解像することが必要であり、$W$ の選択は計算コストと物理忠実度の折衷となる。

### 4.2 異方性界面エネルギー
結晶学的方位に依存する界面エネルギーは、勾配項の係数を方位依存にする、あるいは高次勾配を導入するなどで表現される。異方性はデンドライト形態や枝分かれ角度に直結するため、凝固問題では早期に導入方針を定める必要がある。

### 4.3 多相界面と接触角
三重点や多相界面を扱うとき、界面エネルギーの釣り合いが接触角として現れる。多秩序変数の拘束条件（和が1など）と界面エネルギー設計が一致していないと、物理的でない濡れ挙動が生じ得る。

### 4.4 粒界と結晶方位の表現
粒界は、方位場や複数の秩序変数の競合として表現されることが多い。結晶方位の連続表現を採用すると、粒界エネルギーや粒界移動のモデル化がより物理的になる一方、数値的拘束の扱いが難しくなる。

### 4.5 外場による界面応答
応力、電場、磁場などの外場は、自由エネルギーに外場項 $f_{\\mathrm{ext}}$ として入る。外場は界面移動速度やドメイン安定性を変えるため、外場の境界条件（電位固定、応力固定等）を明確にした上で導入すべきである。

---

## 第5章 多相・多成分・化学ポテンシャルの取り扱い

### 5.1 二相二元系の基本設計
最小構成は、秩序変数 $\\eta$ と組成 $c$ を用い、$f_{\\mathrm{loc}}(\\eta,c)$ を補間する形である。補間関数の選び方は界面での物理量（化学ポテンシャル、濃度分配）に影響するため、設計意図と整合する形を採る必要がある。

### 5.2 KKS 型と濃度分配
界面での濃度分配をより自然に扱うために、相ごとの組成を補助変数として導入する考え方がある。これにより、平衡条件（化学ポテンシャル一致）をモデルに組み込みやすくなり、界面での不自然な濃度振動を抑えやすい。

### 5.3 グランドポテンシャル形式
多成分合金では、化学ポテンシャルを独立変数とする定式化が有効となる場合がある。グランドポテンシャルを用いると、相図データ（CALPHAD等）と接続しやすくなり、濃度の制約条件処理を整理しやすい。

### 5.4 反応項と生成消滅
析出反応、相変態、電気化学反応などでは、保存則に反応項が加わる。反応速度式は、熱力学的駆動力（自由エネルギー差）と整合する形で与える必要があり、整合しないとエネルギー減少性が破れる。

### 5.5 多成分拡散と交差項
多成分拡散では、フラックスが単純な $-D\\nabla c$ ではなく、化学ポテンシャル勾配に比例する形が基本となる。拡散行列の対称性や正定値性は、物理整合と数値安定性の双方に関わるため、モデル設計段階で条件を明記しておくべきである。

---

## 第6章 弾性・塑性・欠陥場との連成

### 6.1 弾性エネルギーと固有ひずみ
相変態や析出では、格子ミスマッチを固有ひずみ $\\varepsilon^*$ として導入し、弾性エネルギー $f_{\\mathrm{el}}$ を自由エネルギーに加える。弾性場は長距離相互作用を持つため、形態選択や配列秩序を決める主要因となり得る。

### 6.2 機械平衡と境界条件
準静的弾性では
$$
\\nabla\\cdot\\boldsymbol{\\sigma}=\\mathbf{0},\\qquad
\\boldsymbol{\\sigma}=\\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^*)
$$
を解き、フェーズフィールド方程式と同時に連成する。変位固定、応力（トラクション）固定、周期境界などの条件は、得られる形態と内部応力分布を大きく変える。

### 6.3 塑性と不可逆性の導入
塑性や粘塑性を導入すると、変形が履歴依存となり、相変態と力学応答の双方向連成が強くなる。塑性内部変数の発展式は、エネルギー散逸と整合する形で構成しないと、計算上の発散や非物理的硬化が起こり得る。

### 6.4 欠陥場、空孔、拡散と応力
空孔や転位密度を連続場として導入し、拡散と応力の結合（拡散ポテンシャルへの応力項）を扱うことがある。これにより、界面偏析や空孔集積が界面移動を促進・抑制する機構を、同じエネルギー枠組みで表現できる。

### 6.5 数値実装上の連成の形
弾性連成は、(i) 各時間ステップで弾性場を解いて $f_{\\mathrm{el}}$ を更新する分離型と、(ii) 連立方程式として同時に解く同時型に大別される。分離型は実装が容易である一方、強連成では収束性が課題となるため、ヤコビアン整備や前処理が重要になる。

---

## 第7章 熱・流体・凝固と成長

### 7.1 熱伝導と潜熱
凝固や相変態では、温度場 $T$ の時間発展と潜熱放出が結合する。熱方程式に相変化項が入ることで、界面移動が温度場を変え、温度場が駆動力を変える循環が生じる。

### 7.2 対流と溶質輸送
溶融池や樹間液相流れを扱う場合、流体方程式（ナビエ・ストークス）と組成輸送が連成する。対流は溶質境界層を変えるため、同じ熱履歴でも偏析やセル状構造のスケールが変化し得る。

### 7.3 多相凝固と結晶粒競合
多結晶凝固では、複数方位の結晶が同一溶融池で競合し、選択成長による組織が形成される。多秩序変数や方位場を用いることで、柱状晶・等軸晶の遷移や粒界ネットワークの形成を扱える。

### 7.4 付加製造条件での非平衡
付加製造では冷却速度が大きく、局所平衡近似が破れる条件が現れる。非平衡凝固のモデル化では、界面での分配や拡散の時間スケールが主要となり、数値時間刻みの制約も強くなる。

### 7.5 連成計算の目的変数
凝固問題では、デンドライトアーム間隔、偏析量、粒径、テクスチャなどが主要な出力となる。目的変数を先に定義すると、必要な物理（熱のみか、流体までか、弾性までか）の取捨選択が明確になる。

---

## 第8章 粒成長・再結晶・結晶方位場

### 8.1 粒界移動の駆動力
粒成長は粒界エネルギー低下を駆動力とし、曲率による移動が基本となる。フェーズフィールドでは、粒界を秩序変数の遷移層として表すため、粒界三重点の自然な移動が表現される。

### 8.2 マルチフェーズフィールド（MPF）
多数粒を扱うには、複数秩序変数で各粒を表現するMPFが用いられる。秩序変数間の拘束と界面エネルギー設計を整合させることで、物理的な粒界角度と粒界移動が得られる。

### 8.3 再結晶と貯蔵エネルギー
再結晶では、塑性加工による貯蔵エネルギー（転位密度など）を駆動力として粒が生成・成長する。欠陥場を導入して駆動力を空間分布として与えると、核生成位置や成長方向が機構的に説明できる。

### 8.4 方位場の連続表現
方位を連続量として表すと、粒内の回転やサブグレイン構造を扱える可能性が広がる。反面、方位の位相的な性質（回転群）を数値的に安定に扱う工夫が必要となる。

### 8.5 実験との接続
EBSDなどの方位マップを初期条件として与えると、熱処理による粒成長を直接比較できる。比較のためには、粒界モビリティや粒界エネルギーの同定が中心課題となり、同定戦略を明示しておくべきである。

---

## 第9章 破壊・損傷・界面剥離のフェーズフィールド

### 9.1 損傷場による亀裂表現
破壊のフェーズフィールドでは、亀裂を損傷場（スカラー場）で拡散化して表す。亀裂面の生成はエネルギー最小化として記述され、分岐や合体を幾何学的操作なしに表現できる。

### 9.2 変分原理とエネルギー分解
弾性エネルギーの引張成分のみを損傷に結合させるなど、エネルギー分解が重要となる。分解の選択は、圧縮下での不自然な損傷進展を避けるための物理条件として働く。

### 9.3 亀裂幅パラメータとメッシュ条件
亀裂の拡散幅は、界面幅と同様に離散化解像度と結び付く。亀裂先端近傍の勾配が支配的となるため、局所メッシュ細分や適応戦略の採用が有効となる場合がある。

### 9.4 動的破壊と慣性
高速破壊では、慣性項を含む運動方程式と損傷場が連成する。波動伝播と損傷進展の時間スケールが異なるため、時間積分法の選択が結果に大きく影響する。

### 9.5 異材界面と剥離
界面剥離は、界面エネルギーと弾性不整合の競合として現れる。界面専用の損傷場や結合エネルギーを導入すると、剥離進展条件をエネルギー的に整理できる。

---

## 第10章 電気化学・電池・腐食のフェーズフィールド

### 10.1 電気化学ポテンシャルと反応
電極析出や腐食では、イオン輸送、電位場、界面反応が本質である。化学ポテンシャルに電気項が加わることで、反応駆動力が電位差と結び付いて表現される。

### 10.2 電極析出とデンドライト
金属リチウムなどの析出では、界面形状不安定がデンドライト成長として現れる。力学（スタック圧、塑性）と電気化学を同時に扱うと、界面欠陥や粒界の影響が計算的に検討可能となる。

### 10.3 電解質界面の空隙と接触損失
剥離や空隙生成は、界面抵抗増大や局所電流集中を通じて劣化を加速する。空隙場を導入し、反応・拡散・力学と連成させることで、空隙の生成消滅を同一枠組みで扱える。

### 10.4 腐食と皮膜破壊
腐食では、溶解、再不動態化、皮膜破壊が相互に結合する。力学場を加えると、応力腐食割れのような機構も同じ自由エネルギーの拡張として表現できる。

### 10.5 計算結果の読み替え
電気化学系では、場の変数が直接観測量（電圧、電流、容量）と一対一対応しないことが多い。計算出力を等価回路量や実験指標へ写像する関係式を明示すると、比較可能性が高まる。

---

## 第11章 強誘電・磁性・秩序変数場

### 11.1 Landau 型自由エネルギー
強誘電では分極 $\\mathbf{P}$、磁性では磁化 $\\mathbf{M}$ を秩序変数として、Landau 多項式と勾配項でドメイン構造を表現する。外場結合項（$-\\mathbf{E}\\cdot\\mathbf{P}$、$-\\mu_0\\mathbf{H}\\cdot\\mathbf{M}$ など）がドメイン安定性を支配する。

### 11.2 静電場・磁場の長距離相互作用
強誘電ではポアソン方程式、磁性では静磁場（反磁界）の計算が必要となり、長距離相互作用が主要となる。これらは局所勾配項と異なる数理構造を持ち、ソルバ設計が計算効率を左右する。

### 11.3 電気機械・磁気機械の連成
強誘電の圧電、磁性の磁歪は、ひずみと秩序変数が相互に結合する連成として扱われる。連成項はドメイン壁の移動エネルギー地形を変えるため、応力境界条件の影響が顕著に現れる。

### 11.4 ナノ構造と境界条件の重要性
薄膜・多層膜・探針印加のような条件では、境界条件がドメイン形態を決定する。境界条件を動的に与える設計は、実験条件の忠実化だけでなく、逆解析や設計問題への接続にも関係する。

### 11.5 機械学習による代替モデル
強誘電の3次元計算などでは計算負荷が大きく、代替モデルで時間発展を近似する研究が進んでいる。代替モデルは、計算コスト削減だけでなく、設計空間探索の反復回数を増やす目的でも導入される。

---

## 第12章 数値解法と離散化設計

### 12.1 空間離散（差分・有限要素・スペクトル）
差分法は実装が単純で規則格子に適する一方、複雑形状や境界条件の取り扱いで不利となる。有限要素法は複雑形状と境界条件に強く、既存の線形代数基盤と結合しやすいが、実装量と計算コストの設計が重要となる。

### 12.2 時間積分（陽・陰・半陰）
陽解法は実装が容易であるが、界面幅や拡散係数により時間刻みが厳しく制限されやすい。半陰解法や完全陰解法は大きな時間刻みを許容し得るが、非線形連立の解法と前処理が性能を決める。

### 12.3 非線形解法とヤコビアン
ニュートン法系の解法では、ヤコビアンの整備が収束性と計算時間を左右する。連成項が増えるほどヤコビアンの構造は複雑になるため、近似ヤコビアンやブロック前処理の設計指針を整理しておく必要がある。

### 12.4 Cahn–Hilliard の分割と安定化
Cahn–Hilliard の4階項は、$\\mu$ を導入して2階系に分割する方法が広く用いられる。さらに、エネルギー安定化（例：凸分割）を用いると、時間刻みに対する安定性を理論的に保証しやすくなる。

### 12.5 適応メッシュと誤差制御
界面近傍のみ高分解能が必要な場合、適応メッシュは計算量削減に直結する。適応では界面位置の追従だけでなく、長距離場（弾性、静電、静磁）の誤差が支配する場合もあるため、誤差指標の選択が重要となる。

### 12.6 手法比較表
| 観点 | 差分法 | 有限要素法 | スペクトル法 |
|---|---|---|---|
| 形状適応 | 弱い | 強い | 周期境界で強い |
| 実装量 | 少ない | 中〜多 | 中 |
| 長距離場連成 | 工夫が必要 | 既存基盤と親和 | フーリエで高速化可能 |
| 大規模並列 | 容易 | 容易（前処理が鍵） | FFT通信が鍵 |
この表は、対象系（形状、境界条件、連成物理）に応じて最適解が変わることを示すための整理である。

---

## 第13章 検証、妥当性、再現性

### 13.1 解析解・収束試験
検証は、解析解が既知の問題や、格子幅・時間刻みに対する収束挙動の確認から始める。界面幅を有限に取る手法である以上、界面幅と離散化誤差を分離して評価する設計が必要である。

### 13.2 ベンチマーク問題の活用
コード間比較を可能にするために、ベンチマーク仕様と比較指標が公開されている。共通ベンチマークを通じて、離散化・ソルバ・境界条件実装の差がどの出力に現れるかを定量的に把握できる。

### 13.3 パラメータ同定
界面エネルギー、モビリティ、勾配係数などは、実験・第一原理・分子動力学から同定されることが多い。同定の不確かさは計算出力の不確かさへ直結するため、感度解析や不確かさの伝播の整理が重要となる。

### 13.4 実験データとの比較戦略
形態（粒径分布、界面曲率、相分率）と、物性（強度、電気抵抗、容量など）では比較の手続きが異なる。観測量への写像（計算変数→実験指標）を明示し、比較指標（距離、統計量）を定義することで、議論が構造化される。

### 13.5 記録と公開の作法
入力ファイル、乱数種、メッシュ生成条件、ソルバ設定を保存しないと、同一コードでも再計算で差が出る場合がある。計算条件を機械可読に残し、図の生成条件まで追跡できる形にすると、共同研究での再利用性が高まる。

---

## 第14章 計算基盤と高速化

### 14.1 大規模並列とメモリ設計
フェーズフィールドは3次元・多変数でメモリ負荷が大きくなりやすく、並列化は必須となる。分割方法（領域分割、変数分割）と通信量は、界面数や長距離場の有無で変化するため、対象系に応じた設計が必要である。

### 14.2 オープンソース計算枠組み
有限要素ベースの枠組みでは、フェーズフィールド方程式（Allen–Cahn、Cahn–Hilliard）を標準部品として提供する実装が存在する。入力の抽象化、カーネル化、前処理の整備は、研究対象の変更に対する拡張性を大きく左右する。

### 14.3 行列フリーと高性能実装
大規模問題では、行列を陽に組み立てない行列フリー実装が有利となる場合がある。行列フリーはメモリ削減と演算集約を狙う設計であり、前処理やマルチグリッドとの整合が性能の鍵となる。

### 14.4 国内計算基盤と応用例
国内では、鋳造・凝固などの問題で、フェーズフィールドと他手法（格子ボルツマンなど）を組み合わせた大規模計算の報告がある。大規模化の動機は、樹間流れや偏析の統計性など、有限サイズでは評価できない量を扱う点にある。

### 14.5 機械学習による時間発展の代替
近年は、画像表現（オートエンコーダ等）と時系列モデル（LSTM等）により、時間発展を近似する研究が進んでいる。代替は、計算速度の向上だけでなく、設計空間探索や逆解析で反復計算回数を増やすための技術として位置づけられる。

### 14.6 推奨事項に基づく設計整合
数値実装の選択、境界条件、界面幅、収束判定などについて、推奨事項として整理された知見が公開されている。これらは、単に方法論の紹介ではなく、比較可能性と再現性を確保するための共通言語として機能する。

---


## 第1章 フェーズフィールド法の位置づけ

### 1.1 拡散界面という考え方
相の境界は、教科書的には鋭い幾何学的境界として描かれることが多い。しかし実際の材料では、原子配列や組成は界面近傍で連続的に変化し、有限幅の遷移層を持つ場合が多い。フェーズフィールド法は、この遷移層を明示的に取り込み、界面を有限幅の連続場として表す方法である。

界面を表す代表的な変数は秩序変数と呼ばれ、例えば固相を1、液相を0とするように、相の状態を連続的な値で表す。ここで重要なのは、秩序変数は観測装置で直接測る物理量というより、相の状態を表現するために導入する連続体の内部変数である点である。したがって、秩序変数の定義と自由エネルギーの設計が、そのまま界面の性質や界面移動の法則を決める。

拡散界面の利点は、界面の位置を追跡する別アルゴリズムが不要になることである。界面の生成・消滅、分岐、合体が起きても、秩序変数の空間分布が自動的にそれを表すため、トポロジー変化を自然に扱える。これは、粒界ネットワーク、デンドライト分岐、亀裂分岐など、幾何学的な追跡が難しい現象で特に効く。

一方で、界面が有限幅であることは、数値計算ではメッシュで界面幅を解像する必要があることを意味する。界面幅を極端に薄くすると鋭い界面へ近づくが、メッシュが極端に細かく必要となり計算コストが増える。界面幅を厚くすると計算は楽になるが、界面の曲率効果や界面反応の表現に影響が出る。したがって、モデルで表現したい物理と計算規模の間で、界面幅とパラメータの整合を取ることが出発点になる。

---

### 1.2 保存場と非保存場
フェーズフィールド法で扱う場は、大きく保存場と非保存場に分けられる。保存場とは、領域全体で積分した量が時間発展で変わらない（あるいは境界からの流入出でのみ変化する）場である。代表例は組成場であり、濃度 $c(\mathbf{r},t)$ が拡散で移動しても、閉じた系の総量 $\int_{\Omega} c\,d\mathbf{r}$ は一定になる。これは物質保存則に対応する。

一方で、非保存場とは、局所的に値が増減し得る場である。秩序変数 $\eta(\mathbf{r},t)$ はその代表であり、相の状態が変化すること自体が局所的な生成・消滅として表れる。非保存場は、例えば固液変態で固相分率が局所的に増えるとき、別の場所で同量減る必要はないという直感に対応する。

この区別は、支配方程式の形を根本から分ける。非保存場は、自由エネルギーを下げる方向に局所的に緩和する形になりやすく、時間発展は勾配流として
$$
\frac{\partial \eta}{\partial t} \propto -\frac{\delta F}{\delta \eta}
$$
の形を取る。保存場は、保存則から連続の式
$$
\frac{\partial c}{\partial t}+\nabla\cdot \mathbf{J}=0
$$
がまず立ち、フラックス $\mathbf{J}$ を化学ポテンシャル勾配で与えることで
$$
\frac{\partial c}{\partial t}=\nabla\cdot\left(M\nabla \mu\right),\qquad
\mu=\frac{\delta F}{\delta c}
$$
へ至る。つまり、非保存場では局所緩和、保存場では輸送（拡散）が本質である。

保存か非保存かの選択は、材料の現象論に対応する。例えば、組成による相分離は保存場の拡散で進み、秩序・無秩序転移は秩序変数の緩和で進む。実際の問題では、両者が同時に起きる場合が多く、秩序変数と組成を同時に持つ連成モデルが基本となる。

---

### 1.3 適用スケールと他手法との関係
フェーズフィールド法は、原子を個別に追う方法ではなく、連続場でメゾスケールの形態進化を扱う方法である。典型的な空間スケールは、界面幅より十分大きく、組織スケール（粒径、析出物間隔、ドメイン幅）を直接表せる範囲に置かれる。時間スケールも、原子振動や衝突の時間ではなく、拡散や界面移動、緩和の時間を主に扱う。

他手法との関係は、入力と検証の両面で整理できる。第一原理計算は、相安定性、格子ミスマッチ、弾性定数、界面エネルギーの推定など、自由エネルギーや連成項の材料定数に関与する。分子動力学は、界面モビリティ、拡散係数、核生成に関する局所過程の情報を与え得る。CALPHADは、多成分系の熱力学データベースとして $f_{\mathrm{loc}}(c,T)$ の実装に結びつく。これらはフェーズフィールドの外側にありつつ、自由エネルギー設計を通じて内部へ入ってくる。

鋭い界面を前提にした古典的な界面追跡法（ステファン問題など）との関係も重要である。フェーズフィールドが鋭い界面の極限で同じ界面条件へ一致するためには、界面幅を小さくするだけでなく、パラメータの取り方が条件を満たす必要がある。どの極限でどの界面条件を再現したいのかを明確にしないと、同じ見かけの形態でも速度や選択則が変わり得る。

以下は、手法の位置づけを整理するための比較である。

| 手法 | 記述の単位 | 得意な現象 | 制約の中心 |
|---|---|---|---|
| 第一原理計算 | 電子状態 | 相安定性、界面・欠陥の基礎量 | 系サイズが小さい |
| 分子動力学 | 原子 | 界面の局所過程、拡散の素過程 | 時間が短い |
| フェーズフィールド | 連続場 | 組織・ドメイン・界面の形態進化 | 材料定数の同定が要る |
| 鋭い界面モデル | 境界面 | 界面条件が既知な成長・移動 | トポロジー変化が難しい |

この表は優劣を示すものではなく、スケールと記述の単位の違いを示すための整理である。フェーズフィールドは、複雑形態の時間発展を扱える代わりに、自由エネルギーと運動係数という入力設計が決定的に重要となる。

---

### 1.4 研究史とコミュニティ資産
フェーズフィールド法の理論的基盤は、界面の自由エネルギーを勾配項として書き下し、変分原理と散逸の仮定から時間発展を構成する点にある。この枠組みは材料の凝固、相分離、析出、粒成長、ドメイン形成などへ拡張され、レビュー論文で統一的に整理されてきた。英語圏では、モデルの設計思想と適用範囲をまとめた総説が参照点になっている。

近年は、同じ現象を別実装で計算した際に結果が一致するかを比較しやすくするため、ベンチマークや推奨事項が整備されている。ここで扱われるのは、単なるプログラム上の取り決めではなく、無次元化、界面幅の解像、時間刻み、初期条件など、物理と離散化が交差する要点である。計算が現象の本質を写しているのか、離散化の癖を見ているのかを切り分けるための共通言語として機能する。

国内でも、凝固や組織形成を中心に講義資料・解説記事・入門書が整備されてきた。国内資料は、材料学の文脈（相図、凝固組織、結晶粒）と数理の橋渡しを意識したものが多く、初学者がモデルの意味づけを掴む助けになる。フェーズフィールド法は抽象度が高いが、国内外の整理を参照しつつ、自分の対象に合わせて秩序変数と自由エネルギーを設計する姿勢が重要である。

---

### 1.5 教科書としての到達点
本書で到達したいのは、与えられた方程式を使うだけでなく、自由エネルギーから支配方程式を自分で導出できる状態である。導出は、(i) どの場が保存でどの場が非保存かを判断し、(ii) 自由エネルギー汎関数 $F$ を書き、(iii) 機能微分 $\delta F/\delta \phi$ を計算し、(iv) 散逸則と保存則を組み合わせて時間発展式を作る、という順序で進む。この順序を崩すと、式の各項の意味が曖昧になりやすい。

また、数式を導いた後に必ず確認すべきことがある。第一に、単位整合である。$f_{\mathrm{loc}}$、勾配係数、運動係数が整合していないと、計算時間や界面速度が物理と対応しなくなる。第二に、エネルギーが時間とともに減少する構造になっているかである。多くのフェーズフィールド方程式は、適切な係数を用いれば $dF/dt\le 0$ を満たすように作れるため、その確認はモデルの健全性の診断になる。

さらに、対象とする現象がどのスケールの情報を要求しているかを明確にし、必要な材料定数がどこから来るかを見通しておく必要がある。フェーズフィールド法は、形態の時間発展を与えるが、材料定数の供給源は外部にあることが多い。どの定数を既知とし、どれを同定対象とするかを最初に整理することで、研究としての見通しが立ちやすくなる。

---

## 第2章 熱力学と自由エネルギー汎関数

### 2.1 局所自由エネルギー密度
フェーズフィールド法の出発点は、状態を特徴づける自由エネルギー密度を定めることである。最も基本的には、局所自由エネルギー密度 $f_{\mathrm{loc}}(\{\eta_i\},c,T)$ を導入し、秩序変数と組成と温度に依存する関数として与える。ここで $\{\eta_i\}$ は複数の相や結晶方位を表す秩序変数の集合であり、$c$ は保存される組成場である。

局所自由エネルギー密度は、相の安定性を表現するために、多井戸ポテンシャルの形を取ることが多い。例えば二相系で秩序変数 $\eta$ を用いる場合、$\eta=0$ と $\eta=1$ に安定点（極小）を持つ形を作ると、相の共存が表現できる。加えて、組成依存性を入れると、組成に応じてどちらの相が安定か、どの程度の駆動力があるかが表現される。

多成分合金や温度依存性を正確に扱う場合、$f_{\mathrm{loc}}$ を相図に整合する形で与えることが重要になる。CALPHAD由来のギブズ自由エネルギー $G(T,c)$ を局所項として用いると、熱力学データベースと接続できる。初学者の段階では、まず多井戸ポテンシャルで相安定性を設計し、その後、相図整合のための $G(T,c)$ へ拡張する流れが理解しやすい。

---

### 2.2 自由エネルギー汎関数の基本形
局所自由エネルギー密度だけでは、界面のエネルギーが表現できない。界面は空間的に変化する領域であり、その変化の急峻さにエネルギーがかかると考えると自然である。これを表すため、勾配エネルギー項を加えた自由エネルギー汎関数を定義する。

基本形は、領域 $\Omega$ に対して
$$
F[\{\eta_i\},c] = \int_{\Omega} \left(
f_{\mathrm{loc}}(\{\eta_i\},c,T)
+ \sum_i \frac{\kappa_i}{2}|\nabla \eta_i|^2
+ \frac{\kappa_c}{2}|\nabla c|^2
+ f_{\mathrm{el}}(\{\eta_i\},c,\mathbf{u})
+ f_{\mathrm{ext}}
\right)\, d\mathbf{r}
$$
の形で書かれる。$\kappa_i$ は秩序変数の勾配係数であり、$\kappa_c$ は組成勾配係数である。$f_{\mathrm{el}}$ は弾性エネルギー（変位 $\mathbf{u}$ を含む）であり、$f_{\mathrm{ext}}$ は外場（電場、磁場、化学外場など）との結合を表す。

この汎関数の重要点は、どの項もエネルギー密度であり、積分するとエネルギーになることである。したがって、各項の単位が一致していなければならない。例えば $f_{\mathrm{loc}}$ が J/m$^3$ の単位を持つなら、勾配項も同じ単位になるように $\kappa_i$ の単位が決まる。弾性項や外場項も同じ基準で整合させる必要がある。

また、勾配項は界面の有限幅を生む。局所項だけなら相は鋭く切り替わってよいが、勾配項があると空間変化が急峻になるほどエネルギーが増えるため、界面はある幅に広がる。この界面幅が数値計算では解像すべき長さスケールとなり、モデル設計と離散化設計を結びつける。

---

### 2.3 散逸とエネルギー減少
フェーズフィールド方程式は、自由エネルギーを下げる方向に時間発展するように作ることが多い。この性質は、物理的には不可逆過程の散逸に対応し、数学的には勾配流の構造として表現できる。

非保存場 $\eta$ の場合、Allen–Cahn型の時間発展を
$$
\frac{\partial \eta}{\partial t} = -L\,\frac{\delta F}{\delta \eta}
$$
と置く。$L>0$ は運動係数である。このとき、汎関数の時間微分は
$$
\frac{dF}{dt}
= \int_{\Omega} \frac{\delta F}{\delta \eta}\,\frac{\partial \eta}{\partial t}\, d\mathbf{r}
= -\int_{\Omega} L\left(\frac{\delta F}{\delta \eta}\right)^2 d\mathbf{r}
\le 0
$$
となり、自由エネルギーが単調に減少する。ここでは境界項が消えるような境界条件（例えば勾配が境界で0など）を想定している。重要なのは、運動係数が正であれば、方程式の構造だけで $dF/dt\le 0$ が保証される点である。

保存場 $c$ の場合、連続の式から
$$
\frac{\partial c}{\partial t}+\nabla\cdot \mathbf{J}=0
$$
であり、フラックスを
$$
\mathbf{J}=-M\nabla\mu,\qquad \mu=\frac{\delta F}{\delta c}
$$
と仮定する。すると
$$
\frac{\partial c}{\partial t}=\nabla\cdot\left(M\nabla\mu\right)
$$
となる。エネルギー減少は
$$
\frac{dF}{dt}
= \int_{\Omega} \frac{\delta F}{\delta c}\,\frac{\partial c}{\partial t}\, d\mathbf{r}
= \int_{\Omega} \mu\,\nabla\cdot(M\nabla\mu)\, d\mathbf{r}
= -\int_{\Omega} M|\nabla\mu|^2\, d\mathbf{r}
\le 0
$$
となり、$M>0$ であれば減少が示される。途中で部分積分を用い、境界項が消える条件（例えば $\mathbf{n}\cdot\nabla\mu=0$）を仮定した。この導出により、Cahn–Hilliard方程式が自由エネルギーを減らす拡散として理解できる。

このように、散逸の仮定は、方程式を恣意的に選ぶのではなく、熱力学的整合（エネルギー減少）を満たす形に固定する役割を持つ。連成が増えるほど、どの変数がどの形で散逸するかを明示することが、モデルの理解と拡張の両方に効く。

---

### 2.4 無次元化と単位整合
フェーズフィールド法では、界面幅や拡散係数など複数の長さ・時間スケールが登場し、式の係数が桁違いになりやすい。無次元化は、代表スケールを選び、変数と式をスケール化して数値的に扱いやすい形へ変換する操作である。無次元化は単なる書き換えではなく、支配的な項と無視できる項を見通す道具にもなる。

例えば長さスケールを $\ell_0$、エネルギー密度スケールを $f_0$、時間スケールを $t_0$ と置き、
$$
\tilde{\mathbf{r}}=\mathbf{r}/\ell_0,\quad
\tilde{t}=t/t_0,\quad
\tilde{F}=F/(f_0\ell_0^d)
$$
のように無次元量を定義する（$d$ は次元である）。このとき勾配は $\nabla = (1/\ell_0)\tilde{\nabla}$ となるため、勾配項の係数は $\kappa/(f_0\ell_0^2)$ のような無次元比として現れる。ここで界面幅を $\ell_0$ と同程度に取ると、界面近傍の変化が無次元空間で $O(1)$ に揃い、離散化設計が考えやすくなる。

単位整合は、無次元化の前提条件である。$f_{\mathrm{loc}}$ が J/m$^3$ なら、$\kappa|\nabla \eta|^2$ も J/m$^3$ でなければならず、$\kappa$ の単位は J/m となる。さらに時間発展式で $\partial_t\eta$ に現れる係数 $L$ は、$\eta$ が無次元なら $L$ の単位が (m$^3$)/(J·s) のように決まる。保存場では $M$ の単位が拡散係数と化学ポテンシャルの単位の組で決まる。ここを曖昧にすると、計算で得られた時間が現実の秒へ対応しなくなる。

連成項（弾性、電場、磁場など）を加えると、エネルギー密度の単位整合がさらに重要になる。弾性エネルギー密度は Pa = J/m$^3$ と一致するため整合しやすいが、外場項は定義次第で係数の単位が変わる。したがって、自由エネルギーをすべて同じ単位系へ統一し、どの項がどのスケールを支配するかを無次元比として整理することが、安定したモデル構築につながる。

---

### 2.5 乱雑さの導入
核生成や熱揺らぎの影響を表現したい場合、確率的な項を導入することがある。例えば非保存場では
$$
\frac{\partial \eta}{\partial t} = -L\,\frac{\delta F}{\delta \eta} + \xi(\mathbf{r},t)
$$
のように雑音項 $\xi$ を加える。保存場ではフラックスに雑音を加える形で保存則を保つ構成が用いられることが多い。どちらも、場の揺らぎが成長して相分離や核生成を誘起する状況を表すための操作である。

ここで注意すべき点は、雑音を入れることは物理仮定の追加であり、同時に数値仮定の追加でもある点である。連続体で白色雑音を仮定しても、離散化すると格子幅と時間刻みが揺らぎ強度に関係する。したがって、雑音強度を選ぶときには、どのスケールの揺らぎを表現したいのかを明確にし、離散化の変更で揺らぎが不自然に変わらないように定義を与える必要がある。

初学者の段階では、まず雑音なしの決定論的モデルで、自由エネルギーと駆動力が作る形態進化を理解することが重要である。その上で、核生成を扱いたい、微小な初期ゆらぎからの発展を扱いたい、といった目的が出たときに、雑音を熱力学（揺動散逸の考え方）と整合する形で追加するのが自然である。

---

## 第3章 変分法と支配方程式

### 3.1 機能微分とオイラー・ラグランジュ方程式
フェーズフィールド法の支配方程式は、自由エネルギー汎関数 $F[\phi]$ の機能微分 $\delta F/\delta \phi$ を計算することから得られる。機能微分とは、関数 $\phi(\mathbf{r})$ を微小に変化させたときの $F$ の変化を、線形項として書き下したときに現れる密度である。通常の微分が変数の微小変化に対する関数値の変化を与えるのと同様に、機能微分は場の微小変化に対する汎関数の変化を与える。

定義として、$\phi\to \phi+\epsilon\,\psi$ と変化させたとき
$$
\left.\frac{d}{d\epsilon}F[\phi+\epsilon\psi]\right|_{\epsilon=0}
=\int_{\Omega}\frac{\delta F}{\delta\phi}\,\psi\,d\mathbf{r}
$$
を満たす量が $\delta F/\delta\phi$ である。ここで $\psi$ は任意の試験関数である。この形に落とすためには、部分積分が必須になる。特に勾配項は $\nabla\phi$ を含むため、$\psi$ にかかる微分を $\phi$ 側に移す操作を行い、境界項を境界条件で消す。

基本例として
$$
F[\phi]=\int_{\Omega}\left( f(\phi)+\frac{\kappa}{2}|\nabla\phi|^2\right)d\mathbf{r}
$$
を考える。変分を取ると
$$
\delta F
=\int_{\Omega}\left(\frac{\partial f}{\partial\phi}\delta\phi+\kappa\nabla\phi\cdot\nabla(\delta\phi)\right)d\mathbf{r}
$$
となる。第2項を部分積分すると
$$
\int_{\Omega}\kappa\nabla\phi\cdot\nabla(\delta\phi)d\mathbf{r}
= -\int_{\Omega}\kappa(\nabla^2\phi)\,\delta\phi\,d\mathbf{r}
+\int_{\partial\Omega}\kappa(\mathbf{n}\cdot\nabla\phi)\,\delta\phi\,dS
$$
である。境界で $\mathbf{n}\cdot\nabla\phi=0$ あるいは $\delta\phi=0$ を課すと境界項が消え、結局
$$
\frac{\delta F}{\delta\phi}=\frac{\partial f}{\partial\phi}-\kappa\nabla^2\phi
$$
を得る。フェーズフィールド方程式に現れるラプラシアンは、この変分計算から自然に出るものである。

この計算手順を理解すると、多変数（$\eta_i,c$）や連成項（弾性、外場）でも、どの項がどの微分演算子を生むかを体系的に追えるようになる。初学者が最初につまずきやすいのは、部分積分と境界項の扱いであるが、境界条件は単なる数学的条件ではなく、系が外部とどう接しているかを表す物理条件である点を意識すると理解が進む。

---

### 3.2 Allen–Cahn 方程式
Allen–Cahn方程式は非保存場の時間発展を表す最も基本的な式である。構成の考え方は、秩序変数が自由エネルギーを下げる方向へ緩和すると仮定し、その速度が熱力学的駆動力 $\delta F/\delta\eta$ に比例すると置くことである。すなわち
$$
\frac{\partial \eta}{\partial t}=-L\,\frac{\delta F}{\delta\eta}
$$
であり、$L>0$ が緩和の速さを決める。

この式が自然である理由は、1次元の最急降下法と対応している点にある。有限次元でエネルギー $E(x)$ を最小化したいとき、$\dot{x}=-\lambda\,dE/dx$ とすれば $dE/dt=-\lambda(dE/dx)^2\le0$ が成り立つ。Allen–Cahn方程式は、その場 $\eta(\mathbf{r})$ 版であり、勾配が機能微分に置き換わったものと見なせる。

具体的に $F[\eta]=\int(f(\eta)+\kappa|\nabla\eta|^2/2)d\mathbf{r}$ とすると、前節の結果から
$$
\frac{\delta F}{\delta\eta}=\frac{\partial f}{\partial\eta}-\kappa\nabla^2\eta
$$
である。したがって
$$
\frac{\partial\eta}{\partial t}
=-L\left(\frac{\partial f}{\partial\eta}-\kappa\nabla^2\eta\right)
= -L\frac{\partial f}{\partial\eta}+L\kappa\nabla^2\eta
$$
となり、局所ポテンシャルが秩序変数を相の安定点へ引き寄せ、ラプラシアンが空間変化を滑らかにする役割を持つことが読み取れる。界面は局所ポテンシャルが二つの相を選ばせようとする力と、勾配項が急変を嫌う力の釣り合いで現れる。

Allen–Cahn方程式は、相変態のフロント移動、ドメイン壁移動、粒界移動など、界面が動く問題に広く用いられる。ただし、秩序変数が非保存であるため、秩序変数の領域平均は一般に保存されない。固相分率を保存したいような問題では、体積拘束項やラグランジュ未定乗数を加える設計が必要になる場合がある。何を保存すべきかは物理に依存するため、秩序変数の意味づけとともに最初に整理しておく必要がある。

---

### 3.3 Cahn–Hilliard 方程式
Cahn–Hilliard方程式は保存場の時間発展を表す基本式である。導出は、保存則と拡散の構成則を組み合わせる手順で行う。まず保存則として連続の式
$$
\frac{\partial c}{\partial t}+\nabla\cdot\mathbf{J}=0
$$
を立てる。次に、拡散の駆動力は化学ポテンシャル $\mu$ の勾配であると仮定し、線形応答として
$$
\mathbf{J}=-M\nabla\mu
$$
を置く。$M>0$ はモビリティである。ここで化学ポテンシャルは自由エネルギー汎関数の機能微分で
$$
\mu=\frac{\delta F}{\delta c}
$$
と定義する。これらを代入して
$$
\frac{\partial c}{\partial t}=\nabla\cdot\left(M\nabla\frac{\delta F}{\delta c}\right)
$$
を得る。これがCahn–Hilliard方程式である。

具体例として
$$
F[c]=\int_{\Omega}\left(f(c)+\frac{\kappa_c}{2}|\nabla c|^2\right)d\mathbf{r}
$$
を取ると
$$
\mu=\frac{\partial f}{\partial c}-\kappa_c\nabla^2 c
$$
である。したがって
$$
\frac{\partial c}{\partial t}
=\nabla\cdot\left(M\nabla\left(\frac{\partial f}{\partial c}-\kappa_c\nabla^2 c\right)\right)
$$
となり、右辺に $\nabla^4 c$ が現れる。これがCahn–Hilliard方程式が4階の空間微分を含むと言われる理由である。物理的には、界面エネルギー（勾配項）が拡散に影響し、界面近傍の濃度分布を滑らかにしつつ、相分離の駆動力を与える。

Cahn–Hilliard方程式は、スピノーダル分解のように微小ゆらぎが増幅して相分離する現象を自然に表せる。初期の濃度がほぼ一様でも、自由エネルギー曲率が負の領域にあるとき、濃度の空間変動が成長し、二相へ分かれていく。これは、$f(c)$ の形（特に $\partial^2 f/\partial c^2$ の符号）が本質であり、熱力学と数理の結びつきが直感的に見える題材である。

---

### 3.4 弱形式と有限要素への接続
偏微分方程式を数値的に解くには、差分法のように強形式をそのまま離散化する方法と、弱形式へ変換してから離散化する方法がある。有限要素法は弱形式を基本とする。弱形式は、支配方程式に試験関数を掛けて領域で積分し、部分積分により微分次数を下げることで得る。

例としてAllen–Cahn方程式
$$
\frac{\partial\eta}{\partial t} = -L\left(\frac{\partial f}{\partial\eta}-\kappa\nabla^2\eta\right)
$$
を考える。試験関数 $v$ を掛けて積分すると
$$
\int_{\Omega} v\,\frac{\partial\eta}{\partial t}\,d\mathbf{r}
= -L\int_{\Omega} v\,\frac{\partial f}{\partial\eta}\,d\mathbf{r}
+L\kappa\int_{\Omega} v\,\nabla^2\eta\,d\mathbf{r}
$$
である。最後の項を部分積分すると
$$
\int_{\Omega} v\,\nabla^2\eta\,d\mathbf{r}
= -\int_{\Omega} \nabla v\cdot\nabla\eta\,d\mathbf{r}
+\int_{\partial\Omega} v\,(\mathbf{n}\cdot\nabla\eta)\,dS
$$
となる。境界項が消える条件を仮定すれば、弱形式は
$$
\int_{\Omega} v\,\frac{\partial\eta}{\partial t}\,d\mathbf{r}
= -L\int_{\Omega} v\,\frac{\partial f}{\partial\eta}\,d\mathbf{r}
-L\kappa\int_{\Omega} \nabla v\cdot\nabla\eta\,d\mathbf{r}
$$
となる。ここで微分が $\eta$ の2階から1階へ下がっており、有限要素の近似空間（1階微分が意味を持つ関数空間）と整合する。

Cahn–Hilliard方程式は4階微分を含むため、弱形式をそのまま作ると2回の部分積分が必要となり、より高い滑らかさを要求する近似空間が必要になる。これを避けるために、化学ポテンシャル $\mu$ を未知量として導入し、
$$
\mu=\frac{\partial f}{\partial c}-\kappa_c\nabla^2 c,\qquad
\frac{\partial c}{\partial t}=\nabla\cdot(M\nabla\mu)
$$
という2階の連立系へ分割する方法が広く用いられる。この分割により、両方の式が2階となり、標準的な有限要素空間で扱いやすくなる。どの形に変形して解くかは数値手法の選択に属するが、変形の動機は微分次数と近似空間の整合にあると理解すると見通しが良い。

---

### 3.5 方程式の比較表
第3章までで現れる2つの基本方程式を、導出の出発点と構造の違いが見える形で整理する。

| 観点 | Allen–Cahn（非保存） | Cahn–Hilliard（保存） |
|---|---|---|
| 出発点 | 散逸により局所緩和する仮定 | 保存則とフラックスの構成 |
| 基本式 | $\partial_t\eta=-L\,\delta F/\delta\eta$ | $\partial_t c=\nabla\cdot(M\nabla\mu),\ \mu=\delta F/\delta c$ |
| エネルギー減少 | $dF/dt=-\int L(\delta F/\delta\eta)^2\le0$ | $dF/dt=-\int M|\nabla\mu|^2\le0$ |
| 微分次数 | 2階（勾配項がある場合） | 4階（分割で2階系へ） |
| 物理像 | 相状態が局所的に切り替わる | 物質が流れて濃度が再配分される |

この表は暗記のためではなく、どの仮定が式を決めるのかを見える化するための整理である。今後、弾性や外場を加えても、機能微分と保存則・散逸則の組み合わせという骨格は変わらない。したがって、第3章の導出を自分で再現できることが、より複雑なモデルへ進むための最短経路である。

第1〜3章では、フェーズフィールド法が拡散界面の連続場として界面問題を表し、自由エネルギー汎関数と機能微分から支配方程式を導く方法であることを示した。次段階では、界面エネルギーと異方性、多相・多成分の熱力学、弾性や外場などの連成を、同じ導出手順の延長として体系化し、計算結果が物理と対応するための条件をより具体的に詰めることになる。

## 小まとめ
第1〜3章では、フェーズフィールド法が拡散界面の連続場として界面問題を表し、自由エネルギー汎関数と機能微分から支配方程式を導く方法であることを示した。次段階では、界面エネルギーと異方性、多相・多成分の熱力学、弾性や外場などの連成を、同じ導出手順の延長として体系化し、計算結果が物理と対応するための条件をより具体的に詰めることになる。

### 参考文献
[1] L.-Q. Chen, Phase-Field Models for Microstructure Evolution, Annual Review of Materials Research 32, 2002.
[2] N. Moelans, B. Blanpain, P. Wollants, An introduction to phase-field modeling of microstructure evolution, Calphad 32, 2008.
[3] PFHub community, Phase Field Method Recommended Practices, NIST.
[4] 日本機械学会 計算力学部門, フェーズフィールド法（MED Wiki）, 2022.
[5] 小山敏幸, フェーズフィールド法（解説記事）, 2025.



## 第4章 界面エネルギーと異方性

第4章では、拡散界面モデルがどのように界面エネルギーと界面厚さを生み出すかを、自由エネルギー汎関数の形から式で導く。さらに、結晶方位に依存する界面エネルギーや三重点の角度条件が、どの項から現れるかを整理する。

### 4.1 勾配エネルギー項と平衡界面の導出
フェーズフィールド法で界面が有限幅を持つのは、自由エネルギーに勾配エネルギー項を入れるからである。最も基本的には、秩序変数を $\phi(\mathbf{r})$ とし、自由エネルギー汎関数を
$$
F[\phi] = \int_{\Omega}\left( f(\phi) + \frac{\kappa}{2}|\nabla \phi|^2\right)d\mathbf{r}
$$
と置く。ここで $f(\phi)$ は局所自由エネルギー密度、$\kappa$ は勾配係数であり、$|\nabla\phi|^2$ は界面で $\phi$ が空間変化することに伴うエネルギー増分を表す量である。

界面の形が時間変化しない平衡状態は、$F$ が極小になる条件で与えられる。したがって、機能微分を用いて
$$
\frac{\delta F}{\delta \phi}=0
$$
を満たす $\phi$ を求めるのが出発点である。前章で扱った変分計算の結果を用いると
$$
\frac{\delta F}{\delta \phi}=\frac{\partial f}{\partial \phi}-\kappa\nabla^2\phi
$$
であるから、平衡条件は
$$
\kappa\nabla^2\phi = \frac{\partial f}{\partial\phi}
$$
となる。界面が1次元で、界面法線方向を $x$ とし、$\phi=\phi(x)$ とみなすと
$$
\kappa\frac{d^2\phi}{dx^2}=\frac{df}{d\phi}
$$
となる。

平衡界面を具体的に見える形にするため、二相を表す局所自由エネルギーとして二井戸ポテンシャルを採用する。計算と解の形が素直になるように
$$
f(\phi)=\frac{W}{4}(1-\phi^2)^2
$$
を用いる。$\phi=\pm 1$ が相の安定点であり、$W$ が井戸の深さを決める。これを上の微分方程式へ代入すると
$$
\kappa\frac{d^2\phi}{dx^2} = W\,\phi(\phi^2-1)
$$
を得る。

この式は直接解いてもよいが、平衡界面の性質を理解するには、一度積分して一次方程式に落とすのが有効である。両辺に $d\phi/dx$ を掛けて積分すると
$$
\kappa\frac{d^2\phi}{dx^2}\frac{d\phi}{dx}
= \frac{df}{d\phi}\frac{d\phi}{dx}
=\frac{df}{dx}
$$
であるから
$$
\frac{d}{dx}\left(\frac{\kappa}{2}\left(\frac{d\phi}{dx}\right)^2\right)=\frac{df}{dx}
$$
となり、積分して
$$
\frac{\kappa}{2}\left(\frac{d\phi}{dx}\right)^2=f(\phi)+C
$$
を得る。界面から十分離れた領域では $\phi=\pm 1$ であり $f(\pm 1)=0$、さらに $d\phi/dx\to 0$ であるから、定数は $C=0$ である。よって
$$
\frac{\kappa}{2}\left(\frac{d\phi}{dx}\right)^2=f(\phi)
$$
が成り立つ。これは、平衡界面では勾配項と局所項が同程度に寄与することを示す式である。

上式を用いると、平衡解は
$$
\phi(x)=\tanh\left(\frac{x}{\lambda}\right),\qquad
\lambda=\sqrt{\frac{2\kappa}{W}}
$$
となる。$\lambda$ は界面厚さの尺度であり、$\kappa$ が大きいほど界面は厚くなり、$W$ が大きいほど相の切り替えが鋭くなるため界面は薄くなる。ここで界面厚さは定義に揺れがあるが、例えば $\phi$ が $-0.9$ から $+0.9$ に変化する距離などを用いれば、厚さは $O(\lambda)$ に比例する量として見積もれる。

次に界面エネルギー $\gamma$ を導く。界面エネルギーは、平衡界面を持つ系の自由エネルギー密度を界面法線方向で積分し、バルクの寄与を引いた余剰として定義できる。1次元で
$$
\gamma = \int_{-\infty}^{\infty}\left(\frac{\kappa}{2}\left(\frac{d\phi}{dx}\right)^2+f(\phi)\right)dx
$$
である。平衡界面では $\kappa(d\phi/dx)^2/2=f(\phi)$ が成り立つので
$$
\gamma = \int_{-\infty}^{\infty} \kappa\left(\frac{d\phi}{dx}\right)^2 dx
=2\int_{-\infty}^{\infty} f(\phi)\,dx
$$
とも書ける。上の $\tanh$ 解を用いると計算でき、
$$
\gamma = \frac{2\sqrt{2}}{3}\sqrt{\kappa W}
$$
となる。したがって、界面厚さ $\lambda\propto\sqrt{\kappa/W}$ と界面エネルギー $\gamma\propto\sqrt{\kappa W}$ は、同じ $\kappa, W$ から同時に決まる関係にある。

この関係は重要である。界面を薄くしたいから $\kappa$ を小さくすると、同時に $\gamma$ も変わってしまうため、界面厚さと界面エネルギーを独立に指定できないという制約が生じる。後の章で扱う多相モデルや障壁ポテンシャル、薄界面極限は、この制約を緩めて物理量としての $\gamma$ を保ちつつ数値的に扱いやすい厚さを取るための工夫として位置づけられる。

---

### 4.2 曲率効果と界面移動の力学
界面が平衡からずれると、自由エネルギーを減少させる向きに界面が移動する。非保存秩序変数 $\phi$ の基本式はAllen–Cahn型
$$
\frac{\partial\phi}{\partial t}=-L\frac{\delta F}{\delta\phi}
=-L\left(\frac{\partial f}{\partial\phi}-\kappa\nabla^2\phi\right)
$$
である。ここで $L>0$ は運動係数であり、局所ポテンシャルが相を選択する項と、ラプラシアンが界面を滑らかにする項が競合して界面運動が決まる。

界面運動を直感的に理解するため、平衡界面に近い状況で曲率の効果だけを取り出す考え方を導入する。界面が曲がっていると、界面の面積が増え、界面エネルギー $\gamma$ による自由エネルギーが増える。したがって、曲率がある界面は縮む方向へ動くのが自然である。フェーズフィールド方程式から鋭い界面の極限を取ると、界面法線速度 $V_n$ が平均曲率 $\kappa_m$ に比例する関係
$$
V_n \propto -\gamma\,\kappa_m
$$
が導かれる。比例係数はモデルの $L$ と界面の内部構造に依存するが、符号としては曲率が正なら縮む方向へ動く構造になる。

この曲率駆動は、粒界移動や析出物の粗大化で本質的である。例えば小さな析出物は曲率が大きく、界面エネルギーを下げるために消滅しやすい。逆に大きな析出物は曲率が小さく、より安定になりやすい。これらはオストワルド成長と呼ばれる現象の核にあり、フェーズフィールドでは界面追跡をせずにこれが自然に再現される。

曲率効果を定量に近づけるには、界面エネルギー $\gamma$ と界面モビリティの対応を明確にする必要がある。$L$ は単なる数値係数ではなく、界面の移動しやすさを表す物理量に接続されるべき量である。後の章で、温度依存や溶質拡散の影響を組み込むと、界面移動は局所平衡からのずれや拡散場の応答にも支配され、単純な曲率駆動だけでは説明できない現象が現れる。

---

### 4.3 界面エネルギーの異方性
結晶材料では、界面エネルギーは界面の向き（界面法線方向）に依存することがある。これは、結晶格子の面指数によって原子の結合状態が変わるためであり、表面エネルギーや粒界エネルギーが方位依存を持つことと同じ根である。フェーズフィールドで異方性を表すには、勾配エネルギー項を等方な $|\nabla\phi|^2$ から拡張するのが基本である。

最も簡潔には、界面法線 $\mathbf{n}=\nabla\phi/|\nabla\phi|$ を用いて、界面エネルギーを
$$
\gamma(\mathbf{n})=\gamma_0\,a(\mathbf{n})
$$
のように書き、$a(\mathbf{n})$ に異方性を入れる。2次元で角度 $\theta$ を用いれば
$$
a(\theta)=1+\epsilon_a\cos(m\theta)
$$
のような形がよく用いられる。$m$ は結晶対称性（例えば4回対称なら $m=4$）に対応し、$\epsilon_a$ は異方性の強さである。

フェーズフィールド汎関数に落とすには、勾配エネルギーを
$$
\frac{\kappa}{2}|\nabla\phi|^2
\quad\to\quad
\frac{\kappa}{2}a(\mathbf{n})^2|\nabla\phi|^2
$$
のように修正する方法がある。等方の場合は $a\equiv 1$ で前節に戻る。異方性が入ると、$\delta F/\delta\phi$ の計算では $a(\mathbf{n})$ が $\nabla\phi$ を通じて $\phi$ に依存するため、ラプラシアンだけでなく、異方性由来の追加項が現れる。初学者の段階では、まず $a$ を定数とみなした近似で挙動を掴み、次に厳密な変分を追うと理解が進む。

異方性の物理的効果として最も重要なのは、成長形態や平衡形状が変わる点である。界面エネルギーが小さい向きが選ばれると、結晶の外形は球ではなく、多面体やファセットを持つ形へ近づく。これはWulff構築で与えられる平衡形状の考え方と整合する。フェーズフィールドでは、界面が有限幅であるためファセットは理想的な鋭い平面ではなく、数値的な丸みを帯びるが、異方性を強くするとファセット的な形が現れやすい。

異方性を強くするときには数学的な条件も重要になる。界面剛性に相当する量が負になると、界面が不安定化し、計算でギザギザが発生することがある。これを避けるために、異方性関数の形を工夫したり、高次の勾配項を加えて正則化する方法が用いられる。ここでのポイントは、異方性は形態選択の主要因である一方、強い異方性は連続体モデルの安定性条件とも密接に結びつくという点である。

---

### 4.4 多相系と三重点の角度条件
三重点（3つの界面が交わる点）では、界面エネルギーの釣り合いが角度として現れる。鋭い界面の理論では、界面張力ベクトルのつり合い
$$
\gamma_{12}\,\mathbf{t}_{12}+\gamma_{23}\,\mathbf{t}_{23}+\gamma_{31}\,\mathbf{t}_{31}=\mathbf{0}
$$
が成立し、ここから三重点角が決まる。$\mathbf{t}_{ij}$ は界面 $ij$ に沿った接線方向の単位ベクトルである。等方で $\gamma_{12}=\gamma_{23}=\gamma_{31}$ なら、角度は $120^{\circ}$ ずつに分かれる。

フェーズフィールドで三重点を表現するには、多相を表す秩序変数 $\{\eta_i\}$ を導入し、各相の体積分率を連続的に表す。最も基本には
$$
\sum_{i=1}^{N}\eta_i=1,\qquad 0\le \eta_i\le 1
$$
という制約を置き、界面では複数の $\eta_i$ が同時に変化する。自由エネルギー密度として、例えば
$$
f_{\mathrm{loc}}(\{\eta_i\})=
W\sum_{i=1}^{N}\eta_i^2(1-\eta_i)^2
+W_{\mathrm{mix}}\sum_{i<j}\eta_i^2\eta_j^2
$$
のような多井戸型を設計し、さらに勾配項
$$
\sum_i\frac{\kappa_i}{2}|\nabla\eta_i|^2
$$
を加える。$W$ や $W_{\mathrm{mix}}$ は相の純粋性と混合状態の罰則を与える役割を持ち、三重点では3つの相が混ざる領域の自由エネルギーが大きくなるため、自然に三重点が形成される。

ここで重要なのは、三重点角が単に幾何で決まるのではなく、モデルパラメータから決まる点である。界面 $i$-$j$ の界面エネルギー $\gamma_{ij}$ は、$\eta_i,\eta_j$ の界面プロファイルを通じて $\kappa$ と $W$ から決まる。したがって、狙った三重点角を得るには、$\gamma_{ij}$ の組が狙い通りになるようにパラメータを同定する必要がある。これは、単相モデルの $\gamma\propto\sqrt{\kappa W}$ の関係が、多相モデルでは界面ごとに現れるということである。

多相モデルでは、三重点近傍のエネルギーをどのように扱うかが計算結果に効く。三重点は界面幅と同程度の領域であり、鋭い界面の角度条件が厳密に成立するのは界面幅が十分小さい極限である。界面幅が有限のままでも角度条件に近い挙動を得るには、多相ポテンシャルの形や制約の実装が重要になる。研究文献では、この点を改善する多相モデルの提案が多数あり、角度が極端な場合でも安定に再現できる工夫が議論されている。

---

### 4.5 粒界と方位場の表現
多結晶では、粒界は同じ相の中で結晶方位が異なる領域の境界である。フェーズフィールドで多結晶を表す基本的な方法は、各結晶粒を一つの秩序変数 $\eta_i$ で表し、粒界を $\eta_i$ と $\eta_j$ の遷移層として表すものである。この場合、粒界エネルギーは多相界面エネルギーの枠組みで与えられ、三重点も同様に表現できる。

しかし、粒界エネルギーは粒界の方位差（ミスオリエンテーション）や粒界面の向き（インクリネーション）に依存することが知られている。したがって、粒界の性質をより忠実に入れるには、方位場（結晶方位を連続場として表す変数）を導入したり、粒界のエネルギーを方位差の関数としてモデル化する必要がある。ここでの本質は、粒界は単なる幾何境界ではなく、結晶学的な自由度を持つ欠陥であるという点である。

方位依存を入れる単純な出発点は、粒界エネルギーを方位差 $\Delta\theta$ の関数 $\gamma_{gb}(\Delta\theta)$ として与え、勾配項や局所項の係数をその関数に接続することである。例えば、粒界の向き依存（インクリネーション依存）も扱うなら、界面法線 $\mathbf{n}$ も含めて $\gamma_{gb}(\Delta\theta,\mathbf{n})$ とする。これにより、粒界移動の駆動力が曲率だけでなく、結晶学的な条件によって変化し得ることが表現される。

粒界の扱いは、相変態と同様に、自由エネルギー設計が全ての出発点である。粒界エネルギーを正しく表したいなら、どの自由度を場として導入するか、どの自由度をパラメータへ押し込めるかを最初に決めなければならない。初学者の段階では、まず多相秩序変数モデルで粒界ネットワークと三重点の幾何を再現し、その後に方位差依存を段階的に組み込むのが理解しやすい順序である。

---

## 第5章 多成分・多相の熱力学と化学ポテンシャル

第5章では、合金や複数相が関与する系で、組成場と秩序変数をどのように整合させるかを式で導く。特に、界面での局所平衡条件をどのように実装するかが、モデルの物理性と数値安定性の両方に直結する点を丁寧に扱う。

### 5.1 二相・二元合金の自由エネルギー設計
二相 $\alpha,\beta$ があり、秩序変数 $\phi$ が $\alpha$ 側で $1$、$\beta$ 側で $0$ になるとする。合金の組成を保存場 $c(\mathbf{r},t)$ とし、自由エネルギー密度を
$$
f(\phi,c)=h(\phi)f^{\alpha}(c)+(1-h(\phi))f^{\beta}(c) + W g(\phi)
$$
と設計する。$h(\phi)$ は補間関数で、$h(0)=0, h(1)=1$ を満たす滑らかな関数である。$g(\phi)$ は二井戸ポテンシャルで、$\phi=0,1$ を安定点にする。さらに勾配項を加えて
$$
F[\phi,c]=\int_{\Omega}\left(f(\phi,c)+\frac{\kappa}{2}|\nabla\phi|^2\right)d\mathbf{r}
$$
とする。

この設計の狙いは明快である。$\phi$ が $0$ に近い場所では $f^{\beta}(c)$ が支配的となり、$\phi$ が $1$ に近い場所では $f^{\alpha}(c)$ が支配的となる。界面では $h(\phi)$ によって両相の自由エネルギーが混合され、さらに $W g(\phi)$ と勾配項が界面構造を作る。こうして相の熱力学（$f^{\alpha}, f^{\beta}$）と界面の性質（$W,\kappa$）が同じ汎関数の中で統一される。

このまま機能微分を取ると、化学ポテンシャルは
$$
\mu=\frac{\delta F}{\delta c}
= h(\phi)\frac{df^{\alpha}}{dc}+(1-h(\phi))\frac{df^{\beta}}{dc}
$$
となる。ここで注意すべきは、界面（$0<\phi<1$）で $\mu$ が相ごとの化学ポテンシャルの単純平均になる点である。現実の合金界面では、局所平衡が成立するなら、界面で相ごとの化学ポテンシャルは等しくなるのが自然である。ところが単純補間では、その条件が自動的には満たされないため、界面で不自然な濃度プロファイルや余分な界面エネルギー寄与が現れることがある。

この問題を避けるために、局所平衡条件をより明示的に組み込む枠組みが導入されてきた。その代表がKKS（Kim–Kim–Suzuki）型モデルである。次節では、KKSの導出を、拘束付き最小化として筋道立てて示す。

---

### 5.2 KKSモデルの導出
KKSモデルの考え方は、界面での局所平衡を強制するために、相ごとの組成を別変数として導入する点にある。二相 $\alpha,\beta$ の相組成を $c^{\alpha},c^{\beta}$ とし、系の全組成 $c$ は
$$
c = h(\phi)c^{\alpha} + (1-h(\phi))c^{\beta}
$$
で与えるとする。これは、界面では両相の寄与が混ざるが、各相自体は相組成を持つという考え方である。

自由エネルギー密度は
$$
f_{\mathrm{KKS}}(\phi,c^{\alpha},c^{\beta})
= h(\phi)f^{\alpha}(c^{\alpha})+(1-h(\phi))f^{\beta}(c^{\beta}) + W g(\phi)
$$
と置く。ここで $c$ 自体は独立変数として持ってもよいが、$c^{\alpha},c^{\beta}$ と拘束式で結びつくため、界面での扱いが変わる。局所平衡条件は、固定した $\phi$ と $c$ のもとで、$c^{\alpha},c^{\beta}$ が自由エネルギーを最小化するという条件から導出できる。

拘束付き最小化として、ラグランジュ未定乗数 $\mu$ を導入し
$$
\mathcal{L}
= h f^{\alpha}(c^{\alpha})+(1-h) f^{\beta}(c^{\beta})
+ \mu\left(c - h c^{\alpha} - (1-h)c^{\beta}\right)
$$
を考える。$c^{\alpha},c^{\beta}$ に関して停留条件を取ると
$$
\frac{\partial\mathcal{L}}{\partial c^{\alpha}}
= h\frac{df^{\alpha}}{dc^{\alpha}} - \mu h =0,
\qquad
\frac{\partial\mathcal{L}}{\partial c^{\beta}}
= (1-h)\frac{df^{\beta}}{dc^{\beta}} - \mu (1-h)=0
$$
である。$0<h<1$ の界面領域では $h$ と $(1-h)$ は0ではないから
$$
\frac{df^{\alpha}}{dc^{\alpha}}=\mu,
\qquad
\frac{df^{\beta}}{dc^{\beta}}=\mu
$$
を得る。すなわち
$$
\mu^{\alpha}=\mu^{\beta}=\mu
$$
であり、界面で相ごとの化学ポテンシャルが等しいという局所平衡条件が自然に現れたことになる。

KKSの計算では、各格子点・各時刻で、与えられた $(\phi,c)$ に対し、未知の $(c^{\alpha},c^{\beta},\mu)$ を上の条件と拘束式
$$
c = h c^{\alpha} + (1-h)c^{\beta}
$$
を同時に満たすように求める。これは一般に非線形方程式であり、数値的にはニュートン法などで解くことになる。初学者が理解すべき点は、KKSは方程式を増やしているのではなく、界面での熱力学条件を満たすために必要な自由度を追加し、その代わりに等式条件で閉じているという構造である。

この構造により、界面での組成プロファイルが局所平衡に沿って決まりやすくなる。結果として、界面の余剰自由エネルギーが本来の界面エネルギーに近づき、相図や分配係数に整合する挙動が得られやすい。KKSは合金凝固や析出で広く使われるが、その核は、拘束付き最小化から局所平衡条件を導く点にある。

---

### 5.3 多成分系への拡張と拡散ポテンシャル
多成分合金では、組成はスカラーではなくベクトルである。成分数を $N$ とし、モル分率を $\mathbf{c}=(c_1,\dots,c_N)$ とすると、拘束 $\sum_i c_i=1$ があるため独立変数は $N-1$ 個である。熱力学的な駆動力も化学ポテンシャル $\mu_i=\partial f/\partial c_i$ の集合として現れるが、拘束のため独立な駆動力は $N-1$ 個の拡散ポテンシャル（ある成分を基準にした差）として扱うのが自然である。

保存則は各成分に対して
$$
\frac{\partial c_i}{\partial t}+\nabla\cdot\mathbf{J}_i=0
$$
である。ただし $\sum_i c_i=1$ を保つためには $\sum_i \mathbf{J}_i=\mathbf{0}$ が必要となる。線形非平衡熱力学では、フラックスはポテンシャル勾配に比例し、一般にはオンザガー行列 $L_{ij}$ を用いて
$$
\mathbf{J}_i = -\sum_{j=1}^{N-1} L_{ij}\nabla\tilde{\mu}_j
$$
のように書ける。ここで $\tilde{\mu}_j$ は独立な拡散ポテンシャルである。行列 $L$ は正定値（または半正定値）である必要があり、これが自由エネルギーの単調減少に対応する。二元合金の $\mathbf{J}=-M\nabla\mu$ は、この多成分形式の特別な場合である。

多成分KKSでは、相ごとに組成ベクトル $\mathbf{c}^{\alpha},\mathbf{c}^{\beta}$ を導入し、拘束
$$
\mathbf{c}=h(\phi)\mathbf{c}^{\alpha}+(1-h(\phi))\mathbf{c}^{\beta}
$$
を課す。局所平衡条件は、全ての独立成分に対して
$$
\tilde{\mu}^{\alpha}_j=\tilde{\mu}^{\beta}_j
\qquad (j=1,\dots,N-1)
$$
となる。これは二元合金の $\mu^{\alpha}=\mu^{\beta}$ の自然な拡張である。未知数の数は増えるが、熱力学の条件を満たすという意味では必要な構造である。

多成分系では、相図との整合が特に重要になる。$f^{\alpha}(\mathbf{c}), f^{\beta}(\mathbf{c})$ をどのように与えるかが、分配や平衡組成を支配するからである。CALPHADの自由エネルギーを用いると、実合金の相図を直接反映できるが、その場合は $f$ の形が複雑で、数値的に局所平衡方程式を解く負担が増える。したがって、物理の正確さと数値の負担のバランスを、研究目的に沿って決める必要がある。

---

### 5.4 グランドポテンシャル形式の導出
KKSは局所平衡を満たしやすいが、界面エネルギーへの寄与や多成分への拡張で議論が複雑になりやすい。これに対して、化学ポテンシャルを主変数として扱うグランドポテンシャル形式は、熱力学の構造をより直接に組み込む方法として発展してきた。ここでは、二元系の要点を式で導く。

自由エネルギー密度 $f(c)$ に対し、化学ポテンシャル $\mu$ を用いてグランドポテンシャル密度を
$$
\omega(\mu)= f(c)-\mu c
$$
と定義する。ただし右辺には $c$ が残るため、正確には $c=c(\mu)$ を熱力学関係
$$
\mu = \frac{df}{dc}
$$
から解き、$\omega$ を $\mu$ の関数として表す。相ごとに $\omega^{\alpha}(\mu),\omega^{\beta}(\mu)$ を作ると、局所平衡において相境界で $\mu$ が連続であるという条件が自然に入る。

二相系の汎関数を
$$
\Omega[\phi,\mu]
=\int_{\Omega}\left(
h(\phi)\omega^{\alpha}(\mu)+(1-h(\phi))\omega^{\beta}(\mu)
+W g(\phi)
+\frac{\kappa}{2}|\nabla\phi|^2
\right)d\mathbf{r}
$$
のように置く。ここで未知場は $\phi$ と $\mu$ である。組成場は主変数としては持たず、各点で
$$
c(\phi,\mu)= -\frac{\partial}{\partial\mu}\left(
h\omega^{\alpha}+(1-h)\omega^{\beta}
\right)
= h c^{\alpha}(\mu)+(1-h)c^{\beta}(\mu)
$$
として従属的に求める。最後の等式は、熱力学恒等式 $c=-\partial\omega/\partial\mu$ を相ごとに用いたものである。

時間発展式は、$\phi$ については非保存場として
$$
\frac{\partial\phi}{\partial t}
=-L\frac{\delta\Omega}{\delta\phi}
$$
と置く。$\mu$ は保存場に対応するため、$\mu$ 自身の拡散方程式を直接書くより、組成保存則を通して導くのが自然である。組成は $c(\phi,\mu)$ により与えられるので、
$$
\frac{\partial c(\phi,\mu)}{\partial t}=\nabla\cdot\left(M\nabla\mu\right)
$$
と置く。左辺は連鎖律で
$$
\frac{\partial c}{\partial t}
=\frac{\partial c}{\partial\phi}\frac{\partial\phi}{\partial t}
+\frac{\partial c}{\partial\mu}\frac{\partial\mu}{\partial t}
$$
であるから、$\partial c/\partial\mu$ が実質的な容量（感受率）として働き、$\mu$ の時間発展が定まる。初学者の段階では、ここで大切なのは、$\mu$ を主変数にすることで相ごとの局所平衡が熱力学関係として自然に組み込まれ、組成は従属変数として決まるという構造である。

この形式は、CALPHADデータベースとの接続でも有利になることがある。CALPHADはしばしば $f(c)$ を直接与えるが、実装上は $\mu$ を媒介して相ごとの平衡組成を求める手続きが組み込まれている場合が多い。グランドポテンシャル形式は、その手続きを場の方程式のレベルへ持ち込む構造であり、相境界での局所平衡を保ったまま多成分へ拡張しやすいことが動機になる。

---

### 5.5 自由エネルギー形式の比較
合金の相変態をフェーズフィールドで扱うとき、自由エネルギーの書き方は計算結果を決める主要因である。ここでは、二相合金に対する代表的な3形式を整理し、何が条件として入るのかを見える形にする。

| 形式 | 主変数 | 局所平衡の入り方 | 追加未知量 |
|---|---|---|---|
| 単純補間 | $(\phi,c)$ | 自動では満たされない場合がある | なし |
| KKS | $(\phi,c,c^{\alpha},c^{\beta})$ | $\mu^{\alpha}=\mu^{\beta}$ を拘束で満たす | 相組成 |
| グランドポテンシャル | $(\phi,\mu)$ | $c=-\partial\omega/\partial\mu$ により自然に入る | なし（組成は従属） |

単純補間は式が短く理解しやすいが、界面での熱力学条件が崩れると、界面付近の濃度場や駆動力が不自然になる場合がある。これは、界面が有限幅であることと、相ごとの自由エネルギーを単純に混ぜることの組合せから生じる。したがって単純補間を使うなら、界面厚さや補間関数の形を変えたときに相図整合がどの程度保たれるかを、自分の対象で必ず検証する必要がある。

KKSは、拘束付き最小化から局所平衡条件が導かれるため、界面での化学ポテンシャル連続が保たれやすい。代わりに、相組成を毎時刻・毎点で求める手続きが入るため、数値的な負担は増える。しかしその負担は、熱力学的に正しい条件を満たすための代償であり、相分配や界面組成が重要な問題では有力な選択肢になる。

グランドポテンシャル形式は、化学ポテンシャルを主変数とすることで局所平衡を構造として組み込みやすい。多成分化では複数の拡散ポテンシャルが主変数となり、組成は従属的に決まる。CALPHADと結合する議論では、ポテンシャルを媒介に相特性を与える枠組みと相性がよいことが多い。初学者は、どれが正しいかではなく、どの物理条件をどの位置で課しているかという観点で三つを見分けることが重要である。

---

## 小まとめ
第4章では、勾配エネルギー項から平衡界面の形、界面厚さ、界面エネルギーを導き、さらに異方性や三重点の角度条件が自由エネルギー設計から現れることを整理した。第5章では、合金系で局所平衡を満たすための自由エネルギー形式として、KKSとグランドポテンシャルを拘束条件と熱力学恒等式から導出した。次に進むべき課題は、これらのモデルを鋭い界面極限や薄界面極限で整理し、材料定数（界面エネルギー、モビリティ、拡散係数）との対応を数式レベルで明確化することである。

---

## 参考文献
[1] S. G. Kim, W. T. Kim, T. Suzuki, Phase-field model for binary alloys, Physical Review E, 1999.  
[2] N. Moelans, B. Blanpain, P. Wollants, An introduction to phase-field modeling of microstructure evolution, Calphad, 2008.  
[3] N. Moelans, B. Blanpain, P. Wollants, Quantitative analysis of grain boundary properties in a generalized phase-field model, Physical Review B, 2008.  
[4] A. Choudhury, B. Nestler, Grand-potential formulation for multicomponent phase transformations, Physical Review E, 2012.  
[5] M. Ohno, Quantitative phase-field modeling and simulations of solidification microstructures, ISIJ International, 2020.  
[6] 大野宗一, 合金の組織形成過程のフェーズフィールドシミュレーション, まてりあ, 2009.  
[7] 名古屋大学講義資料, Phase-field法（凝固）関連講義ノート, 2007頃.  
[8] 日本金属学会資料, フェーズフィールド法による組織形成関連解説, 2011.  



本章群では、フェーズフィールド法を材料の熱力学に基づく場の理論として捉えたうえで、力学場・熱場・流体場・結晶方位場を同一の自由エネルギー枠組みで結び付ける方法を述べる。特に、各場の支配方程式がどのように自由エネルギー汎関数から導かれ、数値計算としてどのような連立問題に落ちるかを、大学3年生レベルの線形代数・微積分・基礎物理を前提に丁寧に記述する。

---

## 第6章 弾性・塑性・欠陥場との連成

### 6.1 弾性エネルギーと固有ひずみ
固相内の相変態や析出では、相ごとに格子定数や結晶対称性が異なるため、同一の空間に相が共存すると変形の不整合が生じる。この不整合を、相（秩序変数）に依存する固有ひずみ（変態ひずみ）$\boldsymbol{\varepsilon}^*(\boldsymbol{\eta})$ として導入し、弾性エネルギーを自由エネルギーに加えるのが基本である。小ひずみ・線形弾性の範囲では、変位場$\mathbf{u}$からひずみが
$$
\boldsymbol{\varepsilon}(\mathbf{u})
=\frac{1}{2}\left(\nabla\mathbf{u}+(\nabla\mathbf{u})^{\mathsf{T}}\right)
$$
で与えられ、弾性ひずみは全ひずみから固有ひずみを差し引いた
$$
\boldsymbol{\varepsilon}^{\mathrm{e}}
=\boldsymbol{\varepsilon}(\mathbf{u})-\boldsymbol{\varepsilon}^*(\boldsymbol{\eta})
$$
として定義できる。

弾性エネルギー密度は、弾性定数テンソル$\mathbb{C}$を用いて
$$
f_{\mathrm{el}}
=\frac{1}{2}\,\boldsymbol{\varepsilon}^{\mathrm{e}}:\mathbb{C}:\boldsymbol{\varepsilon}^{\mathrm{e}}
=\frac{1}{2}\,(\boldsymbol{\varepsilon}-\boldsymbol{\varepsilon}^*):\mathbb{C}:(\boldsymbol{\varepsilon}-\boldsymbol{\varepsilon}^*)
$$
である。ここで「$: $」は二階テンソルの二重内積を表し、成分表示では$\mathbf{A}:\mathbf{B}=\sum_{i,j}A_{ij}B_{ij}$である。固有ひずみは、析出相の体積ミスマッチ（等方的）であれば$\boldsymbol{\varepsilon}^*=\varepsilon_0\mathbf{I}$の形になり、マルテンサイト変態のようにせん断成分を持てば非対角成分を含む形になる。どの成分が非ゼロであるかが、最終的な形態（板状・針状・ラメラなど）や配列秩序に強い影響を与える。

重要なのは、弾性が長距離相互作用である点である。$\boldsymbol{\varepsilon}^*$が局所的に変化しても、機械平衡を満たすために変位場$\mathbf{u}$が空間全体で調整され、応力が遠方まで伝播する。フェーズフィールドの局所エネルギー（化学自由エネルギー）や勾配エネルギーが主として界面近傍を支配するのに対し、弾性項は組織スケールの選択則そのものを変え得る。したがって、弾性連成を入れると、同じ化学系でも等方的なドメイン分割から方向性のある配列へと組織が変わることがある。

さらに、弾性不均質（相ごとに$\mathbb{C}$が異なる）を扱う場合、弾性エネルギーは単に局所式を足し合わせるだけでは閉じず、実装上は機械平衡を通じた場の解として定まる。これを理論的に整理する枠組みとして、均質媒質に写像して有効な固有ひずみを定義する「マイクロエラスティシティ」の考え方が広く用いられる。結果として、弾性エネルギーは秩序変数場の汎関数となり、フェーズフィールド方程式における変分$\delta F/\delta\eta$に弾性由来の非局所項が現れる。

---

### 6.2 機械平衡と境界条件
準静的弾性（慣性を無視）では、機械平衡は
$$
\nabla\cdot\boldsymbol{\sigma}=\mathbf{0}
$$
で与えられる。応力$\boldsymbol{\sigma}$は線形弾性で
$$
\boldsymbol{\sigma}=\mathbb{C}:\boldsymbol{\varepsilon}^{\mathrm{e}}
=\mathbb{C}:\left(\boldsymbol{\varepsilon}(\mathbf{u})-\boldsymbol{\varepsilon}^*(\boldsymbol{\eta})\right)
$$
である。ここまでで、未知量は変位$\mathbf{u}$と秩序変数$\boldsymbol{\eta}$（あるいは組成$c$）であり、弾性連成は「$\boldsymbol{\eta}$が$\boldsymbol{\varepsilon}^*$を作り、$\mathbf{u}$が平衡を満たすように決まり、その結果の$\boldsymbol{\sigma}$が再び$\boldsymbol{\eta}$の駆動力に入る」という循環構造を持つ。

境界条件は、(1) 変位境界（ディリクレ条件）$\mathbf{u}=\bar{\mathbf{u}}$、(2) 表面力（トラクション）境界（ノイマン条件）$\boldsymbol{\sigma}\mathbf{n}=\bar{\mathbf{t}}$、(3) 周期境界、のいずれか（または組合せ）で与えることが多い。例えば、外部から引張りを与える問題では、平均ひずみを規定する方法（周期境界＋平均ひずみ制約）と、端面にトラクションを与える方法で、内部応力の分布が変わり得る。固有ひずみがある場合、拘束が強いほど内部応力が大きくなり、析出形状や配列がより顕著に変化しやすい。

数値実装に向けては、弱形式を導くと見通しがよい。仮想変位$\delta\mathbf{u}$に対して
$$
\int_{\Omega}\boldsymbol{\sigma}:\delta\boldsymbol{\varepsilon}\,dV
-\int_{\partial\Omega_{t}}\bar{\mathbf{t}}\cdot\delta\mathbf{u}\,dS
=0
$$
が成り立つ（$\partial\Omega_t$はトラクション境界）。ここで$\delta\boldsymbol{\varepsilon}=\frac{1}{2}(\nabla\delta\mathbf{u}+(\nabla\delta\mathbf{u})^{\mathsf{T}})$である。この形にすると、有限要素法では通常の線形弾性問題として組み立てられ、右辺に固有ひずみ由来の「等価体積力」的な寄与が入ると理解できる。スペクトル法（フーリエ法）を用いる場合は、周期境界のもとでフーリエ空間に変換し、グリーン関数により$\mathbf{u}$や$\boldsymbol{\sigma}$を効率的に求める構成がよく用いられる。

境界条件の選択は、単なる数学的選好ではなく物理の一部である。薄膜・基板拘束では面内平均ひずみがほぼ固定され、バルク材料とは異なる析出配列が生じることがある。微小領域の計算でも、周期境界を使うと「無限に繰り返す材料」を暗に仮定するため、孤立析出物の応力緩和を表しにくい場合がある。したがって、対象の実験条件（拘束の有無、自由表面の存在、基板や治具）を力学境界に翻訳する作業が必要である。

---

### 6.3 塑性と不可逆性の導入
弾性だけでなく塑性が関与する問題（加工熱処理、変態誘起塑性、応力緩和を伴う析出など）では、ひずみ分解を拡張するのが基本である。小ひずみ近似のもとで
$$
\boldsymbol{\varepsilon}
=\boldsymbol{\varepsilon}^{\mathrm{e}}+\boldsymbol{\varepsilon}^{\mathrm{p}}+\boldsymbol{\varepsilon}^{*}
$$
とし、$\boldsymbol{\varepsilon}^{\mathrm{p}}$を塑性ひずみとして内部変数にする。すると応力は
$$
\boldsymbol{\sigma}=\mathbb{C}:\boldsymbol{\varepsilon}^{\mathrm{e}}
=\mathbb{C}:\left(\boldsymbol{\varepsilon}-\boldsymbol{\varepsilon}^{\mathrm{p}}-\boldsymbol{\varepsilon}^{*}\right)
$$
で与えられる。ここで$\boldsymbol{\varepsilon}^{\mathrm{p}}$が時間発展することが、不可逆性（履歴依存）を表現する核になる。

塑性の発展式は、エネルギー散逸と整合するように構成する必要がある。最も基礎的には、散逸$D$を
$$
D=\boldsymbol{\sigma}:\dot{\boldsymbol{\varepsilon}}^{\mathrm{p}}\ge 0
$$
となるように定める（点ごとの局所散逸である）。この不等式が破れると、計算上は外力がなくても塑性が勝手に減少してエネルギーが増えたり、非物理的な振動が生じたりし得る。散逸を保証する構成として、(i) 降伏関数$f(\boldsymbol{\sigma},\ldots)\le 0$と整合条件（古典塑性）を入れる方法、(ii) 粘塑性（Perzyna型など）として
$$
\dot{\boldsymbol{\varepsilon}}^{\mathrm{p}}=\dot{\gamma}\,\frac{\partial g}{\partial\boldsymbol{\sigma}},
\qquad
\dot{\gamma}=\left\langle \frac{f}{\sigma_0}\right\rangle^m
$$
のように過応力で滑らかに流す方法、が用いられる。大学レベルの理解としては、粘塑性は「降伏を厳密に満たす」代わりに、時間刻みの中で徐々に降伏面へ近づく表現であり、数値的に扱いやすいことが多いと捉えるとよい。

フェーズフィールドとの結合は主に2通りである。第一は、塑性を「応力緩和機構」として導入し、固有ひずみが作る応力集中を塑性流動で緩和させる結合である。第二は、塑性による転位密度の蓄積を貯蔵エネルギーとして自由エネルギーに入れ、再結晶や粒成長の駆動力に変換する結合である（第8章と接続する）。いずれにせよ、塑性は拡散や界面移動よりも速いことも遅いこともあり得るため、時間スケールの相対関係が計算の難しさを決める。強連成では、塑性更新とフェーズフィールド更新を交互に行うだけでは収束しない場合があり、同時解法や内点反復が必要になることがある。

---

### 6.4 欠陥場、空孔、拡散と応力
空孔や溶質拡散が応力と結合する現象は、熱力学的には「応力が化学ポテンシャルを変える」と表現できる。最も基本的な導出は、自由エネルギー汎関数を
$$
F[c,\mathbf{u}]
=\int_{\Omega}\left(
f_{\mathrm{ch}}(c)+\frac{\kappa}{2}|\nabla c|^2
+f_{\mathrm{el}}(c,\mathbf{u})
\right)\,dV
$$
とし、組成$c$に関する変分で化学ポテンシャル（より正確には拡散を駆動するポテンシャル）を
$$
\mu=\frac{\delta F}{\delta c}
=\frac{\partial f_{\mathrm{ch}}}{\partial c}-\kappa\nabla^2 c
+\frac{\partial f_{\mathrm{el}}}{\partial c}
$$
と定義することである。最後の項$\partial f_{\mathrm{el}}/\partial c$が「応力による寄与」を生み、例えば格子膨張係数（化学ひずみ）を$\boldsymbol{\varepsilon}^*(c)=\beta(c-c_0)\mathbf{I}$と置けば、$f_{\mathrm{el}}$を介して$\mu$に静水圧応力に比例する項が現れる。直感的には、圧縮応力場では原子の入れ替わりが起きにくくなったり、逆に空孔が集まりやすくなったりする方向に駆動力が変化する、ということである。

拡散方程式は保存則として
$$
\frac{\partial c}{\partial t}=-\nabla\cdot\mathbf{J},
\qquad
\mathbf{J}=-M\nabla\mu
$$
と書けるため、結局
$$
\frac{\partial c}{\partial t}=\nabla\cdot\left(M\nabla\mu\right)
$$
というCahn–Hilliard型の形になる。ここで$M$はモビリティであり、温度や相によって変えることも多い（固相では小さく、液相では大きいなど）。この式の中に弾性由来の$\mu$が入ることで、応力場が拡散を偏らせ、偏った拡散がさらに固有ひずみを変えて応力場を変えるという双方向結合が成立する。

欠陥場を連続場として扱う場合、空孔濃度$c_{\mathrm{v}}$や転位密度$\rho$を場変数として導入し、自由エネルギーに欠陥の生成エネルギーや相互作用（例えば$\rho$に比例する貯蔵エネルギー）を加える。たとえば転位密度に対して
$$
f_{\mathrm{store}}(\rho)=\frac{1}{2}G b^2 \rho
$$
のような形（$G$は剛性率、$b$はバーガースベクトルの大きさ）を入れると、塑性加工で$\rho$が増える領域が高い内部エネルギーを持つことになり、熱処理時の再結晶や粒成長の駆動力として働く。より進んだモデルでは、転位が作る内部応力場を弾性場に組み込むために、転位密度テンソルや滑り系ごとの内部変数を導入し、相変態と転位構造の相互作用を表すこともある。ただし学部レベルの理解としては、欠陥は「自由エネルギーに追加の蓄積項と散逸の道筋を与えるもの」であり、拡散・相変態の駆動力に新しい空間不均一を持ち込む、と把握しておくのが有効である。

---

### 6.5 数値実装上の連成の形
弾性・塑性・欠陥場をフェーズフィールドに結合すると、楕円型方程式（機械平衡）と放物型方程式（拡散、秩序変数の緩和）が同居する連立問題になる。機械平衡は時間微分を含まないため、時間積分の各ステップで「その時刻の秩序変数・組成に整合する弾性場を解く」形になりやすい。この解き方は、計算手順としては自然である一方、強連成では反復が必要になり、反復回数が計算量を支配することがある。

大別すると、(i) 分離型（逐次型）と、(ii) 同時型（モノリシック型）に整理できる。分離型では、時刻$n\to n+1$の更新において、まず弾性場$\mathbf{u}$を解いて$f_{\mathrm{el}}$や$\boldsymbol{\sigma}$を得てから、秩序変数や組成を時間発展させる。この形は実装が比較的単純であり、既存の弾性ソルバを利用しやすい。一方、同時型では、未知ベクトルを$\{\mathbf{u},c,\boldsymbol{\eta},\boldsymbol{\varepsilon}^{\mathrm{p}},\ldots\}$としてまとめ、ニュートン法などで同一反復の中で同時に更新する。強く結合した問題では同時型が収束しやすいことがあるが、ヤコビアン（線形化）の組み立てと前処理が難しくなる。

連成の難しさは、物理の強さだけでなく、数式の剛性（stiffness）にも由来する。界面幅を小さくすると勾配エネルギー項が大きな二階微分を含み、時間刻みが制約されやすい。塑性を硬く（降伏を鋭く）すると、応力更新が非線形になり反復が増えやすい。さらに、拡散モビリティが相で大きく変わると、同じ時間刻みでも場所によって実効的な拡散距離が異なり、数値的に不均一性が増す。これらは「どれか一つの場を高精度化すると他の場の更新が難しくなる」という形で現れるため、モデル化（界面幅、モビリティ、粘性化）と数値解法（陰解法、線形ソルバ、前処理）を同時に設計する必要がある。

以下に、連成の取り扱いを整理するための比較表を示す。

| 方式 | 主要な未知 | 長所 | 短所 |
|---|---|---|---|
| 分離型（逐次反復） | まず$\mathbf{u}$、次に$c,\boldsymbol{\eta}$ | 実装が比較的容易で既存ソルバを使いやすい | 強連成で反復が増えやすく、収束しない場合がある |
| 同時型（モノリシック） | $\{\mathbf{u},c,\boldsymbol{\eta},\boldsymbol{\varepsilon}^{\mathrm{p}},\ldots\}$ | 強連成で収束しやすい場合がある | ヤコビアンと前処理の設計が難しい |
| スペクトル弾性＋PF | 周期境界の$\mathbf{u}$をフーリエで解く | 大規模3Dで弾性が高速 | 周期境界が前提になりやすい |
| FEM弾性＋PF | 任意境界の$\mathbf{u}$を要素で解く | 複雑形状・境界条件に強い | 反復と線形解法が計算量を支配しやすい |

---

## 第7章 熱・流体・凝固と成長

### 7.1 熱伝導と潜熱
凝固や固相変態が起きると、潜熱の放出・吸収によって温度場が変化し、温度が変わることで相変態の駆動力が変化する。したがって、温度$T$は外部条件として与えるだけでなく、エネルギー保存則に基づく場として扱うことが多い。最も基本的な形は熱伝導方程式
$$
\rho c_p\frac{\partial T}{\partial t}=\nabla\cdot(k\nabla T)+Q
$$
であり、$\rho$は密度、$c_p$は比熱、$k$は熱伝導率、$Q$は単位体積あたりの発熱項である。

潜熱は、相の進行を表す秩序変数$\phi$（液相$\phi=0$、固相$\phi=1$など）に結び付けて表すのが分かりやすい。例えば、潜熱$L$を用いて
$$
Q= -\rho L\,\frac{\partial \phi}{\partial t}
$$
と置くと、$\phi$が増える（凝固）ときに$Q>0$となり発熱（潜熱放出）を表現できる。符号の取り方は$\phi$の定義に依存するため、凝固で温度が上がる向きに整合するように置くのが要点である。さらに厳密には、温度依存の自由エネルギー$f(\phi,c,T)$を用意し、$\phi$の時間発展式（Allen–Cahn型）を
$$
\frac{\partial \phi}{\partial t}=-L_{\phi}\,\frac{\delta F}{\delta \phi}
$$
と書けば、$\delta F/\delta\phi$に温度依存項が入り、温度場が相変態を駆動する道筋が明示される。

実装上の代表的な工夫として、エンタルピー法（有効比熱法）がある。エンタルピー$H(T,\phi)$を導入し、
$$
\frac{\partial H}{\partial t}=\nabla\cdot(k\nabla T)
$$
の形で解くと、潜熱を$H$の中に吸収させた扱いができる。これにより、潜熱項を陽に扱うときに起きやすい温度の過剰な振動を抑えやすい。学部段階では、熱方程式は「保存則なので形が崩れにくいが、潜熱が入ると非線形結合が増える」と理解するとよい。

---

### 7.2 対流と溶質輸送
溶融池や液相が連続的に存在する凝固では、対流が溶質輸送と界面形態に強く影響する。溶質境界層が対流で薄くなると、同じ冷却条件でも偏析の強さやセル／デンドライトの間隔が変わり得る。流体は非圧縮とみなせる場合が多く、ナビエ・ストークス方程式は
$$
\rho\left(\frac{\partial \mathbf{v}}{\partial t}+\mathbf{v}\cdot\nabla\mathbf{v}\right)
=-\nabla p+\nabla\cdot\left(\mu(\nabla\mathbf{v}+(\nabla\mathbf{v})^{\mathsf{T}})\right)+\mathbf{f},
\qquad
\nabla\cdot\mathbf{v}=0
$$
である（$\mathbf{v}$は流速、$p$は圧力、$\mu$は粘性）。熱対流を入れる場合はBoussinesq近似で体積力$\mathbf{f}$に温度依存の浮力項を入れるが、付加製造の溶融池では表面張力勾配（マランゴニ力）が支配的になることもある。

溶質（組成）輸送は、移流拡散方程式
$$
\frac{\partial c}{\partial t}+\mathbf{v}\cdot\nabla c=\nabla\cdot(D\nabla c)
$$
で表される（$D$は拡散係数）。ここに相場$\phi$を組み込むには、$D$を相依存にして固相で小さく液相で大きくする、あるいはフェーズフィールドに整合した「有効拡散方程式」を用いる。さらに、固液界面では分配（$k$値）や界面輸送（溶質の取り込み）が現れるため、薄界面極限の議論と整合させた補正（反捕捉流など）が重要になる（第4章・第5章で扱う薄界面極限と接続する）。

固液共存領域に流体を入れる場合、固相の剛体性を表すために、多孔質抵抗に似た減衰項を運動方程式に追加することがある。例えば
$$
\mathbf{f}_{\mathrm{drag}}=-A(\phi)\mathbf{v}
$$
とし、固相で$A(\phi)$が大きく液相で小さくなるように設計すると、固相内の流速が抑えられる。こうしたモデル化は、現象の本質（対流が効くのは主に液相）を式に反映するための手段である。

---

### 7.3 多相凝固と結晶粒競合
多結晶凝固では、同じ液相から異なる結晶方位が成長し、競合によって柱状晶・等軸晶・混合組織が形成される。フェーズフィールドでこれを扱うには、複数の秩序変数$\{\phi_i\}$で各粒（方位）を表す方法（マルチオーダーパラメータ）と、方位を連続変数として表す方法（方位場モデル）がある（第8章で後者を詳述する）。前者では、各点で
$$
\sum_{i=1}^{N}\phi_i=1,\qquad 0\le \phi_i\le 1
$$
の拘束を課し、$\phi_i$が優勢な領域を粒$i$とみなす。

自由エネルギーは、界面エネルギーと障壁項を含む形として
$$
F[\{\phi_i\}]
=\int_{\Omega}\left(
\sum_{i<j}\frac{\sigma_{ij}}{2}|\nabla(\phi_i-\phi_j)|^2
+W\sum_{i<j}\phi_i^2\phi_j^2
\right)\,dV
+\text{（熱・溶質項）}
$$
のように構成できる（$\sigma_{ij}$は粒界エネルギー、$W$は障壁の強さ）。この形の利点は、三重点や多重点が界面追跡なしに自然に出現し、粒界ネットワークが自律的に更新される点にある。凝固ではさらに、界面の異方性（結晶方位に依存する界面エネルギーや界面動力学）を入れる必要があるため、勾配項や動力学係数を方位に依存させる。

粒競合の理解には、局所の過冷却と界面法線方向が重要である。温度勾配が大きいと柱状晶が前方へ選択成長しやすいが、核生成（等軸晶）が頻発すると等軸晶が優勢になり得る。フェーズフィールドでは、核生成を確率的に入れる方法もあるが、まずは「既に複数粒が存在する初期条件で競合成長させる」構成で、選択成長の幾何学と異方性の役割を理解するのが有効である。

---

### 7.4 付加製造条件での非平衡
付加製造では、局所の冷却速度・凝固速度が非常に大きく、固液界面での局所平衡（分配平衡）が破れる条件が現れる。これを材料学では溶質捕捉や非平衡分配として捉え、分配係数$k$が界面速度$V$に依存して変化する、と考えることが多い。フェーズフィールドで非平衡を表すには、(i) 界面動力学（速度に比例した過冷却）を明示する、(ii) 分配や拡散の時間スケールを界面幅と整合するようにモデル化する、という2つの方向がある。

一例として、界面に有限の運動学的抵抗があると、自由境界問題の境界条件に
$$
V=\mu_k \left(\Delta G\right)
$$
のような形（$\mu_k$は界面動力学係数、$\Delta G$は自由エネルギー差）を入れることになる。フェーズフィールドでは、Allen–Cahn型の係数や結合関数を調整することで、この界面動力学を再現する。非平衡が強いと、薄界面極限で成立した補正（反捕捉流など）の前提が崩れる場合もあり、計算格子や時間刻みの要求が厳しくなる。これは「物理として速い」だけでなく、「数値として剛い」問題になりやすいことを意味する。

また、付加製造は熱源が移動するため、温度場が強い時空間勾配を持つ。したがって、相場・組成場・温度場・場合によっては流体場を同時に解くことになり、各場の時間刻みの整合が支配的になる。学部段階では、非平衡凝固を「局所平衡を仮定できないため、界面で起きる輸送を式の中に残す必要がある」と整理するとよい。結果として、モデルの係数同定は難しくなるが、実験条件（走査速度、投入熱量、雰囲気）を直接反映できる利点がある。

---

### 7.5 連成計算の目的変数
凝固・成長問題では、出力として何を評価したいかを明確にすることで、必要な物理と数値分解能が定まりやすい。例えば、デンドライトアーム間隔$\lambda$を評価したいなら、界面の曲率と溶質境界層が解像できる格子が必要である。一方、偏析量の統計（最大濃度、分布幅）を評価したいなら、長時間の拡散緩和や対流の寄与が重要になり得る。

代表的な量として、(i) 形態のスケール（$\lambda_1,\lambda_2$など）、(ii) 偏析指標（相ごとの平均濃度、最大／最小、分布）、(iii) 粒径・粒数密度、(iv) テクスチャ（方位分布関数、柱状晶比率）、がある。これらはフェーズフィールドの場から後処理で計算できるが、後処理の定義は一意ではないため、実験での測定定義（例えばEBSDの解析条件、EDSの空間分解能）と揃える必要がある。特に付加製造では、同じ材料でも熱履歴が位置で大きく変わるため、評価量を「どの領域で、どのタイミングで」定義するかが結果を左右する。

さらに、設計問題（条件最適化）へ接続する場合、目的量は複数になりやすい。例えば、微細化（小さい$\lambda$）は強度に有利でも、偏析増大は脆性や耐食性に不利になることがある。フェーズフィールドは、これらのトレードオフを場のレベルで可視化できるが、何を第一に評価するかで必要な連成（熱のみ、熱＋溶質、熱＋溶質＋流体、さらに弾性）も変わる。したがって、出力量と必要物理を対応付ける設計が重要である。

---

## 第8章 粒成長・再結晶・結晶方位場

### 8.1 粒界移動の駆動力
粒成長は、粒界エネルギーを下げる方向に粒界が移動する現象である。曲率$\kappa$を持つ粒界では、界面エネルギー$\gamma$とモビリティ$M$により、界面の法線速度$v_n$が
$$
v_n=M\gamma\kappa
$$
に比例する、という関係が基礎として知られている（符号は曲率の定義に依存する）。フェーズフィールドでは、粒界を秩序変数の連続遷移層として表現するため、曲率駆動が方程式の中に自然に組み込まれる。例えば単一秩序変数$\phi$のAllen–Cahn型
$$
\frac{\partial \phi}{\partial t}=-L\,\frac{\delta F}{\delta\phi}
$$
において、自由エネルギーを
$$
F[\phi]=\int_{\Omega}\left(W\phi^2(1-\phi)^2+\frac{\epsilon^2}{2}|\nabla\phi|^2\right)dV
$$
と取ると、界面では$\nabla^2\phi$が曲率と結び付くため、界面が曲率で動くことになる。

学部レベルの理解としては、勾配項$\frac{\epsilon^2}{2}|\nabla\phi|^2$が「界面を作るとエネルギーがかかる」ことを表し、障壁項$W\phi^2(1-\phi)^2$が「相が混ざる中間状態を避ける」ことを表す、と捉えるとよい。界面幅はおおよそ$\delta\sim \epsilon/\sqrt{W}$で与えられ、界面エネルギー$\gamma$は$\epsilon$と$W$の組合せで決まる。したがって、粒界移動の速度や粒成長の時間スケールは、$L$だけでなく$\epsilon,W$にも依存し、物性（実材料の$\gamma,M$）に合わせるにはこれらの同定が必要となる。

---

### 8.2 マルチフェーズフィールド（MPF）
多数の粒を扱うには、粒ごとに秩序変数$\phi_i$を割り当て、各点で$\sum_i\phi_i=1$の拘束を課すMPFが基本である。MPFの利点は、粒界のネットワークが自動的に更新され、粒界三重点の運動や粒の消滅が自然に表現できる点にある。さらに、粒界エネルギーを$\gamma_{ij}$として粒対ごとに与えれば、異方的な粒界エネルギー分布を含む粒成長も表現できる。

自由エネルギーの構成は複数あるが、考え方の核は「(i) 勾配項で界面エネルギー、(ii) 障壁項で相の分離、(iii) 拘束で相の総和を保つ」を同時に満たすことである。ラグランジュ未定乗数$\lambda(\mathbf{x})$を用いれば
$$
\tilde{F}=F[\{\phi_i\}]+\int_{\Omega}\lambda(\mathbf{x})\left(\sum_i\phi_i-1\right)dV
$$
と書け、変分により拘束を満たす方程式が得られる。数値的には、拘束を厳密に満たす更新式を設計する方法と、ペナルティ項で近似的に満たす方法がある。粒数が多いほど未知数が増えるため、計算コストと安定性の両面から、拘束処理の設計が中心課題になる。

MPFで注意すべき点は、粒界が2相界面であるにもかかわらず、多相が不必要に混ざることを抑える必要があることである。三重点近傍では複数の$\phi_i$が同時に存在し得るが、それ以外の粒界では基本的に2つの相だけが混ざる状態が望ましい。自由エネルギーと運動方程式の設計により、2相界面の安定性と三重点の力学（ヤングの式に相当する力の釣合い）を再現する。これは、MPFを「粒界ネットワークの連続体模型」として信頼できる形にするための条件である。

---

### 8.3 再結晶と貯蔵エネルギー
再結晶は、塑性加工で導入された転位やサブグレインが熱処理により整理され、新しい低欠陥の結晶粒が核生成して成長する現象である。駆動力は主として貯蔵エネルギーの低下であり、転位密度$\rho$が大きい領域ほど内部エネルギーが高い。先に述べたように
$$
f_{\mathrm{store}}(\rho)=\frac{1}{2}Gb^2\rho
$$
のような形を自由エネルギーに入れると、$\rho$の空間分布がそのまま再結晶の駆動力分布になる。

フェーズフィールドで再結晶を扱う基本は、(i) 既存粒の方位場（あるいは粒ID）を保持しつつ、(ii) 新粒の核生成と成長を秩序変数で表し、(iii) 駆動力として$f_{\mathrm{store}}$を結合することである。核生成の表現には、確率的核生成（過冷却に基づく核生成率）を入れる方法と、加工組織（EBSDや結晶塑性計算）から「核になりやすい領域」を与える方法がある。学部レベルでは、再結晶は「界面移動（粒界移動）に、追加の体積駆動力（貯蔵エネルギー差）が乗る問題」と捉えると理解しやすい。

式としては、粒$i$を表す秩序変数$\phi_i$の運動に
$$
\frac{\partial \phi_i}{\partial t}=-L_i\left(\frac{\delta F}{\delta \phi_i}\right)
$$
を用意し、$F$の中に貯蔵エネルギーの項を$\phi_i$で重み付けして入れる。すると、貯蔵エネルギーの高い領域では新粒が成長してエネルギーを下げ、低い領域では成長が止まりやすくなる。さらに、転位密度$\rho$自体も回復（減少）するため、$\rho$の時間発展式を別に持たせて
$$
\frac{\partial \rho}{\partial t}=-K_{\mathrm{rec}}\rho + \text{（変形があれば生成項）}
$$
のように結合することもある。ここで$K_{\mathrm{rec}}$は回復速度を表す係数である。こうして、回復→核生成→成長という現象連鎖を同じ枠組みで記述できる。

---

### 8.4 方位場の連続表現
多数の粒を$\phi_i$で表すMPFは直感的である一方、粒数が増えるほど未知変数が増える。これに対して、方位を連続変数として表す方位場モデルは、未知変数を抑えながら多結晶を表現する道を与える。基本的な考え方は、(i) 相（固液や結晶／非晶）を表す秩序変数$\eta$と、(ii) 結晶方位を表す場$\theta$（2次元なら角度、3次元なら回転を表す変数）を導入し、粒界を「$\theta$が急変する領域」として表すことである。

2次元の基礎形として、自由エネルギーに
$$
F[\eta,\theta]
=\int_{\Omega}\left(
f(\eta)+\frac{\epsilon_{\eta}^2}{2}|\nabla \eta|^2
+g(\eta)\,\frac{\epsilon_{\theta}^2}{2}|\nabla \theta|^2
\right)dV
$$
のような項を入れる。ここで$g(\eta)$は結晶内部（$\eta\approx 1$）では$\nabla\theta$のコストを小さく、界面や粒界近傍で大きくするように設計されることが多い。直感的には、結晶内部で方位が滑らかに変わること（サブグレイン）と、粒界で方位が急に変わること（高角粒界）を同じ式で表すための重みである。運動方程式は$\eta$にAllen–Cahn型、$\theta$に拡散型（あるいは緩和型）を組み合わせることが多く、粒界移動と方位の緩和が同時に進む。

3次元では、方位は回転群（SO(3)）の元であり、単一の角度では表せない。オイラー角、回転ベクトル、クォータニオンなどの表現があり、それぞれに数値的な特性がある。例えばオイラー角は特異点（ジンバルロック）を持ち得るため、広い方位分布を扱うと不安定になりやすい。クォータニオンは特異点を避けやすいが、単位長制約（$|q|=1$）を保つ必要がある。このように、方位場モデルは「粒界を連続場で表す」代わりに「方位の数学的構造を尊重した変数選び」が重要になる。

---

### 8.5 実験との接続
EBSDなどで得られる方位マップは、フェーズフィールド計算の初期条件として非常に有用である。実験マップを格子に写像し、各セルに方位（あるいは粒ID）を割り当てれば、熱処理による粒成長・再結晶の進行を直接比較できる。比較の際に中心となる同定対象は、粒界エネルギー$\gamma$と粒界モビリティ$M$である。粒成長は速度論としては$v_n=M(\gamma\kappa+\Delta f)$（$\Delta f$は体積駆動力）に支配されるため、$\gamma$と$M$の組合せが時間スケールを決める。

粒界エネルギーは方位差（ミスオリエンテーション）に依存し、低角粒界では転位配列として解釈できるため、Read–Shockley型の関係が用いられることがある。例えば低角域で
$$
\gamma(\theta)=\gamma_0\,\theta\left(A-\ln\theta\right)
$$
のような形が採用される（$\theta$は方位差、$A$は定数）と、方位差が小さい粒界ほどエネルギーが低くなる性質を表現できる。一方で高角域では$\gamma$が飽和することが多く、全域を一つの式で表すには補間や実験同定が必要である。モビリティ$M$も温度依存が強く、Arrhenius型
$$
M(T)=M_0\exp\left(-\frac{Q}{RT}\right)
$$
で近似することが多い（$Q$は活性化エネルギー）。したがって、温度履歴が与えられる実験との比較では、$M(T)$の同定が結果に直結する。

再結晶を含む場合、加工履歴をどのように初期条件へ落とすかが鍵になる。結晶塑性計算で得た転位密度や貯蔵エネルギー分布をフェーズフィールドへ渡す方法、あるいはEBSDから推定した局所方位勾配（KAMなど）を貯蔵エネルギーに結び付ける方法がある。これらは「欠陥場を介して力学履歴を熱処理の組織進化へ接続する」考え方であり、第6章の塑性・欠陥場の導入と自然に接続する。最終的には、粒径分布、粒界長さ密度、テクスチャ、再結晶分率など、実験で定義された量と同じ定義で計算から評価することが重要である。

---

## 小まとめ
第6章では、固有ひずみに基づく弾性連成を出発点として、塑性と欠陥場を内部変数として導入することで、履歴依存の組織進化を自由エネルギーと散逸の両面から記述できることを示した。第7章では、潜熱を含む熱方程式、対流を含む輸送方程式をフェーズフィールドと結合し、凝固・成長が複数の保存則と緩和則の連立問題として定式化されることを示した。第8章では、粒界移動の速度論をフェーズフィールドで表す考え方、MPFや方位場モデルによる多結晶表現、再結晶を貯蔵エネルギーと結び付ける枠組みを整理した。

今後の発展としては、付加製造のような強非平衡条件に対して、界面動力学・分配非平衡・流体自由表面を整合的に取り込む定式化が重要になる。また、EBSDやその場観察と結び付けた同定問題（$\gamma(\theta)$や$M(T)$、貯蔵エネルギー変換則）を体系化すると、フェーズフィールドは再現計算から予測計算へと役割を広げる。さらに、弾性・塑性・欠陥・熱・流体・方位を同時に扱う計算では、モデル化と数値解法の同時設計が不可欠であり、計算科学としての体系（安定性・収束性・計算量の見積り）を教科書レベルで整理する余地が大きい。

---

## 参考ドキュメント
1. Y. U. Wang, Y. M. Jin, A. M. Cuitiño, A. G. Khachaturyan, Phase-field microelasticity theory and modeling of elastically and structurally inhomogeneous solids, Journal of Applied Physics, 92, 1351 (2002).
2. I. Steinbach, Phase-field models in materials science, Modelling and Simulation in Materials Science and Engineering, 17, 073001 (2009).
3. M. Ohno, Quantitative Phase-field Modeling and Simulations of Solidification, ISIJ International, 60, 12 (2020).（J-STAGE）
4. 村松眞由 ほか, サブグレインからの核生成と核成長に関する静的再結晶Phase-Fieldモデル, 材料, 59, 11, 853 (2010).（J-STAGE）
5. 廣内智之 ほか, 高次Multi-phase-fieldモデリングによる粒成長過程の予測, 日本機械学会論文集A編, 77, 782, 1723 (2011).（J-STAGE）
6. H. Henry, H. R. M. Rehberg, N. Goldenfeld, Phase-field model of polycrystalline solidification with a singular coupling between order and orientation, Physical Review B, 86, 054117 (2012).
7. S. Xu, Recent progress in the phase-field dislocation dynamics method, Computational Materials Science, 211, 111 (2022).









## まとめと展望
フェーズフィールド法は、自由エネルギー汎関数から支配方程式を導くという一貫した数理骨格を持ち、材料組織から破壊、電気化学、強誘電・磁性までを同じ形式で扱える点に強みがある。今後は、ベンチマークと推奨事項の整備を基盤として、(i) 多物理連成の高忠実化、(ii) パラメータ同定と不確かさの定量化、(iii) 行列フリーや適応戦略を含む高性能化、(iv) 機械学習代替による設計問題への接続が並行して進むと考えられる。


## その他参考文献
- N. Moelans, B. Blanpain, P. Wollants, An introduction to phase-field modeling of microstructure evolution, Calphad, 2008.
- PFHub, Phase Field Method Recommended Practices.
- MOOSE Framework, Phase Field Module documentation.
- S. DeWitt et al., PRISMS-PF: A general framework for phase-field modeling with a matrix-free finite element method, npj Computational Materials, 2020.
- 瀬川正仁ほか, Multi-Phase-Field Simulation of Non-Equilibrium Solidification Microstructure Formation in Additive Manufacturing, 2024.
- Y. Kamikawa et al., Chemo-electro-mechanical phase-field simulation of Li electrodeposition, Communications Materials, 2024.
- K. Alhada–Lahbabi et al., Machine learning surrogate for 3D phase-field modeling of ferroelectric tip-induced electrical switching, npj Computational Materials, 2024.
- HPCI成果報告, フェーズフィールド法と格子ボルツマン法の大規模計算によるデンドライト樹間液相流れの透過率評価, 2021.
- P. Munch et al., Efficient Finite-Element Solver for Phase-Field Simulations, 2024.
- T. Gong et al., Accelerating phase-field simulation of multi-component systems via machine learning, 2025.
---