# KKR の基本

## 参考ドキュメント
- Korringa–Kohn–Rostoker method（概要的な整理）
- H. Akai, *Korringa–Kohn–Rostoker Method* 
- P. Mavropoulos & N. Papanikolaou, *The Korringa-Kohn-Rostoker (KKR) Green Function Method*

---

## 1. KKR とは何か（位置づけ）

KKR（Korringa–Kohn–Rostoker）法は、
- **多重散乱理論**（multiple scattering theory）
- **Green 関数**（グリーン関数）

に基づいて固体の電子構造を計算する第一原理手法です。
歴史的には、
- 1947 年：Korringa による多重散乱を用いた金属のバンド計算
- 1954 年：Kohn & Rostoker による周期ポテンシャル中の Schrödinger 方程式の解法
として登場し、その後
- フルポテンシャル化
- 相対論的拡張
- Green 関数形式（KKR-GF）
- スクリーンド KKR（screened KKR）
などが発展してきました。
---

## 2. 他の電子構造手法との違い

### 2.1 代表的な手法との比較

電子構造計算には大きく以下のような系統があります：

- 平面波＋擬ポテンシャル系（VASP など）
- フルポテンシャル LAPW（WIEN2k など）
- LMTO / TB-LMTO 系  
- **KKR / KKR-Green 関数法**

KKR の特徴は：

1. **多重散乱形式**  
   - 原子位置を「散乱中心」とみなし、  
     単一サイト散乱とサイト間の伝播を組み合わせて全体系を記述する。

2. **Green 関数が直接得られる**  
   - 波動関数ではなく Green 関数を中心に扱うため、  
     - 局所状態密度（LDOS）  
     - 伝導特性  
     - XAS / XMCD などのスペクトル  
     を自然に扱える。

3. **乱雑系・合金に強い（CPA）**  
   - Coherent Potential Approximation（CPA）と組み合わせることで、  
     置換型合金やスピン乱れ（DLM モデル）を効率的に扱える。

---

## 3. 基本アイデア（多重散乱と KKR 方程式）

### 3.1 空間の分割と単一サイト散乱

KKR では、結晶を

- 各原子の周りの「原子セル」（球＋非球形拡張も可）
- それ以外の「間隙領域（interstitial）」

に分けて考えます。
発想としては：

1. あるサイト j の周りでは、「単一サイト散乱問題」として  
   局所ポテンシャルによる散乱行列（t 行列）を求める。
2. サイト間の「伝播」（空格子の Green 関数）を、構造定数（structure constants）として記述する。
3. 全体系は、  
   「単一サイト散乱」＋「サイト間伝播」の多重散乱の和として表現される。

### 3.2 KKR 行列と固有値条件

Bloch の定理を用いると、結晶運動量 **k** ごとに  
係数ベクトル $c_{\ell m}(E, \mathbf{k})$ が

$$
\sum_{\ell' m'} M_{\ell m, \ell' m'}(E, \mathbf{k}) \, c_{\ell' m'}(E, \mathbf{k}) = 0
$$

という同次連立方程式を満たすような形になります。

- $M(E, \mathbf{k})$ は
  - 単一サイト t 行列の逆行列（散乱成分）
  - 構造定数（空格子の伝播成分）
  の組み合わせで構成される行列。
- 固有値条件は

$$
\det M(E, \mathbf{k}) = 0
$$

となり、これを満たすエネルギー $E_b(\mathbf{k})$ がバンドエネルギーに対応する、というのが KKR バンド理論の基本です。

> 重要なポイント：  
> 行列のサイズは、採用する角運動量の最大値 $ \ell_{\max} $ によって決まり、  
> $(\ell_{\max} + 1)^2$ となるため、比較的小さな行列で記述できる、という利点があります。

---

## 4. Green 関数形式としての KKR（KKR-GF）

### 4.1 Green 関数で見る電子構造

Green 関数 $G(E)$ は、形式的には

$$
G(E) = (E - H + i\eta)^{-1}
$$

で定義され、  

- 局所状態密度（LDOS）
- 伝導度
- スペクトル関数

など、多くの物理量に直接関わります。  

KKR では、この Green 関数を

- 単一サイトの散乱解
- サイト間の伝播関数

で展開した形（KKR 表現）を用いることで、多重散乱の視点から電子構造を記述します。 

### 4.2 スクリーンド KKR

従来の KKR では、構造定数の収束や数値的安定性の観点から、  
計算コストが重くなりがちでした。

これを改善するために導入されたのが screened KKR で、

- 散乱経路を“スクリーニング”して
- 有効的に「局所化」された Green 関数を用いることで、

計算の収束性・効率が大きく改善されます。

---

## 5. 乱雑系と CPA（Coherent Potential Approximation）

### 5.1 合金・スピン乱れへの応用

KKR-GF の大きな利点は、乱雑系（disordered systems）への自然な拡張です。

- 置換型合金：A–B 合金のようにサイトごとに異なる原子がランダムに入る系
- 高温の磁性体：スピンの向きが熱的に乱れた DLM（Disordered Local Moment）状態

これらを扱うために、KKR は CPA（Coherent Potential Approximation）と組み合わせられます。  

CPA のアイデアは：

- 無数の配置を平均化した「有効媒質」を導入し、
- そこに代表的な散乱中心を埋め込んだときの散乱が、
- 再びその有効媒質と整合するように条件を課す

という、自己無撞着な平均ポテンシャルを求める考え方に基づいています。

### 5.2 実装例

代表的な KKR 実装としては：

- AkaiKKR（大阪大学・赤井研究室起源）
- SPRKKR（Ebert らによるスピン・相対論対応の KKR パッケージ）

などがあり、いずれも CPA による合金・磁性乱雑系計算が可能です。

---

## 6. 典型的な KKR 計算フロー

具体的なコードに依存しない「流れ」だけを整理すると、以下のようになります：

1. **構造の定義**
   - 結晶構造（格子定数、原子位置）
   - 元素種ごとの原子球の設定（MT 半径など）

2. **計算条件の設定**
   - スピン（非磁性・強磁性・反強磁性・非共線磁性など）
   - 相対論の扱い（非相対論・スカラー相対論・フル相対論）
   - 角運動量カットオフ $ \ell_{\max} $
   - エネルギー積分（輪郭積分）・k 点メッシュ

3. **自己無撞着計算（SCF）**
   - 初期電荷密度からスタート
   - 散乱行列・Green 関数 → 電荷密度更新
   - 収束するまでループ

4. **物性評価**
   - DOS / LDOS
   - バンド構造（必要に応じて）
   - 磁気モーメント・磁気異方性
   - スペクトル（XAS, XMCD など）
   - 合金の場合は濃度依存や DLM 状態 など

### KKR 特有のポイント：

- Green 関数を通じて、局所的な量やスペクトル量が取り出しやすい。
- CPA により、置換型合金の平均的な性質を直接計算できる。

---

## 7. どんなときに KKR を選ぶか

平面波 DFT や LAPW と比べたとき、KKR が特に有効なシチュエーションは：

- **置換型合金・高濃度固溶体の電子構造・磁性**  
  → CPA による乱雑平均が効く
- **表面・界面・クラスタ＋バルクの埋め込み問題**  
  → Green 関数形式による“埋め込み”が自然に扱える
- **XAS / XMCD / RIXS などの分光量**  
  → 局所 DOS・遷移確率を Green 関数から直接評価
- **強いスピン軌道相互作用や異方性の扱い**  
  → フル相対論的 KKR が有効 

---

## 8. まとめ

このページでは、KKR の基本を wiki 用に整理しました：

- KKR は多重散乱理論・Green 関数に基づく電子構造法である
- KKR 行列 $\det M(E,\mathbf{k}) = 0$ の固有値問題としてバンド構造が定まる
- Green 関数表示により、局所量・スペクトル・輸送特性を扱いやすい
- CPA と組み合わせることで、乱雑合金や DLM 状態に強い
- AkaiKKR や SPRKKR などの実装が広く使われている