# 第一原理計算の基本原理

第一原理計算は、電子と原子核の量子力学に基づき、経験的パラメータに依存しない形でエネルギーと物性を評価する枠組みである。密度汎関数理論（DFT）を中核として、構造安定性・電子状態・磁性・格子振動・反応や拡散の議論までを同一の理論的土台で接続することができる。

## 参考ドキュメント
- W. Kohn and L. J. Sham, Self-Consistent Equations Including Exchange and Correlation Effects, Phys. Rev. 140, A1133 (1965)  
  https://link.aps.org/doi/10.1103/PhysRev.140.A1133
- The Nobel Prize in Chemistry 1998 Press release（密度汎関数理論に関する公式説明）  
  https://www.nobelprize.org/prizes/chemistry/1998/press-release/
- 佐藤和則, 第一原理計算法 II（応用物理, J-STAGE, 日本語）  
  https://www.jstage.jst.go.jp/article/oubutsu/75/11/75_1371/_pdf


## 1. 多体シュレーディンガー方程式
非相対論的な多電子・多原子核系は、全ハミルトニアン $\hat{H}$ に対する固有値問題
$$
\hat{H}\,\Psi(\{ \mathbf{r}_{i}\},\{\mathbf{R}_{I}\}) = E\,\Psi(\{\mathbf{r}_{i}\},\{\mathbf{R}_{I}\})
$$
で与えられる。ここで $\mathbf{r}_{i}$ は電子 $i$ の座標、$\mathbf{R}_{I}$ は原子核 $I$ の座標である。全ハミルトニアンは（電磁場や相対論補正を無視する範囲で）
$$
\hat{H}
=
\underbrace{-\sum_{i=1}^{N_{e}}\frac{\hbar^{2}}{2m_{e}}\nabla_{i}^{2}}_{\hat{T}_{e}}
+
\underbrace{-\sum_{I=1}^{N_{n}}\frac{\hbar^{2}}{2M_{I}}\nabla_{I}^{2}}_{\hat{T}_{n}}
+
\underbrace{\sum_{i<j}\frac{e^{2}}{4\pi\varepsilon_{0}}\frac{1}{|\mathbf{r}_{i}-\mathbf{r}_{j}|}}_{\hat{V}_{ee}}
+
\underbrace{\sum_{I<J}\frac{Z_{I}Z_{J}e^{2}}{4\pi\varepsilon_{0}}\frac{1}{|\mathbf{R}_{I}-\mathbf{R}_{J}|}}_{\hat{V}_{nn}}
+
\underbrace{\sum_{i,I}\left(-\frac{Z_{I}e^{2}}{4\pi\varepsilon_{0}}\frac{1}{|\mathbf{r}_{i}-\mathbf{R}_{I}|}\right)}_{\hat{V}_{en}}
$$
と表せる。

記号の意味：
- $N_{e}$：電子数、$N_{n}$：原子核数
- $m_{e}$：電子質量、$M_{I}$：核 $I$ の質量、$Z_{I}$：核電荷数
- $\nabla_{i}^{2}$：電子座標 $\mathbf{r}_{i}$ に関するラプラシアン、$\nabla_{I}^{2}$：核座標 $\mathbf{R}_{I}$ に関するラプラシアン
- $\hat{V}_{ee}$：電子—電子反発、$\hat{V}_{nn}$：核—核反発、$\hat{V}_{en}$：電子—核相互作用

課題は、電子数 $N_{e}$ が増えると波動関数 $\Psi$ の自由度が指数的に増大し、厳密解が現実的でなくなる点にある。第一原理計算は、この困難を物理的に妥当な近似と数値解法へ分解し、材料のエネルギーや応答を計算可能な形に変換する枠組みである。

## 2. Born–Oppenheimer 近似
固体や分子では、核は電子より十分重く運動が遅いことが多い。この時間スケール分離に基づき、核座標 $\{\mathbf{R}_{I}\}$ を固定パラメータとして先に電子問題を解き、その電子エネルギーを核の運動に対するポテンシャルとして扱う近似が Born–Oppenheimer（断熱）近似である。

全波動関数を
$$
\Psi(\{\mathbf{r}_{i}\},\{\mathbf{R}_{I}\})
\approx
\psi_{e}(\{\mathbf{r}_{i}\};\{\mathbf{R}_{I}\})\,\chi(\{\mathbf{R}_{I}\})
$$
と分離し、電子方程式
$$
\hat{H}_{e}(\{\mathbf{R}_{I}\})\,\psi_{e} = E_{e}(\{\mathbf{R}_{I}\})\,\psi_{e}
$$
を解く。ここで $\hat{H}_{e}$ は核固定のもとでの電子ハミルトニアンであり、核の運動エネルギー $\hat{T}_{n}$ を含まない。得られる $E_{e}(\{\mathbf{R}_{I}\})$ はポテンシャルエネルギー面として核運動に反映され、構造最適化では特に
$$
\mathbf{F}_{I} = -\frac{\partial E_{e}}{\partial \mathbf{R}_{I}}
$$
（力）を用いて原子位置を更新する。

この近似により、構造安定性、欠陥形成、界面、弾性など多くの議論が「基底状態電子エネルギーの核座標依存」として定式化される。一方で、非断熱効果（電子励起や強い電子—格子相互作用）が重要な系では、この分離が破綻し得る点も理論的限界として意識すべきである。

## 3. 密度汎関数理論（DFT）の基本
DFT は、多体波動関数 $\Psi$ を直接求める代わりに、電子密度 $n(\mathbf{r})$ を基本変数として基底状態を記述する理論である。電子密度は
$$
n(\mathbf{r}) = N_{e}\int |\Psi(\mathbf{r},\mathbf{r}_{2},\ldots,\mathbf{r}_{N_{e}})|^{2}\,d\mathbf{r}_{2}\cdots d\mathbf{r}_{N_{e}}
$$
で定義され、全空間積分で電子数を与える：
$$
\int n(\mathbf{r})\,d\mathbf{r} = N_{e}.
$$

### 3.1 Hohenberg–Kohn（HK）定理
HK 定理の核心は、外部ポテンシャル $v_{\mathrm{ext}}(\mathbf{r})$（固体では主に核が作るポテンシャル）が基底状態密度 $n(\mathbf{r})$ によって（定数を除き）一意に決まることである。したがって、基底状態エネルギーは電子密度の汎関数として
$$
E[n] = F[n] + \int v_{\mathrm{ext}}(\mathbf{r})\,n(\mathbf{r})\,d\mathbf{r}
$$
と書ける。ここで $F[n]$ は普遍汎関数であり、
$$
F[n] = T[n] + V_{ee}[n]
$$
（相互作用系の運動エネルギー $T[n]$ と電子—電子相互作用 $V_{ee}[n]$ を含む）であるが、厳密形は未知である。

変分原理として、許される密度の集合の中で
$$
E_{0} = \min_{n}\,E[n]
$$
が成り立ち、最小化する密度が真の基底状態密度である。

記号の意味：
- $v_{\mathrm{ext}}(\mathbf{r})$：外部ポテンシャル（核・外場など）
- $T[n]$：相互作用電子系の運動エネルギー汎関数
- $V_{ee}[n]$：電子—電子反発の寄与（密度で表現される形に集約される）

### 3.2 Kohn–Sham（KS）方程式
KS 理論は、相互作用する電子系を「同じ密度を与える非相互作用電子系」へ写像し、計算可能な一電子方程式に落とす構成である。非相互作用系の一電子軌道（KS 軌道）$\{\phi_{i}(\mathbf{r})\}$ を導入し、
$$
n(\mathbf{r}) = \sum_{i}^{\mathrm{occ}} f_{i}\,|\phi_{i}(\mathbf{r})|^{2}
$$
と表す（$f_{i}$ は占有数であり、スピンを含める場合は $\uparrow,\downarrow$ に分けて扱う）。

KS 方程式は
$$
\left[-\frac{\hbar^{2}}{2m_{e}}\nabla^{2} + v_{\mathrm{eff}}(\mathbf{r})\right]\phi_{i}(\mathbf{r})
=
\varepsilon_{i}\phi_{i}(\mathbf{r})
$$
である。実効ポテンシャルは
$$
v_{\mathrm{eff}}(\mathbf{r})
=
v_{\mathrm{ext}}(\mathbf{r})
+
v_{H}(\mathbf{r})
+
v_{xc}(\mathbf{r})
$$
と分解される。ここで Hartree ポテンシャル（古典的なクーロン反発）は
$$
v_{H}(\mathbf{r}) = \int \frac{n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}\,d\mathbf{r}'
$$
であり、交換相関ポテンシャルは
$$
v_{xc}(\mathbf{r}) = \frac{\delta E_{xc}[n]}{\delta n(\mathbf{r})}
$$
で定義される。$E_{xc}[n]$ が未知であるため、ここに近似を導入する。

全エネルギーは（核—核反発 $E_{II}$ を含め）
$$
E[n] = T_{s}[n] + \int v_{\mathrm{ext}}(\mathbf{r})n(\mathbf{r})\,d\mathbf{r}
+ E_{H}[n] + E_{xc}[n] + E_{II}
$$
と表される。$T_{s}[n]$ は非相互作用系の運動エネルギーであり KS 軌道から計算できる。$E_{H}[n]$ は
$$
E_{H}[n] = \frac{1}{2}\int\int \frac{n(\mathbf{r})n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}\,d\mathbf{r}\,d\mathbf{r}'
$$
である。

自己無撞着反復では、(i) 初期密度 $n(\mathbf{r})$ を仮定し、(ii) KS 方程式から $\phi_{i}$ を求め、(iii) 新密度を構成し、(iv) エネルギー差・密度差・力などが所定値以下になるまで更新を繰り返す。

## 4. 交換相関汎関数
$E_{xc}[n]$ は、交換相関効果（量子統計に由来する交換と、電子相関）をまとめて担う項であり、DFT の精度を支配する中心である。主な階層は次の通りである。

- LDA（局所密度近似）：一様電子気体の結果を局所的に適用する。凝集の強い系では体積が小さめに出る傾向が知られる。
- GGA（一般化勾配近似）：$n(\mathbf{r})$ に加え $\nabla n(\mathbf{r})$ を用いる。PBE は材料計算で広く用いられる。
- meta-GGA：さらに運動エネルギー密度など高次情報を使う（例：SCAN）。構造・エネルギーの改善が期待される一方、系によって挙動が異なる。
- DFT+U：局在 $d$ や $f$ 電子の相関を補正する。ハバード $U$ と交換 $J$（あるいは $U_{\mathrm{eff}}=U-J$）が導入され、バンドギャップや磁性が改善される場合がある。
- ハイブリッド（HSE など）：交換の一部を Hartree–Fock 交換で置換する。絶縁体ギャップや局在化の改善が得られやすいが、計算負荷が増える。
- GW：準粒子エネルギーを自己エネルギー $\Sigma=iGW$ により評価し、より物理的なバンド構造へ近づける。基底状態の構造予測というより、分光量の整合に用いられることが多い。
- TDDFT：時間依存 DFT により励起・光応答を扱う。ただし交換相関カーネルの近似により適用範囲が制約される。

交換相関の選択は、単に「好み」ではなく、どの自由度を平均場に吸収し、どの自由度を追加理論（+U, ハイブリッド, GW, あるいは別の多体手法）で補うかというモデリングの選択である。例えば遷移金属酸化物では +U やハイブリッドが必要になりやすい一方、金属の凝集エネルギーや弾性では GGA が良い整合を示す場合が多い、など目的量依存の側面がある。

## 5. 周期境界条件と k 点
結晶では周期境界条件（PBC）を課し、Bloch の定理により固有状態は
$$
\psi_{n\mathbf{k}}(\mathbf{r}) = e^{i\mathbf{k}\cdot\mathbf{r}}\,u_{n\mathbf{k}}(\mathbf{r})
$$
と表される。$u_{n\mathbf{k}}(\mathbf{r})$ は格子周期をもつ関数であり、$n$ はバンド指数、$\mathbf{k}$ はブリルアンゾーン内の波数である。

熱力学極限では、ブリルアンゾーン積分として現れる量（例：全エネルギー、電子密度、応力）は
$$
\langle A\rangle = \frac{1}{\Omega_{\mathrm{BZ}}}\int_{\mathrm{BZ}} A(\mathbf{k})\,d\mathbf{k}
\approx \sum_{\mathbf{k}} w_{\mathbf{k}}\,A(\mathbf{k})
$$
と数値積分で近似される（$w_{\mathbf{k}}$ は重み）。Monkhorst–Pack メッシュは、対称性と収束性のバランスがよい $\mathbf{k}$ 点生成法として広く用いられる。

金属ではフェルミ面近傍の占有が急峻であり、$\mathbf{k}$ 点積分が収束しにくい。そこで占有数を滑らかにするスメアリング（Fermi–Dirac、Methfessel–Paxton など）を用いることが多い。絶縁体・半導体系では、テトラヘドロン法（改良型を含む）により積分精度が向上する。

記号の意味：
- $\Omega_{\mathrm{BZ}}$：ブリルアンゾーン体積
- $w_{\mathbf{k}}$：既約 $\mathbf{k}$ 点への積分重み
- $\mathbf{k}$ 点メッシュ：全エネルギーや力の収束（数値積分誤差）を支配する離散化

## 6. 基底と擬ポテンシャル
### 6.1 平面波基底とカットオフ
周期系では、平面波基底は扱いやすく、基底サイズを増やせば系統的に収束できる点が利点である。KS 軌道は
$$
\psi_{n\mathbf{k}}(\mathbf{r}) = \sum_{\mathbf{G}} c_{n\mathbf{k}}(\mathbf{G})\,e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}
$$
と展開される（$\mathbf{G}$ は逆格子ベクトル）。ただし無限個の平面波を使うことはできないため、運動エネルギーで打ち切る：
$$
\frac{\hbar^{2}}{2m_{e}}|\mathbf{k}+\mathbf{G}|^{2} \le E_{\mathrm{cut}}.
$$
$E_{\mathrm{cut}}$ がカットオフエネルギーであり、これを増やすと基底数が増えて精度が上がる一方、計算コストが増える。

### 6.2 擬ポテンシャルと PAW
全電子（コア電子まで）を厳密に扱うと、原子核近傍で波動関数が急峻に振動し、平面波では非常に大きな $E_{\mathrm{cut}}$ が必要になる。そこで、コア効果を有効ポテンシャルに集約し、主に価電子を対象とする考え方が擬ポテンシャルである。

代表的な分類：
- ノーム保存擬ポテンシャル（NCPP）：散乱特性を保ちつつ規格化（ノーム）条件を課す。比較的硬く、高い $E_{\mathrm{cut}}$ が必要な場合がある。
- 超ソフト擬ポテンシャル（USPP）：ノーム保存条件を緩め、基底数を減らして効率化する。
- PAW（Projector Augmented-Wave）法：擬波動関数から全電子波動関数の情報を補完し、精度と効率を両立する。

PAW では、原子近傍の情報を射影子（projector）と部分波で保持し、平面波の「滑らかな表現」と「全電子的な性質」を接続する。磁性（スピン分極や SOC を含む）や化学反応、応答関数など、幅広い用途で標準的に採用されることが多い。

## 7. 何が計算できるか
第一原理計算の多くは、基底状態全エネルギー $E$ と、その微分量（力・応力・応答）を中心に構成される。得られる量は「直接の出力」と「熱力学・輸送などへ写像して得る量」に分けて整理すると理解しやすい。

| 計算対象 | 中心量 | 基本的に得られるもの（例） |
|---|---|---|
| 構造安定性・相安定 | 全エネルギー差、化学ポテンシャル | 相対安定性、形成エネルギー、反応エネルギー |
| 構造最適化 | 力 $\mathbf{F}_{I}$ | 安定構造、欠陥緩和、界面構造、吸着構造 |
| 弾性 | 応力 $\sigma_{\alpha\beta}$、歪み $\varepsilon_{\alpha\beta}$ | 弾性定数、機械的安定性、格子応答 |
| 電子状態 | 固有値 $\varepsilon_{n\mathbf{k}}$、DOS | 金属/半導体判定、状態密度、フェルミ面の特徴 |
| 磁性 | スピン密度 $m(\mathbf{r})$、スピン分裂 | 磁気モーメント、磁気秩序の相対安定、磁気異方性（SOC を含む） |
| 格子振動 | 力定数、線形応答 | フォノン分散、自由エネルギー、比熱の傾向 |
| 反応・拡散 | エネルギー障壁 $E_{a}$ | 遷移状態、拡散バリア、反応経路の比較 |
| 有限温度 | DFT-MD | 熱揺らぎ下の構造、溶融や相転移の兆候、短時間ダイナミクス |

有限温度での原子運動を扱う場合、Car–Parrinello 型の ab initio MD のように、電子状態と原子運動を結合して記述する枠組みも重要である。

## 8. 誤差と検証
第一原理計算は、理論の近似（交換相関）と数値近似（離散化・有限サイズ）を含む。したがって、得られた値を解釈するには、誤差の種類と支配要因を整理しておく必要がある。

主な誤差要因：
- 交換相関汎関数の系統誤差（体積、凝集エネルギー、バンドギャップ、磁性の過大/過小など）
- 有限サイズ誤差（スーパーセル、欠陥—欠陥の人工相互作用、真空層の不足）
- $\mathbf{k}$ 点・$E_{\mathrm{cut}}$ の未収束（離散化誤差が残る）
- スピン状態の取り違え（初期磁化の設定、反強磁性配置の探索不足）
- SOC、非共線磁性、強相関補正（+U など）の不足、または不適切なパラメータ選択
- 0 K 近似と有限温度（振動自由エネルギー、磁気エントロピーなど）との差

これらは「どの量を比較したいか」によって致命度が変わる。例えば相安定性は相対エネルギー差が重要である一方、分光量（ギャップや準粒子）には beyond-DFT が必要な場合が多い。検証は、実験値や高精度理論（ハイブリッド、GW、量子化学法など）との比較を通じて、目的量に対して妥当な近似階層を選ぶ形で行うのが自然である。

## 9. 計算結果の解釈
第一原理計算は数値を返すが、材料研究では数値を「機構の言語」へ翻訳する作業が重要である。解釈では、次の観点が基礎になる。

- 競合相・欠陥・界面を含めた相対エネルギーの比較により、現実の形成条件を考える
- 電子状態（DOS、バンド、局在性）から結合性・磁性・反応性の変化を説明する
- 応力・弾性・フォノンの情報を用いて、構造安定性と相転移の駆動力を議論する
- 観測量への写像（例：フォノン自由エネルギー→比熱の温度依存、障壁→拡散の温度依存の傾向）を明確にする
- 実験条件との差分（温度、非平衡、組織不均一、乱れ、有限サイズ）を明示し、理論が見ている理想化の範囲を言語化する

解釈が成功すると、単なる数値再現ではなく、「どの自由度が支配的で、どの操作が物性を動かすか」を定量的に示す形に到達できる。

## まとめと展望
第一原理計算は、多体量子問題を Born–Oppenheimer 近似で分離し、DFT（HK 定理と KS 方程式）により密度を基本変数として扱うことで、現実の材料系へ適用可能な計算へ落とし込む枠組みである。交換相関汎関数、周期系の $\mathbf{k}$ 点積分、平面波基底とカットオフ、擬ポテンシャルや PAW といった要素は、すべて「同じ理論を有限の計算資源で実装する」ための具体化である。

今後の展望としては、(i) 強相関・励起・分光量に対しては +U、ハイブリッド、GW、TDDFT などの階層を適切に使い分けること、(ii) 有限温度・乱れ・欠陥・界面といった現実要因を含めたモデル化を進めること、(iii) 第一原理データを基盤として機械学習ポテンシャルやデータ駆動解析と接続し、より大きな時空間スケールへ拡張することが重要になる。これらにより、DFT を基礎とした定量議論が、材料探索だけでなく機構の確定と設計指針の抽出へ一層深く寄与していくと期待される。

## 関連研究
- J. M. D. Coey, Amorphous magnetic order, Journal of Applied Physics 49, 1646 (1978).  
  https://pubs.aip.org/aip/jap/article/49/3/1646/505321/Amorphous-magnetic-order
- R. Alben, J. J. Becker, M. C. Chi, Random anisotropy in amorphous ferromagnets, Journal of Applied Physics 49, 1653 (1978).  
  https://pubs.aip.org/aip/jap/article/49/3/1653/505311/Random-anisotropy-in-amorphous-ferromagnets

- P. Hohenberg and W. Kohn, Inhomogeneous Electron Gas, Phys. Rev. 136, B864 (1964)  
  https://link.aps.org/doi/10.1103/PhysRev.136.B864
- J. P. Perdew, K. Burke, and M. Ernzerhof, Generalized Gradient Approximation Made Simple, Phys. Rev. Lett. 77, 3865 (1996)  
  https://link.aps.org/doi/10.1103/PhysRevLett.77.3865
- P. E. Blöchl, Projector augmented-wave method, Phys. Rev. B 50, 17953 (1994)  
  https://link.aps.org/doi/10.1103/PhysRevB.50.17953
- HAXPES・量子物質計算などを含む講義資料（日本語）例：尾崎泰助, 第一原理電子状態計算の基礎と応用  
  https://t-ozaki.issp.u-tokyo.ac.jp/mpcoms2021_lectures/Ozaki-Lec1.pdf
- VASP Wiki（平面波カットオフや収束に関する説明）  
  https://www.vasp.at/wiki/ENCUT