# 熱力学計算

熱力学計算とは、温度 $T$、圧力 $P$、組成などの条件のもとで、自由エネルギーや化学ポテンシャルを数式として扱い、平衡状態や相の安定性を定量的に求める計算である。中心になる原理は、外部条件に対応した熱力学ポテンシャルが最小となる状態が平衡である、という要請である。



## 1. 熱力学で扱う量

熱力学では、系の状態を少数の状態量で表す。状態量には、内部エネルギー $U$、エンタルピー $H$、エントロピー $S$、ヘルムホルツ自由エネルギー $F$、ギブズ自由エネルギー $G$ などがある。これらは状態関数であり、同じ状態に戻れば変化はゼロになるという性質を持つ。

一方で、熱や仕事は経路に依存する量である。したがって、計算では「経路依存の量を直接追う」よりも、状態関数を用いて終状態を決め、そこから駆動力を議論する形を取ることが多い。



## 2. 第一法則と第二法則の結合

第一法則はエネルギー保存であり、閉じた系では
$$
dU=\delta Q-\delta W
$$
である。ここで $\delta Q$ は熱、$\delta W$ は仕事であり、いずれも状態関数ではない。体積仕事が支配的で準静的であるなら $\delta W = P\,dV$ と書ける。

第二法則は不可逆性をエントロピーで表す。可逆過程では
$$
dS=\frac{\delta Q_{\mathrm{rev}}}{T}
$$
であり、一般には $dS\ge \delta Q/T$ が成り立つ。第一法則と第二法則を合わせることで、状態関数である $U$ の微分形に温度 $T$ と圧力 $P$ を入れた表式を得られる。



## 3. 基本微分式

単純圧縮系（磁場や表面張力などを含めない）の可逆変化を考えると、基本微分式は
$$
dU = T\,dS - P\,dV + \sum_i \mu_i\,dN_i
$$
となる。ここで $\mu_i$ は成分 $i$ の化学ポテンシャル、$N_i$ は物質量である。右辺は熱（$T\,dS$）、体積仕事（$-P\,dV$）、物質出入りに伴う仕事（$\sum \mu_i dN_i$）に対応している。

この式は、熱力学計算の出発点である。以後の自由エネルギーや平衡条件は、この式をルジャンドル変換して自然変数を取り替えることで得られる。



## 4. ルジャンドル変換と熱力学ポテンシャル

外部条件が何で固定されるかに応じて、扱いやすいポテンシャルが変わる。定温条件を取り込むには $F=U-TS$、定圧条件を取り込むには $H=U+PV$ を用いる。両方を取り込むと
$$
G = U + PV - TS
$$
となる。

ルジャンドル変換の意味は「制御しやすい変数を自然変数として持つポテンシャルへ写す」ことである。例えば実験や材料プロセスでは $T$ と $P$ が与えられることが多く、その場合は $G(T,P,\{N_i\})$ を使うと平衡判定が直接的になる。



## 5. $F$ と $G$ の微分形

$F=U-TS$ を微分して、基本微分式を代入すると
$$
dF = -S\,dT - P\,dV + \sum_i \mu_i\,dN_i
$$
を得る。したがって自然変数は $(T,V,\{N_i\})$ である。定温・定容・閉鎖系では $dF\le 0$ に向かうため、平衡では $F$ が最小である。

同様に $G=F+PV$ より
$$
dG = -S\,dT + V\,dP + \sum_i \mu_i\,dN_i
$$
を得る。自然変数は $(T,P,\{N_i\})$ であり、定温・定圧・閉鎖系では $G$ が最小になる状態が平衡である。この「何が最小化されるか」を最初に確定することが、熱力学計算の誤解を減らす。



## 6. マクスウェル関係と導関数の読み替え

微分形が分かると、交差微分の対称性からマクスウェル関係が得られる。例えば $F(T,V)$ の場合
$$
\left(\frac{\partial S}{\partial V}\right)_T
=
\left(\frac{\partial P}{\partial T}\right)_V
$$
である。これは測りやすい $P(T)$ の傾きから $S$ の体積依存を推定できることを意味する。

同様に $G(T,P)$ から
$$
\left(\frac{\partial S}{\partial P}\right)_T
=
-\left(\frac{\partial V}{\partial T}\right)_P
$$
が得られる。熱力学計算では、データベースや状態方程式から得た $V(T,P)$ を使って、エントロピーの圧力依存などを間接的に計算できる点が重要である。



## 7. 化学ポテンシャルの意味

化学ポテンシャルは
$$
\mu_i = \left(\frac{\partial G}{\partial N_i}\right)_{T,P,N_{j\ne i}}
$$
で定義される。これは「定温・定圧のもとで成分 $i$ を微小量だけ足したときに $G$ が増える割合」である。多相平衡・反応平衡・拡散駆動力は、最終的に $\mu_i$ の差として表せる。

重要な点は、$\mu_i$ は単なる成分のエネルギーではなく、混合や相互作用、秩序化などの効果を含んだ量であることである。したがって、濃度が変わるだけで $\mu_i$ が変化し、これが相分離や偏析の駆動力になる。



## 8. 活量と理想からのずれ

理想溶液では、混合エントロピーが主要因になり
$$
\mu_i = \mu_i^\circ(T,P) + RT\ln x_i
$$
となる。ここで $x_i$ はモル分率である。しかし固溶体や溶融塩など、相互作用が強い系では理想式からずれる。

ずれを表現するため、活量 $a_i$ と活量係数 $\gamma_i$ を導入し
$$
a_i=\gamma_i x_i,\qquad
\mu_i = \mu_i^\circ + RT\ln a_i
$$
と書く。$\gamma_i$ の具体形はモデルに依存し、正則溶体、Redlich–Kister、Wilson、NRTL などが用いられる。熱力学計算は、この $\gamma_i$ を含む $G(T,P,\{x\})$ を整合的に作る作業でもある。



## 9. 混合自由エネルギーと安定性

二元系 $A$–$B$ の一相に対して、モルギブズ自由エネルギー $g(x)$ を考えると、相安定性は曲率で判定できる。温度と圧力一定で
$$
\frac{d^2 g}{dx^2} > 0
$$
なら局所的に安定であり、逆に負になる領域があると自発的な組成ゆらぎが成長しやすい。

二相共存は「共通接線条件」で表される。$g(x)$ 曲線の2点に引いた同一接線が、2相の平衡組成を与える。図を描けない場合でも、これは「2相に分けた方が全体の $G$ が下がる」という最小化原理の具体形である。



## 10. 反応ギブズエネルギーと平衡

反応 $\sum_i \nu_i A_i = 0$ に対し
$$
\Delta_r G = \sum_i \nu_i \mu_i
$$
である。平衡では $\Delta_r G = 0$ が成立し、反応がどちらに進むかは $\Delta_r G$ の符号で決まる。これは「エネルギーが下がる方向に進む」という直感を、混合や相互作用を含む形で一般化したものである。

標準状態を用いると
$$
\Delta_r G = \Delta_r G^\circ + RT\ln Q
$$
となり、$Q$ は反応商である。平衡では $Q=K$ なので
$$
K=\exp\left(-\frac{\Delta_r G^\circ}{RT}\right)
$$
を得る。したがって $\Delta_r G^\circ(T)$ を作れれば、温度ごとの平衡組成計算へ進める。



## 11. $C_p(T)$ から $G(T)$ を作る計算

多くの物質では、熱容量 $C_p(T)$ を温度の関数として与え、そこから $H(T)$ と $S(T)$ を積分で得る。基準温度 $T_0$ を用いると
$$
H(T)=H(T_0)+\int_{T_0}^{T} C_p(T')\,dT',
\qquad
S(T)=S(T_0)+\int_{T_0}^{T} \frac{C_p(T')}{T'}\,dT'
$$
である。次に $G(T)=H(T)-TS(T)$ である。

ここで重要なのは、相転移がある温度域では追加項が必要なことである。融解や秩序化などの転移温度 $T_{\mathrm{tr}}$ で潜熱 $\Delta H_{\mathrm{tr}}$ があれば、$H$ は跳び、$S$ は $\Delta S_{\mathrm{tr}}=\Delta H_{\mathrm{tr}}/T_{\mathrm{tr}}$ だけ増える。熱力学表はこのような不連続を含めた推奨値を提供する。



## 12. Shomate 式による具体的な積分例

気相の $C_p^\circ(T)$ を表す代表的な近似として Shomate 式がある。NIST の WebBook では、例えば
$$
C_p^\circ = A + Bt + Ct^2 + Dt^3 + \frac{E}{t^2},
\qquad t=\frac{T}{1000}
$$
の形で係数を与えることがある。

この形を用いると、$H^\circ(T)-H^\circ(298.15)$ や $S^\circ(T)$ が解析的に書ける。実際の計算では、係数を表から取り、所望の温度へ代入して $H^\circ(T)$ と $S^\circ(T)$ を作り、最後に $G^\circ(T)=H^\circ(T)-TS^\circ(T)$ を得る。係数の単位系（J/mol/K か kJ/mol/K か）を式の前提と合わせる必要がある。



## 13. 反応平衡の数値例の作り方

数値例として、反応 $A \rightleftharpoons B$ を考える。標準反応ギブズエネルギーが $\Delta_r G^\circ = 5\,\mathrm{kJ/mol}$、温度が $T=1000\,\mathrm{K}$ とする。このとき
$$
K=\exp\left(-\frac{5000}{R\cdot 1000}\right)
$$
であり、$R=8.314\,\mathrm{J/mol/K}$ を代入すると $K<1$ となるため、平衡は $A$ 側に偏る。

次に、理想混合を仮定して $Q=(a_B/a_A)$ を組成で書けば、$K$ と等置して平衡組成を求められる。ここで活量係数が1からずれる場合は $a_i=\gamma_i x_i$ を使って同様に解く。反応平衡の計算は、結局は $\mu_i$ の形をどこまで現実に合わせるかという問題になる。



## 14. 相平衡の条件

相 $\alpha$ と相 $\beta$ が共存する平衡条件は、各成分で化学ポテンシャルが一致することである。
$$
\mu_i^\alpha(T,P,\{x\})=\mu_i^\beta(T,P,\{x\})
$$
が全成分 $i$ に対して成立するとき、相境界上にある。これは「物質を相間で微小に移しても $G$ が下がらない」という最小化条件そのものである。

二元系では、共通接線の幾何学により視覚的に理解できる。多元系では接線の概念をそのまま描けないが、条件式は同じであり、数値計算ではギブズ自由エネルギー最小化として解く。



## 15. レバー則と相分率

二相共存域では、全組成 $x_0$、共存する相の組成 $x_\alpha, x_\beta$ が決まると、相分率は質量保存から決まる。二元系のモル分率表示なら
$$
f_\alpha = \frac{x_\beta-x_0}{x_\beta-x_\alpha},
\qquad
f_\beta = \frac{x_0-x_\alpha}{x_\beta-x_\alpha}
$$
である。

この式は「二相の混合で全体組成が再現される」という単純な幾何学であるが、平衡計算の結果が直感に合っているかを検討する材料になる。相分率が負になるような結果は、前提（候補相やモデル）が不整合である可能性を示唆する。



## 16. クラペイロン式

相境界の傾きはクラペイロン式で与えられる。一次相転移でエントロピー変化 $\Delta S$ と体積変化 $\Delta V$ があるとき
$$
\frac{dP}{dT}=\frac{\Delta S}{\Delta V}
=\frac{\Delta H}{T\,\Delta V}
$$
である。

この式は、固液・液気・固固の相境界の傾きを、潜熱や体積差から計算できることを示す。例えば $\Delta V$ の符号が通常と異なる場合、相境界の傾きも反転し得ることが式から直ちに分かる。



## 17. 平衡を最小化問題として書く

定温・定圧では、全ギブズ自由エネルギー $G$ を最小にする組成や相分率が平衡である。化学種 $k$ の物質量を $n_k$ とし、各種のモルギブズエネルギーを $g_k$ とすると
$$
G(T,P,\{n_k\})=\sum_k n_k\,g_k(T,P,\{x\})
$$
である。制約は元素保存であり、元素 $a$ について
$$
\sum_k A_{ak}\,n_k = b_a
$$
が課される。

この最小化はラグランジュ未定乗数で扱える。停留条件から、平衡では独立な反応進行に対して $\Delta_r G=0$ が満たされることが導かれる。つまり「自由エネルギー最小化」と「反応ギブズエネルギーがゼロ」は同じ内容を別表現で述べている。



## 18. ギブズ最小化の計算と候補集合

ギブズ最小化では、計算に含める相や化学種の集合が結果を左右する。候補に入っていない相は出現しないため、何が候補集合に含まれているかは数式以前の前提条件である。したがって、熱力学データベースの収録範囲とモデルの意味を理解する必要がある。

国内の熱力学計算ソフト説明でも、ギブズエネルギー最小化では圧力を指定すること、そして存在し得る物質をデータベースから選ぶ必要があることが明示されている。候補集合の与え方は、平衡状態を求める計算の数学的構造そのものに関わる。



## 19. CALPHAD の考え方

材料分野では CALPHAD が広く用いられる。CALPHAD は、各相のギブズ自由エネルギー $G^\phi(T,\{x\})$ を関数として表し、二元・三元で整備した表式を高次系へ外挿して、多成分合金の相平衡を計算する枠組みである。関数のパラメータは実験値や第一原理計算の結果に合わせて最適化され、熱力学データベース（TDB ファイルなど）として提供される。

固溶体相の過剰ギブズエネルギーには Redlich–Kister 形が基本として使われることが多い。二元系なら
$$
G^{\mathrm{ex}}(x)=x_Ax_B\sum_{m=0}^{M} L^{(m)}(T)(x_A-x_B)^m
$$
のように書き、$L^{(m)}(T)$ が相互作用の温度依存を担う。秩序相や欠陥相ではサブラティス模型が用いられ、サイト占有を変数として $G$ を構成する。



## 20. 日本国内のデータ基盤

国内には、CALPHAD による自由エネルギー関数を集録したデータ基盤が存在する。物質・材料研究機構の計算状態図データベース（CPDDB）は、相のギブズエネルギー関数をまとめた TDB ファイルを集録し、これらと熱力学計算ソフトを組み合わせることで、相平衡や状態図、熱力学量を求められるとしている。データ更新情報も公開されており、計算に用いた版の記録が再現性に関わる。

このような基盤は、研究で扱う元素系が広がるほど重要になる。データベースが「何を含むか」と「何を含まないか」を知ることは、計算結果の解釈に直結する。



## 21. 流体系の状態方程式とヘルムホルツ形式

水・蒸気などの流体系では、状態方程式により物性を計算する。IAPWS-95 は、温度 $T$ と密度 $\rho$ の関数としてヘルムホルツ自由エネルギーを与える形式であり、その導関数の組合せから圧力、エンタルピー、エントロピー、音速、比熱などが計算できる。ここで「ヘルムホルツ形式」を採る利点は、飽和曲線や広い圧力域でも整合的に物性を生成できる点にある。

材料の相平衡計算が主に $G(T,P)$ を扱うのに対し、流体では $\rho$ を自然変数に含む表式が安定になる場合がある。どの表式が適切かは対象系と必要な物性の種類によって決まるが、根本は「適切なポテンシャルを用い、導関数で必要量を得る」という同じ構造である。



## 22. 参照状態と単位系

熱力学計算では、参照状態が一致していることが重要である。$\mu_i^\circ$ や $\Delta_f G^\circ$ の基準圧（1 bar か 1 atm か）、標準状態（純物質か、希薄溶液の標準か）を混在させると、平衡定数や相境界がずれる。したがって、使用したデータセットの定義を読み、同一の基準に揃える必要がある。

単位系も同様に重要である。$C_p$ が J/mol/K なのか kJ/mol/K なのか、$G$ が mol 基準か kg 基準かで、指数関数の中身（$RT$）が合わなくなる。指数関数は小さな不整合でも大きな差を生むため、単位の整合は計算の前提である。



## 23. 研究に近い形の計算手順の例

相平衡を求めたい場合、第一に必要なのは各相の $G^\phi(T,\{x\})$ である。これが熱力学表から構成できる範囲なら、$C_p$ 積分と相転移項を使って $G^\phi(T)$ を作る。多元系で現実的に扱うなら、CALPHAD データベースを用いて $G^\phi$ を直接呼び出す形になる。

次に、候補相集合を決め、元素保存の制約下で全体の $G$ を最小にする。結果として、平衡相の種類、相分率、各相の組成、さらに化学ポテンシャルが得られる。最後に、同じ条件で計算を繰り返し、温度や全組成の変化に対して相の切り替わりを追えば、状態図や駆動力の温度依存が得られる。



## 24. まとめと展望

熱力学計算は、自由エネルギーとその導関数（特に化学ポテンシャル）を軸に、平衡条件を最小化問題として解く枠組みである。混合、相互作用、相転移を含む複雑な現象も、最終的には $G(T,P,\{N_i\})$ の形を整備し、その最小化として統一的に扱える。

今後は、国内外の熱力学データ基盤の充実と第一原理計算の統合により、実験が難しい多元系や極端条件での平衡推定がより高精度になると考えられる。同時に、平衡から外れた状態の記述へ進むには、自由エネルギーから得られる駆動力を速度論・輸送・界面現象へ接続する必要があり、この接続が材料設計の中心課題の一つになっていくと考えられる。



## 参考文献

- 横川 晴美, 熱力学データベースの最近の動き, 熱測定 23(2) (2007)（日本語）  
  https://www.netsu.org/JSCTANetsuSokutei/pdfs/23/23-2-70.pdf
- FactSage Education はじめて使う FactSage Education（ギブズエネルギー最小化と物質選択の説明）（日本語）  
  https://www.rccm.co.jp/thermodynamics/software/files/FactSageEducation-FirstTime-240430.pdf
- NIMS 計算状態図データベース CPDDB（TDB ファイル集録の説明）（日本語）  
  https://cpddb.nims.go.jp/

- Kattner, U. R., The CALPHAD Method and Its Role in Materials Design, JOM (2016)  
  https://pmc.ncbi.nlm.nih.gov/articles/PMC4912057/
- IAPWS, Revised Release on the IAPWS Formulation 1995 for the Thermodynamic Properties of Ordinary Water Substance (IAPWS-95) (2018)  
  https://iapws.org/documents/release/IAPWS-95
- Wagner, W. and Pruß, A., The IAPWS Formulation 1995 for the Thermodynamic Properties of Ordinary Water Substance, J. Phys. Chem. Ref. Data (2002)  
  https://www.teos-10.org/pubs/Wagner_and_Pruss_2002.pdf
- NIST Chemistry WebBook（熱化学データと $C_p,S,H$ など）  
  https://webbook.nist.gov/
- NIST WebBook の Shomate 式の例（CO2 のページ）  
  https://webbook.nist.gov/cgi/cbook.cgi?ID=C124389&Mask=1
- NIST-JANAF Thermochemical Tables（標準生成量や $C_p,S,H,G$ の推奨値）  
  https://janaf.nist.gov/
- NIMS CPDDB データ更新ニュース（版管理の重要性の例）  
  https://dice.nims.go.jp/news/2025/04/20250421-2.html
- MALT マニュアル（ギブズ最小化では圧力指定が必要である旨）（日本語）  
  https://www.kagaku.com/malt/manuals/MALTManual_J.pdf
