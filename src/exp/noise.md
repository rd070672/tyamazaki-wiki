# ノイズの種類・原因・対策

ノイズは信号源・配線・増幅器・電源・接地・温度・機械振動・サンプリングの相互作用として現れるものであり、波形やスペクトルの形から原因を系統的に狭める必要がある。診断の基本は短絡・開放・ダミー負荷・既知信号注入を軸に、観測帯域と結線条件を固定したまま一手ずつ条件を置換して差分を読むことである。


### 参考ドキュメント
1. Tektronix / Keithley, Low Level Measurements Handbook (7th Edition)
   https://download.tek.com/document/LowLevelHandbook_7Ed.pdf

2. アナログ・デバイセズ, 1/f ノイズの基本、その除去方法
   https://www.analog.com/jp/resources/analog-dialogue/articles/understanding-and-eliminating-1-f-noise.html

3. 村田製作所, ノイズ対策 基礎講座（プリント基板のノイズの伝搬のしかた）
   https://www.murata.com/ja-jp/products/emc/emifil/library/knowhow/basic/s2-chapter04-p1

## 1. 計測で使う量

### 1.1 時間領域

観測波形を $x(t)$ とし、平均（直流成分）を $\langle x\rangle$ とすると、ゆらぎ成分は
$ x_{\mathrm{ac}}(t)=x(t)-\langle x\rangle $
である。帯域制限された実効値（RMS）は
$$
x_{\mathrm{rms}}=\sqrt{\langle x_{\mathrm{ac}}^2\rangle}
$$
で定義される。

### 1.2 周波数領域

パワースペクトル密度（PSD）を $S_x(f)$ とすると、周波数帯 $[f_1,f_2]$ に含まれるRMSは
$$
x_{\mathrm{rms}}=\sqrt{\int_{f_1}^{f_2}S_x(f)\,df}
$$
である。白色雑音では $S_x(f)$ がほぼ一定であり、$x_{\mathrm{rms}}\propto\sqrt{B}$（$B$ は帯域幅）となる。

### 1.3 帯域幅と等価雑音帯域（ENBW）

現実のローパス/平均化は理想矩形帯域ではない。フィルタ利得 $|H(f)|$ を用いると、出力雑音は
$$
x_{\mathrm{rms,out}}^2=\int_0^\infty S_x(f)\,|H(f)|^2\,df
$$
であり、白色雑音に対する等価雑音帯域（ENBW）は
$$
B_{\mathrm{eq}}=\frac{\int_0^\infty |H(f)|^2\,df}{|H(0)|^2}
$$
である。表示帯域や平均回数の議論では、名目帯域ではなく $B_{\mathrm{eq}}$ を意識するのが定量の前提である。



## 2. 切り分けの基本操作

## 2.1 診断の四手
- 短絡
- 開放
- ダミー負荷
- 既知信号注入

同一の計測器設定（帯域、サンプリング、レンジ、入力結合、フィルタ、平均化）を固定し、結線だけを置換して差分を読む。

### 2.2 短絡

入力を最短で短絡し、内部雑音床を測る。ここで支配的になりやすいのは、前段アンプの入力換算電圧雑音、抵抗（終端）雑音、電源由来の残留、内部クロック由来のスプリアスである。短絡でも 50/60 Hz や高調波が残る場合、接地・シールド・電源・計測器同士の結合を最優先で疑う。

### 2.3 開放

入力を開放し、アンテナ化による誘導と、入力バイアス電流×入力インピーダンスで増える低周波ゆらぎを観察する。開放で低周波や商用周波数が急増する場合、配線の取り回し、シールドの片側接地、差動化、入力インピーダンスの見直し（終端抵抗追加など）が効く。

### 2.4 ダミー負荷

信号源と等価なインピーダンス（抵抗、容量、コイル、あるいは疑似センサ）を接続し、信号源固有の雑音と配線起因を分離する。抵抗ダミーは熱雑音が計算できるため、定量の基準点になる。

### 2.5 既知信号注入

既知振幅・既知周波数の信号を注入し、SNR、歪、混変調、スプリアス、ゲイン揺らぎを同時に観察する。既知信号の周辺にサイドバンドが立つ場合、電源リップル変調、クロックジッタ、機械振動、温度揺らぎが候補になる。



## 3. ノイズの種類

以下では、観測量を電圧 $v$、電流 $i$ としてまとめる。センサが電圧源か電流源か、入力が電圧測定か電流測定かで、支配項が入れ替わることに注意する。



## 3.1 熱雑音

### 定義

熱雑音（Johnson-Nyquist noise）は、温度 $T$ の抵抗 $R$ が生む平衡ゆらぎであり、白色雑音として近似できる。抵抗両端の平均二乗電圧は
$$
\overline{v_n^2}=4k_{\mathrm{B}}TR\,\Delta f
$$
である。電圧PSDは
$$
S_v=4k_{\mathrm{B}}TR
$$
である。等価な電流雑音としては
$$
S_i=\frac{4k_{\mathrm{B}}T}{R}
$$
である。

### 原因

熱揺らぎと散逸（抵抗成分）の関係であり、抵抗値と温度で決まる。回路が線形・受動である限り避けられない下限である。

### スペクトルの形

広い周波数範囲でほぼフラットであり、フィルタで帯域を絞ればRMSは $\sqrt{B}$ に比例して下がる。

### 低減策

- 帯域を絞る（必要な情報帯域に合わせて $B_{\mathrm{eq}}$ を小さくする）
- 抵抗値を下げる（許されるなら入力インピーダンスを下げる、終端の抵抗を最小化する）
- 温度を下げる（低温計測では直接効く）
- 低雑音前置（信号源インピーダンスに整合したアンプを選び、入力換算雑音を最小化する）



## 3.2 ショット雑音

### 定義

ショット雑音（shot noise）は、電荷の離散性に由来するゆらぎであり、直流電流 $I$ が流れる障壁（ダイオード、トンネル接合、光検出器、真空管、電流源など）で顕在化する。白色雑音として扱える範囲で、電流PSDは
$$
S_i=2qI
$$
である。帯域 $B$ でのRMSは
$$
i_{\mathrm{rms}}=\sqrt{2qIB}
$$
である。

### 原因

電流が粒子（電子、正孔、光子起源の電荷など）の確率過程として到来するためである。抵抗の熱雑音と異なり、直流電流に比例して増える。

### スペクトルの形

理想化すれば白色である。観測系の帯域やトランスインピーダンスで形が変わるが、基本はフラット成分として現れる。

### 低減策

- 直流電流を下げる（必要なバイアスを最小化する）
- 帯域を絞る
- 電流測定では帰還抵抗・帰還容量・入力容量の設計で帯域と安定性を両立させる
- 光検出では光学的な迷光・強度揺らぎを分離し、真のショット限界かを確認する（既知信号注入や参照検出で分離する）



## 3.3 1/f雑音

### 定義

1/f雑音（flicker noise）は、PSDが周波数に反比例して増大する低周波雑音である。経験的に
$$
S(f)=\frac{K}{f^{\alpha}}
$$
（多くは $\alpha\approx 1$）で表され、デバイス内部の欠陥・界面・キャリア捕獲放出などに起因する。白色雑音と交差する周波数を 1/f コーナー周波数と呼ぶ。

### 原因

半導体デバイスのトラップ、接触抵抗のゆらぎ、抵抗体材料（カーボン系など）の微視的ゆらぎが支配因子になりやすい。直流バイアスや直流電流が存在すると顕著になりやすい。

### スペクトルの形

低周波で右上がり（低周波ほど大きい）となる。長時間平均で下げにくく、ドリフトと区別が難しい場合がある。

### 低減策

- 変調して測る（チョッパ、ロックイン、反転法で信号を高周波へ移し、1/f優勢域を避ける）
- デバイス選定（低 1/f を明記したアンプ、チョッパ安定化アンプ、金属皮膜抵抗など）
- バイアス条件の最適化（不要な直流を減らす）
- 温度・機械を安定化し、ドリフトと混同しない（低周波帯では環境要因が同じ見え方をする）


## 3.4 電源リップル

### 定義

電源リップルは、商用電源周波数（50/60 Hz）および整流・スイッチング由来の周期成分が、電源レールやグラウンドを介して信号系へ混入する現象である。スペクトルでは離散線として現れ、高調波（100/120 Hz、150/180 Hz…）やスイッチング周波数とそのサイドバンドとして観測される。

### 原因

- 電源レールのリップルがPSRR不足で前段へ回り込む
- グラウンドのインピーダンスでリップル電流が電位差を作り、信号参照点を揺らす
- ケーブル・治具が磁界・電界結合を受ける
- スイッチング電源のスペクトル成分が検波され、低周波へ折り返す

### 低減策

- 電源の低雑音化（LDO、ポストフィルタ、LC/RCフィルタ、πフィルタ）
- 電源分離（アナログ系とデジタル系のレール分離、スター配線、局所デカップリング）
- PSRRの高い前段を選ぶ、または差動化で共通モード成分を落とす
- 50/60 Hz のノッチは最終手段として扱い、原因（結線、接地、磁界結合）を先に潰す
- 測定系自体の取り方を改善（オシロのグラウンドリードを最短化、同軸の接地方法を適正化）


## 3.5 グラウンドループ

### 定義

グラウンドループは、複数経路で接地されることにより閉ループが形成され、ループに誘起された電流がケーブルシールドや参照点に電位差を生み、信号として混入する現象である。低周波の離散線（50/60 Hz）や、その整流・混変調成分として現れやすい。

### 原因

- 計測器Aと計測器Bがそれぞれ保護接地され、信号ケーブルのシールドが第三の経路になる
- PC接続（USB、LAN）でグラウンドが結ばれ、意図せぬ帰路が生じる
- 大電流機器（モータ、電源）と信号系が同一接地系で結合する

### 低減策

- 接地点を一箇所へ集約する（スター接地の思想）
- 差動入力を使い、共通モード許容範囲内で受ける
- 信号絶縁（アイソレータ、絶縁アンプ、光、トランス）で直流・低周波のループ電流を遮断する
- シールド接地の位置を制御する（片側接地、あるいは高周波のみ両側接地など、周波数で設計する）
- ケーブル経路を短くし、ループ面積を小さくする


## 3.6 EMIとRFI

### 定義

EMI（電磁妨害）やRFI（高周波混入）とは、外来の電界・磁界が配線や筐体へ結合し、信号帯域へ混入する現象である。連続帯（広帯域の持ち上がり）と離散線（通信、スイッチング、クロック）の両方があり、整流で低周波へ落ちることもある。

### 原因

- ループ面積が大きい配線、平行配線、長い未シールド配線
- 高dv/dtや高di/dtのスイッチング回路が近傍にある
- シールドの隙間、筐体接合不良、コネクタ部の不連続
- 入力保護素子やダイオードで高周波が検波され、直流オフセットや低周波ゆらぎとして現れる

### 低減策

- ループ面積最小化（ツイストペア、同軸、信号とリターンの密着）
- シールド（編組・箔、筐体、シールドボックス）と適切な接地
- フィルタ（コモンモードチョーク、フェライト、RC/LC、フィードスルーコンデンサ）
- 前段入力での高周波遮断（入力RC、帯域制限）
- 測定器の入力レンジ・結合（AC/DC）・帯域制限を固定し、結線置換で差分を見る



## 3.7 マイクロフォニック

### 定義

マイクロフォニック（機械振動起因）とは、機械振動や音圧が、配線や部品の電気特性（容量、接触抵抗、圧電、摩擦帯電）を変調し、電気信号として現れる現象である。微小電流測定や高インピーダンス測定で顕著である。

### 原因

- ケーブルの摩擦帯電（トライボエレクトリック効果）による電荷発生
- セラミックコンデンサの圧電性による容量変動
- コネクタ接触の微小変動
- 真空中・低温での剛性変化により振動が増幅されることがある

### スペクトルの形

振動源周波数（ファン、ポンプ、床振動、音）に対応する離散線、あるいは低周波の盛り上がりとして現れる。既知信号注入時にサイドバンドとして観測されることがある。

### 低減策

- 低雑音ケーブル（低トライボ、トライアキシャル、ガード）を使う
- ケーブルを固定し、動かないようにする（クランプ、柔軟な引き回し、振動源から離す）
- 圧電性の小さい部品選定（C0G/NP0、フィルム）と機械的固定
- 筺体内での配線接触・共振を避ける
- 低周波域は変調測定（ロックイン）で逃がす



## 3.8 温度ドリフト

### 定義

温度ドリフトとは、温度変化により、オフセット、利得、抵抗値、バイアス電流、熱起電力（Seebeck効果）が変化し、信号のゆっくりした変動として現れる現象である。スペクトルでは極低周波の増大として現れ、1/f雑音と区別が難しいことがある。

### 原因

- アンプのオフセットドリフト、入力バイアス電流ドリフト
- 抵抗の温度係数（TCR）によるゲイン変動
- 異種金属接点の温度差による熱起電力（微小電圧計測で致命的になり得る）
- 空調・筐体温度・自己発熱の時間変化

### 低減策

- 温度を一定化する（断熱、恒温槽、筐体の熱設計）
- 熱起電力が小さい材料・コネクタ・端子を選ぶ、温度勾配を作らない（対称配置、熱的に同じ経路）
- 反転法・差動法・チョッパでオフセットとドリフトをキャンセルする
- ウォームアップ後に測り、熱時定数が落ち着いた状態で比較する


## 4. 追加で知っておきたいノイズ（＋α）

- バースト雑音（popcorn noise、RTS）
  半導体内部のトラップ捕獲・放出などにより、信号が2準位（あるいは多準位）で不連続に跳ぶゆらぎである。時間波形では段差状のランダムテレグラフ信号として見え、周波数領域では低周波側の盛り上がりやローレンツ型の寄与として現れる。電源・温度・バイアス条件で出たり消えたりすることがあるため、ダミー負荷で前段に起因するか、信号源に起因するかをまず分離する。

- 生成再結合雑音（generation-recombination noise）
  キャリアの生成・再結合が確率過程として揺らぐことに由来する雑音である。特性時間 $\tau$ をもつ緩和過程があると、PSDは
  $$
  S(f)\propto \frac{1}{1+(2\pi f\tau)^2}
  $$
  のようなローレンツ型になりやすい。温度依存やバイアス依存が強いことが多く、RTSが多数重なると1/f風に見える場合もある。

- アバランシェ雑音（avalanche noise）
  強電界下での衝突電離によりキャリア増倍が確率的に揺らぐ雑音である。アバランシェフォトダイオードやツェナー領域のダイオード、過大バイアス条件で顕在化する。信号が同時に増幅される一方で雑音係数が増えるため、バイアス点の最適化と帯域制限が重要である。

- 量子化雑音（quantization noise）
  ADCの有限分解能により、入力が離散化されることから生じる誤差である。理想的な一様量子化では誤差は $\pm \Delta/2$ の範囲にあり、適切にディザがかかる条件では白色雑音として近似され、SNRはビット数 $N$ に対して
  $$
  \mathrm{SNR}\approx 6.02N+1.76\ \mathrm{dB}
  $$
  で見積もられる。実際には入力レンジ設定、前段ゲイン、ディザの有無、スプリアス（INL/DNL）で見え方が変わる。

- サンプリングジッタ起因の位相雑音（jitter/phase noise）
  サンプリング時刻のゆらぎ $\sigma_t$ が、特に高周波・高スルーレートの信号で電圧誤差に変換される現象である。単一正弦波 $v(t)=A\sin(2\pi f t)$ に対してジッタ起因のRMS誤差は概ね
  $$
  v_{\mathrm{rms}}\sim 2\pi f A\,\sigma_t
  $$
  と見積もられる。スペクトルではキャリア周りの位相雑音（裙野）やサイドバンド、SNR劣化として現れ、クロック源・PLL・デジタル干渉の影響を強く受ける。

- 折り返し（aliasing）による見かけの雑音
  ナイキスト周波数 $f_s/2$ を超える成分が、低周波側へ写り込む現象である。白色雑音やスイッチングスプリアスが折り返すと、低周波帯に原因不明の雑音床上昇として現れる。対策はアナログのアンチエイリアスフィルタ（前段ローパス）を必ず入れ、サンプリング周波数とフィルタ遮断の関係を定量で設計することである。

- クロストークとグラウンドバウンス
  近接配線の容量結合・誘導結合、あるいは共有インピーダンス（共通グラウンド、共通電源配線）を通じて、別チャネルの信号やデジタルスイッチングが混入する現象である。デジタル動作に同期したスプリアスやバーストとして現れやすい。配線分離、リターン電流経路の設計、アナログ/デジタルの電源・グラウンド分離、差動化、コモンモードチョークが効く。

- 漏れ電流と表面汚染起因の擬似信号
  高インピーダンス・微小電流測定で、絶縁不足、湿度、フラックス残渣、指紋、ケーブル表面の汚れなどがリーク経路を作り、ゆっくりしたドリフトや外乱感度として現れる現象である。開放条件で値が落ち着かない、湿度や触れ方で変わる、ガードを入れると激減する、といった特徴がある。洗浄、乾燥、ガード付き治具、トライアキシャル、絶縁材の見直しで改善する。

それぞれはデバイス物理・測定方式・サンプリング理論・配線結合が作るゆらぎとして現れやすく、短絡・開放・ダミー負荷・既知信号注入で再現性と依存性（温度、バイアス、帯域、サンプリング周波数、デジタル動作）を一つずつ確認して扱うのが基本である。


## 5. スペクトル形状からの当たりの付け方

| 観測（周波数領域） | 主な候補 | 追加の一手 |
|---|---|---|
| ほぼフラット | 熱雑音、ショット雑音、アンプ白色雑音 | 帯域を変えてRMSが $\sqrt{B}$ に従うか確認 |
| 低周波で増大（$1/f$ 風） | 1/f雑音、温度ドリフト、熱起電力、ゆっくりしたEMI検波 | 変調測定、温度を安定化、反転法で差分確認 |
| 50/60 Hz と高調波が鋭く立つ | 電源リップル、グラウンドループ、磁界結合 | 接地経路の単純化、差動化、絶縁、ループ面積低減 |
| 特定の高周波線とサイドバンド | スイッチング電源、クロック、ジッタ、機械振動変調 | 電源分離、入力RC、遮蔽、振動源停止で比較 |
| ケーブルに触ると増える | マイクロフォニック、トライボ | ケーブル固定、低雑音ケーブル、ガードの導入 |
| 開放で急増、短絡で減る | 誘導EMI、入力高インピーダンスのアンテナ化 | シールド、終端、差動入力、配線短縮 |



## 6. 具体的な低減策の配置順

## 6.1 信号源側
- 信号源インピーダンスを把握する
- 直流バイアスを必要最小にする
- ダミー負荷で等価化し、信号源由来のゆらぎと切り分ける

## 6.2 配線・治具
- 信号とリターンを密着させ、ループ面積を小さくする
- シールドの接地位置を制御する
- 高インピーダンスはガードを検討する
- ケーブルを固定し、振動・摩擦帯電を抑える

## 6.3 前段アナログ回路
- 帯域制限を入れる（不要帯域は入れない）
- 入力換算雑音で比較し、信号源インピーダンスに整合した方式（電圧入力、電流入力、TIAなど）を選ぶ
- 低周波は変調測定（ロックイン、チョッパ）で逃がす

## 6.4 電源・接地
- アナログとデジタルを分離し、局所デカップリングを徹底する
- ループ電流の経路を可視化し、単純化する
- 必要に応じて絶縁でループを断つ
- スイッチング電源はスペクトルを見て、混入が測定帯域へ落ちていないか確認する

## 6.5 データ処理
- 平均化は白色雑音に効くが、1/fやドリフトには効きにくい
- 既知信号注入でSNRを定量し、設定変更の効果を数式で追う
- 折り返しを避けるため、アナログの前段でアンチエイリアスを入れる



## 7. よく使う計算式

- 抵抗の熱雑音（電圧）
$$
v_{\mathrm{rms}}=\sqrt{4k_{\mathrm{B}}TRB}
$$

- ショット雑音（電流）
$$
i_{\mathrm{rms}}=\sqrt{2qIB}
$$

- 白色雑音PSDとRMSの関係
$$
x_{\mathrm{rms}}=\sqrt{S_x\,B_{\mathrm{eq}}}
$$

- 1/f雑音の積分（$\alpha=1$ の場合）
$$
x_{\mathrm{rms}}^2=\int_{f_1}^{f_2}\frac{K}{f}\,df=K\ln\left(\frac{f_2}{f_1}\right)
$$
低周波下限 $f_1$（観測時間やハイパスで決まる）が支配的である点が重要である。


## まとめと展望

ノイズは単一原因ではなく、信号源・配線・前段回路・電源・接地・環境の結合が作る観測結果であるため、短絡・開放・ダミー負荷・既知信号注入の四手で条件を置換し、スペクトル形状と帯域依存を併用して原因を狭めるのが再現性の高い手順である。今後は、低雑音電源と絶縁の高度化、低周波を避ける変調計測の一般化、相関・同期検出やデジタル補償の普及により、熱雑音やショット雑音に近い物理限界へより確実に到達する設計と診断が進むと考えられる。


### 参考ドキュメント以外のsources

- BIPM, Johnson-Nyquist noise and electronic thermometry（Nyquist式とPSDの整理を含む）
  https://www.bipm.org/documents/20126/28430177/working-document-ID-11104/f75ded28-557e-d999-87bb-5005c136bfd2

- アナログ・デバイセズ, グラウンド・ループを機能的絶縁で解消する（日本語）
  https://www.analog.com/jp/resources/technical-articles/breaking-ground-loops-with-functional-isolation.html

- NI, Ground-Loop-Related DC Offset（グラウンドループが作るDCオフセットと測定上の現れ方）
  https://www.ni.com/docs/en-US/bundle/usb-5132-5133-feature/page/ground-loop-noise-in-the-ni-usb-51325133.html

- Advanced Energy, Ripple & Noise Measurements（リップル測定系の取り方とコモンモード混入）
  https://www.advancedenergy.com/getmedia/faa39601-a9ed-4ec1-83ae-45a8f0dd824a/en-lv-ripple-noise-application-note.pdf

- Texas Instruments, Demystifying and Mitigating Power Supply Ripple and Noise（電源リップルの影響と設計上の考え方）
  https://www.ti.com/lit/pdf/slvaf52

- アナログ・デバイセズ, Managing Noise in the Signal Chain, Part 1（熱・ショット・アバランシェ・フリッカ・バーストの整理）
  https://www.analog.com/jp/resources/technical-articles/managing-noise-in-the-signal-chain-part-1-annoying-semiconductor-noise-preventable-or-inescapable.html

- CONTEC 技術コラム, アナログ信号計測におけるノイズ対策（シールド・接地・配線）
  https://www.contec.com/jp/support/blog/2021/210326_analogsignal/

- 日本プラズマ・核融合学会, プラズマ実験におけるノイズ対策の基礎（日本語PDF）
  https://www.jspf.or.jp/Journal/PDF_JSPF/9511-9602koza.pdf
