# 汎用機械学習ポテンシャル

汎用機械学習ポテンシャル（Universal / Foundation MLIP）は、DFTで得られるポテンシャルエネルギー面を深層学習で近似し、より大規模・長時間の原子シミュレーション（構造緩和、MDなど）を現実的な計算コストで可能にする枠組みです。材料探索では「まず汎用MLIPで広く探索→重要系のみDFTで精密化」という使い分けが基本になります。

## 参考ドキュメント
- Matlantis公式：PFPモデル v7.0.0リリース（96元素対応の説明）
  https://matlantis.com/ja/news/pfp-v7-release/
- PFN & ENEOS：PFP v7 / Matlantis の発表（訓練規模・96元素など）
  https://www.eneos.co.jp/english/newsrelease/2024/pdf/20240917_01.pdf
- UMA: A Family of Universal Models for Atoms（arXiv, 2025）
  https://arxiv.org/abs/2506.23971


## 1. MLポテンシャルは何を近似しているか
原子配置 $R = {r_i}$ と元素種 $Z = {Z_i}$ に対して、ポテンシャルエネルギー $E(R, Z)$ を学習し、
力は
$$
\mathbf{F}_i(R,Z) = -\nabla_{\mathbf{r}_i} E(R,Z)
$$
で得ます（MDはこの力で運動方程式を積分）。

実務上は、局所環境の和として
$$
E(R,Z)\approx \sum_i \varepsilon(\mathcal{N}_i)
$$
（i周りの近傍環境 $\mathcal{N}_i$ から原子ごとの寄与を出して足し上げる）という形で表されることが多いです。

学習はエネルギー・力・応力（圧力）を同時に合わせる形が典型です：
$$
\mathcal{L} = w_E \|E-\hat{E}\|^2 + w_F \sum_i \|\mathbf{F}_i-\hat{\mathbf{F}}_i\|^2 + w_\sigma \|\sigma-\hat{\sigma}\|^2
$$

## 2. 「汎用（全元素対応）」の意味
汎用といっても「何でも正確」ではありません。一般に“汎用”は次の2つを指します。

- 元素・組成のカバレッジが広い（多元素、合金、酸化物、触媒表面など）
- ドメインが広い（分子、結晶、表面、欠陥、吸着、電解質、MOFなど）

ただし、以下は要注意ポイントです。

- 学習データ外の化学状態：高電荷、強相関、強い磁性・スピン状態の多様性、極端な高温・高圧、放射線損傷など
- 反応（結合の切断・生成）：可能でも、反応座標近傍のデータが薄いと誤差が出やすい
- 長距離相互作用：静電・分散・誘電応答などをどう扱うかはモデル設計次第（得意不得意が出る）

結論：汎用MLIPは「最初の探索と候補の絞り込みを高速化する道具」。最終判断はDFT/実験で必ず裏取ひします。

## 3. 代表例：Matlantis（PFP）とUMA（Meta FAIR / FAIRChem）
汎用MLIPは商用・オープンの両方があり、選定では「元素範囲」「対象ドメイン」「計算規模」「ワークフロー（ASE/LAMMPS対応など）」を見ます。

### 3.1 比較表
| 観点 | Matlantis（PFP） | UMA（FAIRChem） |
|---|---|---|
| 提供形態 | 商用プラットフォーム（クラウド中心） | オープン（コード/重み公開、HuggingFace配布など） |
| 元素カバレッジ | PFP v7で96元素（自然界に存在する元素を含む範囲を広くカバーする方針） | 分子・材料・触媒など複数ドメインを統合して学習（要素範囲はリリース・タスクに依存） |
| 想定タスク | 構造最適化、MD、材料探索の高速化など | 触媒（OC20）/無機（OMat）/分子（OMol）/MOF（ODAC）/分子結晶（OMC）などタスク選択 |
| 使い方の感触 | GUI/サービスとして運用しやすい（社内利用向き） | ASE calculator等で組み込みやすい（研究コードに統合しやすい） |
| 典型的な運用 | “汎用で走らせ、怪しい系はDFTで検証” | “汎用で走らせ、必要なら追加学習/タスク切替” |

注：公平のため、精度・速度・対応規模の“宣伝値”は鵜呑みにせず、自分の材料系でベンチマークすること。

### 3.2 Matlantis（PFP）の要点
- 汎用ポテンシャル（PFP）がコアで、元素カバレッジを拡張し続ける方向性
- 多元素材料（合金、触媒、電池材料など）で「まず一度回す」用途に向く
- 研究室では、次のような使い方が現実的
  - 欠陥・拡散・界面の候補構造を大量生成 → 重要候補だけDFT精密化
  - 合金組成・ポリタイプ・欠陥濃度などの粗探索
  - MDで熱安定性・局所構造統計（RDF/配位数/ボロノイなど）評価

### 3.3 ユニバーサルモデル（UMA）
- “単一モデルで複数ドメインに一般化する”を狙った設計（論文では巨大データでの汎化を強調）
- FAIRChemの実装として、ASE経由で構造緩和やMDへ統合しやすい
- 研究室では、次が取り回しやすい
  - 触媒表面や吸着（タスク：oc20）
  - 無機結晶・欠陥（タスク：omat）
  - 分子や電解質（タスク：omol）
  - まずは“自分の系”に近いタスクを選んで試す

## 4. 標準ワークフロー
### 4.1 検証
汎用MLIPを使う前に、少数の代表構造で以下を比較します。

- 構造最適化：格子定数、体積、局所結合長、エネルギー順位
- 弾性・応力：応力-歪みの符号やオーダー
- 欠陥：形成エネルギーの傾向（絶対値より相対順位を重視）
- 表面・界面：面方位の相対安定性
- MD：RDF/配位数の“物理らしさ”（異常な崩壊がないか）

### 4.2 運用指針
- 探索：MLIPで広く（多数条件・多数候補）
- 絞り込み：上位候補の近傍だけDFTで再評価（構造・エネルギー・バリア）
- 違和感検知：明らかに非物理（過剰凝集、異常解離、密度崩壊など）は即ストップして条件/モデルを見直す

## 5. まとめ
汎用機械学習ポテンシャルは、材料探索の「計算ボトルネック」を大幅に下げ、探索空間を広げる強力な基盤技術です。一方で“汎用＝万能”ではないため、研究室運用では「小さく検証してから大きく回す」「重要結論はDFT/実験で裏取りする」を原則にしてください。